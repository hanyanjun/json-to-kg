{"version":3,"sources":["libs/react-d3-force/src/D3Visualization/lib/visualization/components/renderer.js","libs/react-d3-force/src/D3Visualization/lib/visualization/renders/init.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/graph.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/node.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/relationship.js","libs/react-d3-force/src/D3Visualization/mapper.js","libs/react-d3-force/src/D3Visualization/GraphEventHandler.js","libs/react-d3-force/src/D3Visualization/lib/visualization/d3-appendSvg.js","libs/react-d3-force/src/shared/exporting/svgUtils.js","libs/react-d3-force/src/shared/exporting/imageUtils.js","libs/react-d3-force/src/D3Visualization/graphStyle.js","libs/react-d3-force/src/shared/services/grassUtils.js","libs/react-d3-force/src/D3Visualization/components/browser-styles.js","libs/react-d3-force/src/D3Visualization/components/styled.jsx","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/textMeasurement.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/loopArrow.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/straightArrow.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/arcArrow.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/pairwiseArcsRelationshipRouting.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/graphGeometry.js","libs/react-d3-force/src/D3Visualization/lib/visualization/renders/icons.js","libs/react-d3-force/src/D3Visualization/lib/visualization/renders/menu.js","libs/react-d3-force/src/D3Visualization/lib/visualization/renders/rightMenu.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/clickHandler.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/visualization.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/collision.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/layout.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/arrays.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/circularLayout.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/graphView.js","libs/react-d3-force/src/D3Visualization/components/Graphs.js","pages/home/Header.js","pages/home/Drawer.js","pages/home/Home.js","App.js","reportWebVitals.js","index.js","libs/react-d3-force/src/shared/services/utils.js"],"names":["Renderer","opts","onGraphChange","onTick","Object","assign","this","noop","nodeDefs","selection","viz","defs","selectAll","data","node","enter","append","classed","attr","patternContentUnits","id","width","height","exit","remove","nodeOutline","circles","cx","cy","r","radius","fill","isFilter","style","forNode","get","stroke","nodeCaption","text","caption","line","baseline","nodeIcon","nodeRing","insert","nodeRingStrokeSize","arrowPath","name","paths","rel","forRelationship","d","arrow","outline","shortCaptionLength","relationshipBg","texts","midShaftPoint","x","captionLength","captionHeight","y","parseFloat","naturalAngle","relationshipType","captionLayout","shortCaption","relationshipOverlay","rects","overlay","push","nodeSelf","relationship","relationshipSelf","Graph","config","addExpandedNodes","nodes","Array","from","eNode","findNode","nodeMap","_nodes","expandedNodeMap","concat","addNodesLabelsMap","collapseNode","forEach","removeConnectedRelationships","removeNode","addNodes","bind","updateNode","initConfig","resetGraph","addRelationships","addInternalRelationships","pruneInternalRelationships","findNodeNeighbourIds","findRelationship","findAllRelationshipToNode","nodeLabelsMap","relLabelsMap","relationshipMap","_relationships","filterNodeByLabelMap","filterRelByLabelMap","isCtrlClick","groups","nodePair","NodePair","source","target","relationships","result","ignored","pair","values","labels","length","map","v","display","Set","splice","indexOf","ids","arr","removeNodes","removeRels","rels","removeRel","v1","isPro","init","changeDisplay","type","obj","key","hasOwnProperty","value","expanded","minified","relations","nMap","existingRelationship","addRelLabelsMap","internal","filter","node1","node2","nodeA","nodeB","Node","properties","className","isNode","isRelationship","label_for_match","labelsAll","propertyMap","propertyList","keys","i","graph","Relationship","mapProperties","_","stringifyValues","k","optionalToString","mapNodes","mapRelationships","startNodeId","endNodeId","getGraphStats","labelStats","relTypeStats","label","count","relTypes","GraphEventHandler","graphView","getNodeNeighbours","onItemMouseOver","onItemSelected","onGraphModelChange","onEventListener","selectedItem","rightClickedItem","ctrlClickedArr","rightClickedMap","item","selected","update","isUpdate","rightClicked","nodeCount","relationshipCount","deselectItem","graphModelChanged","fixed","selectItem","layerX","px","layerY","py","ctrlClicked","clearSelected","clearRightSelected","nodeCollapse","contextMenu","hoveredItem","hovered","itemWithMenu","content","menuContent","menuSelection","console","log","on","onNodeMouseOver","onItemMouseOut","onMenuMouseOver","onRelationshipMouseOver","onRelationshipClicked","onCanvasClicked","nodeClose","nodeClicked","nodeDblClicked","nodeUnlock","nodeDelete","nodeNew","nodeEdit","onNodeCtrlClick","onNodeClickRight","onContrarySelected","onClearSelected","onBackStatus","onInitStatus","onStartFrame","onMadeChart","onAddRel","d3","prototype","appendSVG","SVGString","select","appendChild","document","importNode","DOMParser","parseFromString","documentElement","firstChild","prepareForExport","svgElement","graphElement","dimensions","getSvgDimensions","svg","createElementNS","appendPlanLayers","appendGraphLayers","viewBox","view","boundingBox","join","window","each","cloneNode","gainbase64","filename","dataURI","byteString","ia","j","mimeString","ref","split","atob","unescape","Uint8Array","charCodeAt","Blob","htmlCharacterRefToNumericalRef","XMLSerializer","serializeToString","replace","download","mime","blob","FileSaver","saveAs","downloadWithDataURI","neoGraphStyle","defaultStyle","defaultSizes","diameter","defaultIconCodes","defaultArrayWidths","defaultColors","color","Selector","tag1","classes1","tag","classes","toString","StyleRule","selector1","props1","selector","props","matches","classs","matchesExact","StyleElement","applyRules","rules","rule","defaultCaption","GraphStyle","loadRules","_error","parseSelector","tokens","reverse","m","re","out","exec","res","selectorStringToArray","slice","nodeSelector","relationshipSelector","calculateStyle","setDefaultNodeStyling","defaultColor","minimalSelector","sort","changeForSelector","usedColors","index","findAvailableDefaultColor","reduceRight","leading","current","hits","prop","test","getDefaultNodeCaption","findRule","destroyRule","idx","importGrass","string","parse","chars","insideString","insideProps","keyword","c","skipThis","match","val","trim","resetToDefault","toSheet","sheet","str","interpolate","ips","a","b","dim","StyledSvgWrapper","styled","div","theme","themes","normal","svgBackground","dark","undefined","getColor","StyledInlineList","ul","StyledInlineListItem","li","StyledToken","secondaryText","secondaryBackground","StyledLabelToken","StyledPickerSelector","span","button","fontFamily","fontSize","font","list","calc","cached","cache","canvasSelection","context","getContext","measureText","measureUsingCanvas","LoopArrow","nodeRadius","straightLength","spreadDegrees","shaftWidth","headWidth","headLength","spread","Math","PI","r1","r2","r3","loopRadius","tan","shaftRadius","shaftLength","Point","normalPoint","sweep","displacement","localLoopRadius","cos","sin","startPoint","endPoint","inner","outer","minWidth","max","StraightArrow","startRadius","endRadius","centreDistance","headHeight","deflection","startArrow","endShaft","endArrow","headRadius","startBreak","endBreak","ArcArrow","endCentre","arrowWidth","square","l","deflectionRadians","startAttach","radiusRatio","homotheticCenter","endAttach","fixedPoint","xCenter","polarity","gradient","hc","A","B","C","intersection","sqrt","intersectWithOtherCircle","g1","c1","g2","arcRadius","startAngle","atan2","endAngle","sweepAngle","midShaftAngle","startTangent","dr","dx","endTangent","dy","angleTangent","angle","endNormal","dc","endOverlayCorner","shoulder","arrowTip","coord","point","positiveSweep","negativeSweep","captionSweep","PairwiseArcsRelationshipRouting","padding","measureRelationshipCaption","captionFitsInsideArrowShaftWidth","isLoop","targetWidth","substr","nodePairs","distance","result1","separation","angles","end","start","biggestGap","result2","groupedRelationships","computeGeometryForNonLoopArrows","distributeAnglesForLoopArrows","middleRelationshipIndex","numberOfSteps","deflectionStep","shortenCaption","NeoD3Geometry","relationshipRouting","fitCaptionIntoCircle","template","setNodeRadii","formatNodeCaptions","formatRelationshipCaptions","measureRelationshipCaptions","layoutRelationships","noEmptyLines","lines","captionText","lineHeight","measure","words","emptyLine","lineCount","iLine","containingHeight","lineWidth","remainingWidth","fitOnFixedNumberOfLines","iWord","asc","word","addShortenedNextWord","consumedWords","maxLines","candidateLines","candidateWords","icons","Unlock","New","Delete","Edit","Remove","arc","itemNumber","innerRadius","outerRadius","padAngle","getSelectedNode","createMenuItem","eventName","position","textValue","helpValue","path","iconPath","tab","rawSvgIcon","event","elems","elem","stopPropagation","trigger","attachContextEvent","transform","floor","centroid","transition","duration","donutRemoveNode","donutExpandNode","donutUnlockNode","donutDeleteNode","donutNewNode","donutEditNode","menu","getRightClickedNode","rec","txt","donutClearNode","donutContraryNode","donutBackStatus","donutInitStatus","donutMadeChart","donutAddRel","rightMenu","rightMenu1","clickHandler","dispatch","rebind","down","wait","__data__","mouse","body","pow","clearTimeout","dblclick","click","setTimeout","vizFn","el","measureSize","layout","root","baseGroup","rect","container","geometry","draw","layoutDimension","updateViz","onNodeDragToggle","onRelationshipClick","onNodeMouseOut","onRelMouseOver","onRelMouseOut","zoomLevel","zoomed","zoomBehavior","translate","scale","behavior","zoom","scaleExtent","interpolateZoom","tween","t","s","isZoomingIn","zoomInClick","zoomClick","zoomOutClick","element","limitsReached","zoomInLimit","zoomOutLimit","Number","toFixed","call","newStatsBucket","bucket","frameCount","relationshipRenderers","timings","vizRenderers","lastFrame","firstFrame","layoutSteps","time","renderers","layoutTime","totalRenderTime","reduce","prev","currentStats","now","performance","Date","force","startRender","nodeGroups","renderer","relationshipGroups","startRenderer","drag","collectStats","latestStats","layers","self","leftMenu","show","menuRenderer","resize","size","getBBox","vizClickHandler","ctrlKey","collision","avoidOverlap","q","geom","quadtree","n","visit","collide","nx1","nx2","ny1","ny2","quad","x1","y1","x2","y2","render","forceLayout","d3force","linkDistance","charge","maxStepsPerTick","d3Tick","tick","startTick","step","startCalcs","accelerateLayout","original","clone","cloneArray","oneRelationshipPerPairOfNodes","center","unlocatedNodes","circularLayout","links","callbacks","args","callback","apply","arguments","GraphComponent","graphStyle","graphStyleData","rebasedStyle","deepmerge","state","initGraph","initGraphs","stats","zoomInLimitReached","zoomOutLimitReached","shouldResize","graphEH","canvas","svgObj","svgData","createElement","canvg","toDataURL","downloadPNGFromSVG","gainPngBase64","info","relMap","nodeMap1","relMap1","checkNodeExtendRelToggle","gainRelByNode","resetEH","initSeleced","ds","toggleNodeBylabels","toggleRelByLabels","removeNodeByLabels","removeRelByLabels","updateNodeProps","updateRelProps","styleProp","zoomOut","zoomIn","nodesDetail","all","curr","taken","deduplicateNodes","parseInt","initialNodeDisplay","initGraphView","setState","getStats","a1","a2","obj1","frameHeight","fullscreen","parentNode","offsetHeight","currentNeighbours","NeoConstructor","createGraph","offsetWidth","getVisualAreaHeight","onItemSelect","bindEventHandlers","graphInit","Component","RangePicker","DatePicker","Option","Select","Header","useState","setTime","hasPro","setHasPro","hasFound","setHasFound","allPro","setAllPro","allFound","setAllFound","jsonData","useRef","toHandleJson","json","allProject","date","description","found","project","round","icon","UploadOutlined","onChange","selectedFile","files","reader","FileReader","readAsText","onload","JSON","message","error","locale","zhCN","moment","format","mode","marginLeft","placeholder","optionLabelProp","offset","onClick","cloneDeep","p","includes","fName","allFounds","f","endNode","startNode","foundItem","onGeneral","React","memo","Drawers","visible","setVisible","useEffect","title","placement","closable","onClose","d3Force","isFirst","setShow","setNode","num","setNum","Drawer","image","Empty","PRESENTED_IMAGE_SIMPLE","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.027e499b.chunk.js","sourcesContent":["\nexport default class Renderer {\n  onGraphChange = null\n  onTick = null\n  constructor (opts) {\n    if (opts == null) {\n      opts = {}\n    }\n    Object.assign(this, opts)\n    if (this.onGraphChange === null) {\n      this.onGraphChange = function () {}\n    }\n    if (this.onTick === null) {\n      this.onTick = function () {}\n    }\n  }\n}\n","import Renderer from '../components/renderer'\nconst noop = function () {}\n\nconst nodeRingStrokeSize = 8\n\n// 图片\nconst nodeDefs = new Renderer({\n  onGraphChange (selection, viz) {\n    const defs = selection.selectAll('defs.img').data(node => [node])\n    \n    defs.enter().append('defs').append('pattern').classed('pattern', true).attr({\n      patternContentUnits: 'objectBoundingBox',\n      id: 'avatar',\n      width: '100%',\n      height: '100%'\n    }).append('image').attr({\n      'height': 1,\n      'width': 1,\n      // 'xlink:href':'http://'\n      // 加了此处图片导出出错 后续跟进  TODO\n      'xlink:href': 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAEjklEQVR4nO3c2UrrUBTG8b9SpWLF4nHAEfXeN1BUFOcBRUUfwu74JDYd0Lb4SqWt4oBeOqB3ouKVei48nGOPTZudbjtlr8uma6/w40sCSUhdLBb74Acqk8kQi8WUrTc9Pc3a2ppUz9HREclkUsl8r9eLYRj09/dn/V6vZPX/yi148AOAbsIDxYBuwwPwKJlE7eE1NTUhhMiLB4oS6FY8UJDAdDpNPB4vdpm/NTMzw+rqqlRPufCgyAS6HQ+KSGAl4CUSCVKplJL5TU1NGIZBX1+f7Z6rqytnCdR4n3jhcFg+gRrvEy8UCvH29iaXQI2XjQcSFxGN9x0PbF5Eag2vubmZQCBQNB7YAEylUiQSCfm9tKjZ2VlWVlakesqNd3l5STgc/oYHBQ5hjZcfD/IksBLw4vE46XRayfzm5maEEPT29truKYQHFgnUePbwIEcCNd4nXigU4v39veB/sxKo8eTw4AugxpPHgz+HcK3h+Xw+AoHAj+MBeJLJJEdHR7L7aFluwgOo83g8yh5rzs3Nsby8LNVTbryLiwsikYgjPFD4UMmNeKDooZITvFgsRiaTUTEen8+HEIKenh7bPSrwQEEC3YwHRSawWvHC4TAfH2pO/Y4TqPFgdHTUGaDG+8Tb2dmRB9R4//BA8hw4Pz/P0tKS1LBy452fnxOJRH4EDyQANR6MjY2xvb2d9ZstQCd4h4eHHB8fS/VYlc/nwzAMuru7bfeUAg9sXIU1njUeFEhgufFaWloQQkjjhcNhJfMhPx7kSaDGK4z3+vqaO4HViHd2dkYkElEyH2B8fJytrS3L7a+vr5im+R1Q49nDCwaDXF9fZx/CGk8OD75cRBYWFlhcXJQa5nY8+APoBO/g4ICTkxOHu5pd1YoH4KkEvL29Pbq6umz3lBrv5eWFUCj0DQ+gXuM5xwPJmwkq8VpbWxFCVDUeSACWG+/09JRoNKpkPqjBA5uAtYY3MTHB5uam5faXlxdM0+Tm5qbgWgUBo9Eop6encntoUa2trRiGQWdnp+2eSsaDAndjNF7hsgTUePYqJ6DGs1/fzoFuw3t+fiYUCjnCg/8AVeL5/X6EEDWNB18OYY3nrDxQfryTkxMODg6UzAeYnJxkY2PDcrsqPIC6kZGRj7Ozs6IXgurBM02T29tbJfOUvWDp9/sxDIOOjg7bPdWONzAwoOYFS7fiCSGKB3QzntfrLQ7Q7XhQxAuWbsQbHBxkd3f3Lx44fMFS4/0r6QQ6wTs+Pubw8FB2lGVNTU2xvr5uub1UeCAJWC14wWCQu7s7JfMGBwcRQtDY2Jhzu21Av9/P3t4e7e3ttofXOh7YBKwGvKenJ0zTVIY3NDREIBDIiwc2LiIaL3/lBdR4hcsSUOPZq5znwLa2NoQQFY+3v7/P/f29knlO8CBHAjWeXGUl0Aleqb9eWUl48AXQrXhCCBoaGhyv4YFPPMMw+PXrl+3GUuM9Pj5immZF4QF43Ig3PDxMIBAoGg+gXuMVVx4ZPNWfwat2PJC4mVAOvGAwyMPDg5J5P4EHNm+oajzrKpjAUn+9sprwAH4DZmdcmtPQSQAAAAAASUVORK5CYII='\n    });\n\n    return defs.exit().remove()\n  },\n  onTick: noop\n})\n\nconst nodeOutline = new Renderer({\n  onGraphChange (selection, viz) {\n    const circles = selection.selectAll('circle.outline').data(node => [node])\n    circles\n      .enter()\n      .append('circle')\n      .classed('outline', true)\n      .attr({\n        cx: 0,\n        cy: 0\n      })\n    circles.attr({\n      r (node) {\n        return node.radius\n      },\n      fill (node) {\n        if(node.isFilter){\n          return 'url(#avatar)';\n        }\n        // if(/[frame|rootNode1|rootNode2]/.test(node.className)){\n          // return `url(#avatar)`\n        // }\n        return viz.style.forNode(node).get('color')\n      },\n      stroke (node) {\n        return viz.style.forNode(node).get('border-color')\n      },\n      'stroke-width' (node) {\n        return viz.style.forNode(node).get('border-width')\n      }\n    })\n\n    return circles.exit().remove()\n  },\n  onTick: noop\n})\n\nconst nodeCaption = new Renderer({\n  onGraphChange (selection, viz) {\n    const text = selection.selectAll('text.caption').data(node => node.caption)\n\n    text\n      .enter()\n      .append('text')\n      .classed('caption', true)\n      .attr({ 'text-anchor': 'middle' })\n      .attr({ 'pointer-events': 'none' })\n    \n    text\n      .text(line => {\n        // console.log(line);\n        // /[frame|rootNode1|rootNode2]/.test(line.node.className) ? '' : line.text\n        return line.text\n      })\n      .attr('y', line => line.baseline)\n      .attr('font-size', line => viz.style.forNode(line.node).get('font-size'))\n      .attr({\n        fill (line) {\n          return viz.style.forNode(line.node).get('text-color-internal')\n        }\n      })\n      // console.log(text);\n    return text.exit().remove()\n  },\n\n  onTick: noop\n})\n\nconst nodeIcon = new Renderer({\n  onGraphChange (selection, viz) {\n    const text = selection.selectAll('g').data(node => node.caption)\n    text\n      .enter()\n      .append('text')\n      .attr({ 'text-anchor': 'middle' })\n      .attr({ 'pointer-events': 'none' })\n      .attr({ 'font-family': 'streamline' })\n\n    text\n      .text(line => viz.style.forNode(line.node).get('icon-code'))\n      .attr('dy', line => line.node.radius / 16)\n      .attr('font-size', line => line.node.radius)\n      .attr({\n        fill (line) {\n          return viz.style.forNode(line.node).get('text-color-internal')\n        }\n      })\n\n    return text.exit().remove()\n  },\n\n  onTick: noop\n})\n\nconst nodeRing = new Renderer({\n  onGraphChange (selection) {\n    const circles = selection.selectAll('circle.ring').data(node => [node])\n    circles\n      .enter()\n      .insert('circle', '.outline')\n      .classed('ring', true)\n      .attr({\n        cx: 0,\n        cy: 0,\n        'stroke-width': nodeRingStrokeSize + 'px'\n      })\n\n    circles.attr({\n      r (node) {\n        return node.radius + 4\n      }\n    })\n\n    return circles.exit().remove()\n  },\n\n  onTick: noop\n})\n\nconst arrowPath = new Renderer({\n  name: 'arrowPath',\n  onGraphChange (selection, viz) {\n    const paths = selection.selectAll('path.outline').data(rel => [rel])\n\n    paths\n      .enter()\n      .append('path')\n      .classed('outline', true)\n\n    paths\n      .attr('fill', rel => viz.style.forRelationship(rel).get('color'))\n      .attr('stroke', 'none')\n\n    return paths.exit().remove()\n  },\n\n  onTick (selection) {\n    return selection\n      .selectAll('path')\n      .attr('d', d => d.arrow.outline(d.shortCaptionLength))\n  }\n})\n\n\n\n\n\nconst relationshipBg = new Renderer({\n  name: 'relationshipBg',\n  onGraphChange (selection, viz) {\n    const texts = selection.selectAll('rect').data(rel => [rel])\n\n    texts\n      .enter()\n      .append('rect')\n    return texts.exit().remove()\n  },\n\n  onTick (selection, viz) {\n    return selection\n      .selectAll('rect')\n      .attr('x', rel => rel.arrow.midShaftPoint.x - rel.captionLength/2)\n      .attr('width', rel => rel.captionLength)\n      .attr('height', rel => rel.captionHeight+5)\n      .attr('fill' ,   rel => {\n        if(rel.isFilter){\n          return 'url(#avatar)'\n        }\n        return 'none'\n      } )\n      .attr(\n        'y',\n        rel =>\n          rel.arrow.midShaftPoint.y +\n          parseFloat(viz.style.forRelationship(rel).get('font-size')) / 2 -\n          1 - (rel.captionHeight+10)/2\n      )\n      .attr('transform', function (rel) {\n        if (rel.naturalAngle < 90 || rel.naturalAngle > 270) {\n          return `rotate(180 ${rel.arrow.midShaftPoint.x} ${\n            rel.arrow.midShaftPoint.y\n          })`\n        } else {\n          return null\n        }\n      })\n  }\n})\n\n\n\n// 增加文字的text\nconst relationshipType = new Renderer({\n  name: 'relationshipType',\n  onGraphChange (selection, viz) {\n    const texts = selection.selectAll('text').data(rel => [rel])\n\n    texts\n      .enter()\n      .append('text')\n      .attr({ 'text-anchor': 'middle' })\n      .attr({ 'pointer-events': 'none'  })\n\n    texts\n      .attr('font-size', rel => viz.style.forRelationship(rel).get('font-size'))\n      .attr('fill', rel =>{\n        if(rel.isFilter){\n          return 'white'\n        }\n          return viz.style.forRelationship(rel).get(`text-color-${rel.captionLayout}`)\n        }\n      )\n\n    return texts.exit().remove()\n  },\n\n  onTick (selection, viz) {\n    return selection\n      .selectAll('text')\n      .attr('x', rel => rel.arrow.midShaftPoint.x)\n      .attr(\n        'y',\n        rel =>\n          rel.arrow.midShaftPoint.y +\n          parseFloat(viz.style.forRelationship(rel).get('font-size')) / 2 -\n          1\n      )\n      .attr('transform', function (rel) {\n        if (rel.naturalAngle < 90 || rel.naturalAngle > 270) {\n          return `rotate(180 ${rel.arrow.midShaftPoint.x} ${\n            rel.arrow.midShaftPoint.y\n          })`\n        } else {\n          return null\n        }\n      })\n      .text(rel => rel.shortCaption)\n  }\n})\n\nconst relationshipOverlay = new Renderer({\n  name: 'relationshipOverlay',\n  onGraphChange (selection) {\n    const rects = selection.selectAll('path.overlay').data(rel => [rel])\n\n    rects\n      .enter()\n      .append('path')\n      .classed('overlay', true)\n\n    return rects.exit().remove()\n  },\n\n  onTick (selection) {\n    const band = 16\n\n    return selection\n      .selectAll('path.overlay')\n      .attr('d', d => d.arrow.overlay(band))\n  }\n})\n\nconst node = []\nnode.push(nodeOutline)\nnode.push(nodeIcon)\nnode.push(nodeCaption)\nnode.push(nodeRing)\nnode.push(nodeDefs)\nconst nodeSelf = [];\nnodeSelf.push(nodeOutline)\nnodeSelf.push(nodeIcon)\nnodeSelf.push(nodeCaption)\nnodeSelf.push(nodeRing)\n\nconst relationship = []\nrelationship.push(arrowPath)\nrelationship.push(relationshipBg)\nrelationship.push(relationshipType)\nrelationship.push(nodeDefs)\nrelationship.push(relationshipOverlay)\n// relationship.push(relOutline)\n\nconst relationshipSelf = [];\nrelationshipSelf.push(arrowPath)\nrelationshipSelf.push(relationshipBg)\nrelationshipSelf.push(relationshipType)\nrelationshipSelf.push(relationshipOverlay)\n// relationshipSelf.push(relOutline)\n\n\n\nexport { node, relationship , nodeSelf , relationshipSelf }\n","import { relationship } from \"../renders/init\";\n\nexport default class Graph {\n  constructor (config) {\n    this.addNodes = this.addNodes.bind(this)\n    this.removeNode = this.removeNode.bind(this)\n    this.updateNode = this.updateNode.bind(this)\n    this.removeConnectedRelationships = this.removeConnectedRelationships.bind(\n      this\n    )\n    this.initConfig = config;\n    this.resetGraph = this.resetGraph.bind(this);\n    this.addRelationships = this.addRelationships.bind(this)\n    this.addInternalRelationships = this.addInternalRelationships.bind(this)\n    this.pruneInternalRelationships = this.pruneInternalRelationships.bind(this)\n    this.findNode = this.findNode.bind(this)\n    this.findNodeNeighbourIds = this.findNodeNeighbourIds.bind(this)\n    this.findRelationship = this.findRelationship.bind(this)\n    this.findAllRelationshipToNode = this.findAllRelationshipToNode.bind(this)\n    this.nodeMap = {}\n    this.nodeLabelsMap = {};\n    this.relLabelsMap = {};\n    this.expandedNodeMap = {}\n    this._nodes = []\n    this.relationshipMap = {}\n    this._relationships = []\n    this.filterNodeByLabelMap = {}\n    this.filterRelByLabelMap = {}\n    this.isCtrlClick = false\n  }\n\n  nodes () {\n    return this._nodes\n  }\n\n  relationships () {\n    return this._relationships\n  }\n\n  groupedRelationships () {\n    const groups = {}\n    for (let relationship of Array.from(this._relationships)) {\n      let nodePair = new NodePair(relationship.source, relationship.target)\n      nodePair = groups[nodePair] != null ? groups[nodePair] : nodePair\n      nodePair.relationships.push(relationship)\n      groups[nodePair] = nodePair\n    }\n    return (() => {\n      const result = []\n      for (let ignored in groups) {\n        const pair = groups[ignored]\n        result.push(pair)\n      }\n      return result\n    })()\n  }\n\n  addNodes (nodes) {\n    for (let node of Array.from(nodes)) {\n      if (this.findNode(node.id) == null) {\n        this.nodeMap[node.id] = node\n        this._nodes = Object.values(this.nodeMap)\n      }\n      this.addNodesLabelsMap(node);\n      \n    }\n    return this\n  }\n  addNodesLabelsMap(node){\n    if(node.labels.length > 0){\n       node.labels.map(v=>{\n          if(!this.nodeLabelsMap[v]){\n            this.nodeLabelsMap[v] = [];\n          }\n          // 增加的新的节点 如果label 为过滤则不显示\n          if(this.filterNodeByLabelMap[v]){\n            node.display = 'hide'\n          }\n          this.nodeLabelsMap[v].push(node.id);\n          this.nodeLabelsMap[v] = [... new Set (this.nodeLabelsMap[v])];\n       })\n    }\n    return this;\n  }\n  addExpandedNodes = (node, nodes) => {\n    for (let eNode of Array.from(nodes)) {\n      if (this.findNode(eNode.id) == null) {\n        this.nodeMap[eNode.id] = eNode\n        this._nodes.push(eNode)\n        this.expandedNodeMap[node.id] = this.expandedNodeMap[node.id]\n          ? this.expandedNodeMap[node.id].concat([eNode.id])\n          : [eNode.id]\n      }\n      this.addNodesLabelsMap(eNode);\n    }\n  }\n\n  removeNode (node) {\n    if (this.findNode(node.id) != null) {\n      delete this.nodeMap[node.id]\n      this._nodes.splice(this._nodes.indexOf(node), 1)\n    }\n    return this\n  }\n  removeNodes (nodes,ids){\n    if(ids){\n      ids.map(v=>{\n        if(this.nodeMap[v]){\n          this.removeConnectedRelationships(this.nodeMap[v]);\n          this.removeNode(this.nodeMap[v]);\n        }\n      })\n    }else{\n      nodes.map(v=>{\n        this.removeNode(v);\n      })\n    }\n  }\n  removeNodeByLabels(labels){\n    let arr = [];\n    labels.forEach(v=>{\n      arr = arr.concat(this.nodeLabelsMap[v]);\n      delete this.nodeLabelsMap[v];\n    })\n    this.removeNodes(null,[...new Set(arr)]);\n  }\n  removeRelByLabels(labels){\n    let arr = [];\n    labels.forEach(v=>{\n      arr = arr.concat(this.relLabelsMap[v]);\n      delete this.relLabelsMap[v];\n    })\n    this.removeRels(null,[...new Set(arr)]);\n  }\n  removeRels(rels,ids){\n    if(ids){\n      ids.map(v=>{\n        if(this.relationshipMap[v]){\n          this.removeRel(this.relationshipMap[v]);\n        }\n      })\n    }\n  }\n  toggleNodeBylabels(labels){\n    let nodes  = Object.values(this.nodeMap);\n    labels.forEach(v1=>{\n      if(!this.isPro(this.filterNodeByLabelMap,v1)){\n        this.filterNodeByLabelMap[v1] = true;\n      }else{\n        this.filterNodeByLabelMap[v1] = !this.filterNodeByLabelMap;\n      }\n      nodes.forEach(v=>{\n        let init = v.display;\n            if(v.labels.indexOf(v1) != -1){\n              v.display = this.changeDisplay(init);\n            }\n        this.nodeMap[v.id] = v;\n      })\n    })\n    this._nodes = Object.values(nodes)\n    return this\n  }\n  checkNodeExtendRelToggle(){\n    let rels = Object.values(this.relationshipMap);\n    rels.forEach(r=>{\n      if(r.target.display == 'hide' || r.source.display == 'hide' || this.filterRelByLabelMap[r.type]){\n        r.display = 'hide';\n      }else {\n         if(!this.filterRelByLabelMap[r.type]){\n             r.display = 'show';\n         }\n      }\n      this.relationshipMap[r.id]  = r\n      this._relationships.splice(this._relationships.indexOf(r),1,r);\n    })\n  }\n  isPro(obj,key){\n    return obj.hasOwnProperty(key);\n  }\n  changeDisplay(value){\n    if(value == 'unvalue'){\n      return 'hide';\n    }\n    if(value == 'show'){\n      return 'hide'\n    }\n    if(value = 'hide'){\n      return 'show'\n    }\n  }\n  toggleRelByLabels(labels){\n    let rels = Object.values(this.relationshipMap);\n    labels.forEach(v1=>{\n      if(!this.isPro(this.filterRelByLabelMap,v1)){\n        this.filterRelByLabelMap[v1] = true;\n      }else{\n        this.filterRelByLabelMap[v1] = !this.filterRelByLabelMap[v1];\n      }\n      rels.forEach(v=>{\n            let init = this.changeDisplay(v.display);\n            if(v.type == v1){\n              v.display = init;\n              this.relationshipMap[v.id] = v;\n              this._relationships.splice(this._relationships.indexOf(v),1,v);\n            }\n      })\n    })\n  }\n  removeRel(rel){\n    if( rel && this.relationshipMap[rel.id] ){\n      delete this.relationshipMap[rel.id];\n      this._relationships.splice(this._relationships.indexOf(rel), 1);\n    }\n    return this\n  }\n  collapseNode = node => {\n    if (!this.expandedNodeMap[node.id]) {\n      return\n    }\n    this.expandedNodeMap[node.id].forEach(id => {\n      const eNode = this.nodeMap[id]\n      this.collapseNode(eNode)\n      this.removeConnectedRelationships(eNode)\n      this.removeNode(eNode)\n    })\n    this.expandedNodeMap[node.id] = []\n  }\n\n  updateNode (node) {\n    if (this.findNode(node.id) != null) {\n      this.removeNode(node)\n      node.expanded = false\n      node.minified = true\n      this.addNodes([node])\n    }\n    return this\n  }\n  updateNodeProps(node){\n    if (this.findNode(node.id) != null) {\n      this.nodeMap[node.id] = Object.assign(this.nodeMap[node.id] , node)\n      this._nodes.splice(this._nodes.indexOf(node), this.nodeMap[node.id])\n    }\n    return this\n  }\n  updateRelProps(relationship){\n    if(this.relationshipMap[relationship.id] != null){\n      this.relationshipMap[relationship.id] = Object.assign(this.relationshipMap[relationship.id] , relationship)\n      this._relationships.splice(this._relationships.indexOf(relationship), 1 , this.relationshipMap[relationship.id])\n    }\n    return this\n  }\n  updateNodes (nodes){\n    for (let node of Array.from(nodes)) {\n      this.nodeMap[node.id]  = node\n      this._nodes = Object.values(this.nodeMap);\n    }\n    return this\n  }\n  updateRelationships(relations){\n    for (let r of Array.from(relations)) {\n      this.relationshipMap[r.id]  = r\n      this._relationships = Object.values(this.relationshipMap);\n    }\n    return this\n\n  }\n\n  removeConnectedRelationships (node) {\n    for (let r of Array.from(this.findAllRelationshipToNode(node))) {\n      this.updateNode(r.source)\n      this.updateNode(r.target)\n      this._relationships.splice(this._relationships.indexOf(r), 1)\n      delete this.relationshipMap[r.id]\n    }\n    return this\n  }\n  removeConnectedRelationshipss(nodes){\n    nodes.map(v=>{\n      this.removeConnectedRelationships(v)\n    })\n  }\n  gainRelByNode(arr){\n    let nodes  = [] , relationships = [];\n    let nMap = {};\n    arr.forEach(v=>{\n      nMap[v] = true;\n    })\n    arr.forEach(v=>{\n      if(this.findNode(v)){\n        nodes.push(this.findNode(v))\n      }\n    })\n    this._relationships.forEach(v=>{\n      if(nMap[v.source.id] && nMap[v.target.id]){\n        relationships.push(v);\n      }\n    })\n    return {nodes,relationships}\n  }\n\n  addRelationships (relationships) {\n    for (let relationship of Array.from(relationships)) {\n      const existingRelationship = this.findRelationship(relationship.id)\n      this.addRelLabelsMap(relationship);\n      if (existingRelationship != null) {\n        existingRelationship.internal = false\n      } else {\n        relationship.internal = false\n        this.relationshipMap[relationship.id] = relationship\n        this._relationships.push(relationship)\n      }\n    }\n    return this\n  }\n  addRelLabelsMap(rel){\n    if(rel.type){\n      if(!this.relLabelsMap[rel.type]){\n        this.relLabelsMap[rel.type] = [];\n      }\n      if(this.filterRelByLabelMap[rel.type]){\n        rel.display = 'hide';\n      }else{\n        rel.display = 'show';\n      }\n      this.relLabelsMap[rel.type].push(rel.id);\n      this.relLabelsMap[rel.type] = [... new Set (this.relLabelsMap[rel.type])];\n    }\n    return this;\n  }\n\n  addInternalRelationships (relationships) {\n    for (let relationship of Array.from(relationships)) {\n      relationship.internal = true\n      if (this.findRelationship(relationship.id) == null) {\n        this.relationshipMap[relationship.id] = relationship\n        this._relationships.push(relationship)\n      }\n    }\n    return this\n  }\n\n  pruneInternalRelationships () {\n    const relationships = this._relationships.filter(\n      relationship => !relationship.internal\n    )\n    this.relationshipMap = {}\n    this._relationships = []\n    return this.addRelationships(relationships)\n  }\n\n  findNode (id) {\n    return this.nodeMap[id]\n  }\n\n  findNodeNeighbourIds (id) {\n    return this._relationships\n      .filter(\n        relationship =>\n          relationship.source.id === id || relationship.target.id === id\n      )\n      .map(function (relationship) {\n        if (relationship.target.id === id) {\n          return relationship.source.id\n        }\n        return relationship.target.id\n      })\n  }\n\n  findRelationship (id) {\n    return this.relationshipMap[id]\n  }\n\n  findAllRelationshipToNode (node) {\n    return this._relationships.filter(\n      relationship =>\n        relationship.source.id === node.id || relationship.target.id === node.id\n    )\n  }\n\n  resetGraph () {\n    this.nodeMap = {}\n    this._nodes = []\n    this.relationshipMap = {}\n    this.filterRelByLabelMap = {}\n    this.filterNodeByLabelMap = {}\n    this.nodeLabelsMap = {}\n    this.relLabelsMap = {}\n    this.isCtrlClick = false\n    return (this._relationships = [])\n  }\n  initSeleced(){\n    this.isCtrlClick = false\n  }\n}\n\nclass NodePair {\n  constructor (node1, node2) {\n    this.relationships = []\n    if (node1.id < node2.id) {\n      this.nodeA = node1\n      this.nodeB = node2\n    } else {\n      this.nodeA = node2\n      this.nodeB = node1\n    }\n  }\n\n  isLoop () {\n    return this.nodeA === this.nodeB\n  }\n\n  toString () {\n    return `${this.nodeA.id}:${this.nodeB.id}`\n  }\n}\n","export default class Node {\n  isNode = true\n  isRelationship = false\n\n  constructor (id, labels, properties,className ) {\n    this.id = id\n    this.labels = [properties.label_for_match];\n    // this.labels = labels;\n    // console.log(labels);\n    this.labelsAll = labels;\n    this.className = className\n    this.display = 'unvalue';\n    this.isFilter = false;\n    this.propertyMap = properties\n    this.propertyList = (() => {\n      const result = []\n      for (let key of Object.keys(properties || {})) {\n        const value = properties[key]\n        result.push({ key, value })\n      }\n      return result\n    })()\n  }\n\n  toJSON () {\n    return this.propertyMap\n  }\n  gainMaxLabel(labels){\n    if(labels.length == 1) return labels;\n    let arr = [\"changed\" ,\"added\"  ,\"deleted\"  ,\"Notupdated\"  ,\"cryptoRelated\"  ,\"UncryptoRelated\",\"Tech\"];\n    for(let i = 0 ; i < labels.length ; i ++){\n      if(labels[i] == 'Capital'){\n        return ['Capital'];\n      }\n      if(labels[i] == 'School'){\n        return ['School'];\n      }\n      if(labels[i] == 'Project'){\n        return ['Project'];\n      }\n      if(labels[i] == 'Person'){\n        return ['Person'];\n      }\n      if(arr.indexOf(labels[i]) != -1){\n        return [labels[i]]\n      }\n    }\n  }\n\n  relationshipCount (graph) {\n    const node = this\n    const rels = []\n    for (let relationship of Array.from(graph.relationships())) {\n      if (relationship.source === node || relationship.target === node) {\n        rels.push(relationship)\n      }\n    }\n    return rels.length\n  }\n}\n","export default class Relationship {\n  isNode = false\n  isRelationship = true\n  constructor (id, source, target, type, properties , className) {\n    this.id = id\n    this.source = source\n    this.target = target\n    this.type = type\n    this.display = 'unvalue';\n    this.className = className\n    this.propertyMap = properties\n    this.propertyList = (() => {\n      const result = []\n      for (let key of Object.keys(this.propertyMap || {})) {\n        const value = this.propertyMap[key]\n        result.push({ key, value })\n      }\n      return result\n    })()\n  }\n\n  toJSON () {\n    return this.propertyMap\n  }\n  isLoop () {\n    return this.source === this.target\n  }\n}\n","import { optionalToString } from '../shared/services/utils'\nimport Graph from './lib/visualization/components/graph'\nimport Node from './lib/visualization/components/node'\nimport Relationship from './lib/visualization/components/relationship'\n\nconst mapProperties = _ => Object.assign({}, ...stringifyValues(_))\nconst stringifyValues = obj =>\n  Object.keys(obj).map(k => ({ [k]: optionalToString(obj[k]) }))\n\nexport function createGraph (nodes, relationships , config) {\n  let graph = new Graph(config)\n  graph.addNodes(mapNodes(nodes))\n  graph.addRelationships(mapRelationships(relationships, graph))\n  graph.display = { initialNodeDisplay: 300, nodeCount: 1 }\n  return graph\n}\n\nexport function mapNodes (nodes) {\n  return nodes.map(\n    node => new Node(node.id, node.labels, mapProperties(node.properties) , node.className || '')\n  )\n}\n\nexport function mapRelationships (relationships, graph) {\n  return relationships.map(rel => {\n    const source = graph.findNode(rel.startNodeId)\n    const target = graph.findNode(rel.endNodeId)\n    return new Relationship(\n      rel.id,\n      source,\n      target,\n      rel.type,\n      mapProperties(rel.properties),\n      rel.className\n    )\n  })\n}\n\nexport function getGraphStats (graph) {\n  let labelStats = {}\n  let relTypeStats = {}\n  graph.nodes().forEach(node => {\n    node.labels.forEach(label => {\n      if (labelStats['*']) {\n        labelStats['*'].count = labelStats['*'].count + 1\n      } else {\n        labelStats['*'] = {\n          count: 1,\n          properties: []\n        }\n      }\n      if (labelStats[label]) {\n        labelStats[label].count = labelStats[label].count + 1\n        labelStats[label].properties = Object.assign(\n          {},\n          labelStats[label].properties,\n          node.propertyMap\n        )\n      } else {\n        labelStats[label] = {\n          count: 1,\n          properties: node.propertyMap\n        }\n      }\n    })\n  })\n  graph.relationships().forEach(rel => {\n    if (relTypeStats['*']) {\n      relTypeStats['*'].count = relTypeStats['*'].count + 1\n    } else {\n      relTypeStats['*'] = {\n        count: 1,\n        properties: []\n      }\n    }\n    if (relTypeStats[rel.type]) {\n      relTypeStats[rel.type].count = relTypeStats[rel.type].count + 1\n      relTypeStats[rel.type].properties = Object.assign(\n        {},\n        relTypeStats[rel.type].properties,\n        rel.propertyMap\n      )\n    } else {\n      relTypeStats[rel.type] = {\n        count: 1,\n        properties: rel.propertyMap\n      }\n    }\n  })\n  return { labels: labelStats, relTypes: relTypeStats }\n}\n","import d3 from \"d3\"\nimport { mapNodes, mapRelationships, getGraphStats } from './mapper'\n\nexport class GraphEventHandler {\n  constructor (\n    graph,\n    graphView,\n    getNodeNeighbours,\n    onItemMouseOver,\n    onItemSelected,\n    onGraphModelChange,\n    onEventListener\n  ) {\n    this.graph = graph\n    this.graphView = graphView\n    this.getNodeNeighbours = getNodeNeighbours\n    this.selectedItem = null\n    this.rightClickedItem = null;\n    this.onItemMouseOver = onItemMouseOver\n    this.onItemSelected = onItemSelected\n    this.onEventListener = onEventListener\n    this.onGraphModelChange = onGraphModelChange\n    this.ctrlClickedArr = [];\n    this.rightClickedMap = {};\n  }\n\n  graphModelChanged () {\n    this.onGraphModelChange(getGraphStats(this.graph))\n  }\n  resetEH (){\n    this.ctrlClickedArr = [];\n    this.rightClickedMap = {};\n    this.selectedItem = null\n    this.rightClickedItem = null;\n  }\n\n  selectItem (item) {\n    if (this.selectedItem) {\n      this.selectedItem.selected = false\n    }\n    this.selectedItem = item\n    item.selected = true\n    this.graphView.update()\n  }\n\n  deselectItem () {\n    let isUpdate =  this.selectedItem || this.rightClickedItem;\n    if (this.selectedItem) {\n      this.selectedItem.selected = false\n      this.selectedItem = null\n    }\n    if(this.rightClickedItem){\n      this.rightClickedItem.rightClicked = false\n      this.rightClickedItem = null\n    }\n    this.onItemSelected({\n      type: 'canvas',\n      item: {\n        nodeCount: this.graph.nodes().length,\n        relationshipCount: this.graph.relationships().length\n      }\n    })\n    if(isUpdate){\n      this.graphView.update();\n    }\n  }\n  clearSelected(){\n    if (this.selectedItem) {\n      this.selectedItem.selected = false\n      this.selectedItem = null\n    }\n    this.graphView.update();\n  }\n  clearRightSelected(){\n    if(this.rightClickedItem){\n      this.rightClickedItem.rightClicked = false\n      this.rightClickedItem = null\n    }\n    this.graphView.update();\n  }\n\n  nodeClose (d) {\n    this.graph.removeConnectedRelationships(d)\n    this.graph.removeNode(d)\n    this.deselectItem()\n    this.graphView.update()\n    this.graphModelChanged()\n  }\n\n  nodeClicked (d) {\n      if (!d) {\n        return\n      }\n      if(d.rightClicked){\n        d.rightClicked = false\n      }\n      d.fixed = true\n      if (!d.selected) {\n        this.selectItem(d)\n        this.onItemSelected({\n          type: 'node',\n          item: { id: d.id, labels: d.labels, properties: d.propertyList , layerX : d.px , layerY : d.py}\n        })\n      } else {\n        this.deselectItem()\n      }\n      \n      this.onEventListener({\n        type : 'nodeClicked',\n        item : d\n      })\n  }\n  onNodeCtrlClick(d){\n    if(!d) return;\n    if(!d.ctrlClicked){\n      d.ctrlClicked = true;\n      this.ctrlClickedArr.push(d.id)\n    }else{\n      d.ctrlClicked = false;\n      this.ctrlClickedArr = this.ctrlClickedArr.filter(v=>v.id != d.id)\n    }\n    this.onEventListener({\n      type : 'nodeCtrlClicked',\n      item : d\n    })\n    this.clearSelected();\n    this.clearRightSelected();\n    // this.graphView.update()\n  }\n  onNodeClickRight(d){\n    if(!d) return;\n    if(d.selected){\n      d.selected = false;\n    }\n    if(this.rightClickedItem && this.rightClickedItem.rightClicked){\n      this.rightClickedItem.rightClicked = false;\n    }\n    this.rightClickedItem = d;\n    if(!d.rightClicked){\n      d.rightClicked = true;\n      this.rightClickedMap[d.id] = d;\n    }else{\n      d.rightClicked = false;\n    }\n    \n    this.onEventListener({\n      type : 'nodeRightClicked',\n      item : d\n    })\n    this.clearSelected();\n  }\n\n  nodeUnlock (d) {\n    if (!d) {\n      return\n    }\n    d.fixed = false\n    this.deselectItem()\n  }\n  nodeDelete (d){\n    this.onEventListener({\n      type : 'nodeDelete',\n      item : d\n    })\n  }\n  nodeNew (d){\n    this.onEventListener({\n      type : 'nodeNew',\n      item : d\n    })\n  }\n  nodeEdit (d){\n    // message.success('修改节点,功能开发中!');\n    this.onEventListener({\n      type : 'nodeEdit',\n      item : d\n    })\n  }\n\n  nodeDblClicked (d) {\n    if (d.expanded) {\n      this.nodeCollapse(d)\n      d.expanded = false;\n    }else{\n      d.expanded = true;\n    }\n    this.onEventListener({\n      type : 'nodeDbClicked',\n      item : d\n    })\n  }\n\n  nodeCollapse (d) {\n    d.expanded = false\n    this.graph.collapseNode(d)\n    this.graphView.update()\n    this.graphModelChanged()\n  }\n\n  onNodeMouseOver (node) {\n    if (!node.contextMenu) {\n      this.onItemMouseOver({\n        type: 'node',\n        item: {\n          id: node.id,\n          labels: node.labels,\n          properties: node.propertyList\n        }\n      })\n    }\n    // 增加节点的hover事件\n    if (this.hoveredItem) {\n      this.hoveredItem.hovered = false\n    }\n    \n    this.onEventListener({\n      type : 'nodeMouseOver',\n      item : node\n    })\n    this.hoveredItem = node\n    node.hovered = true\n    // this.graphView.update();\n  }\n  onMenuMouseOver (itemWithMenu) {\n    this.onItemMouseOver({\n      type: 'context-menu-item',\n      item: {\n        label: itemWithMenu.contextMenu.label,\n        content: itemWithMenu.contextMenu.menuContent,\n        selection: itemWithMenu.contextMenu.menuSelection\n      }\n    })\n    this.onEventListener({\n      type : 'menuMouseOver',\n      item : itemWithMenu\n    })\n\n  }\n  onRelationshipMouseOver (relationship) {\n    this.onItemMouseOver({\n      type: 'relationship',\n      item: {\n        id: relationship.id,\n        type: relationship.type,\n        properties: relationship.propertyList\n      }\n    })\n    this.onEventListener({\n      type : 'relationshipMouseOver',\n      item : relationship\n    })\n  }\n\n  onRelationshipClicked (relationship) {\n    if (!relationship.selected) {\n      this.selectItem(relationship)\n      this.onItemSelected({\n        type: 'relationship',\n        item: {\n          id: relationship.id,\n          type: relationship.type,\n          properties: relationship.propertyList\n        }\n      })\n    } else {\n      this.deselectItem()\n    }\n    this.onEventListener({\n      type : 'relationshipClicked',\n      item : relationship\n    })\n  }\n\n  onCanvasClicked () {\n    // update 函数 放在 onEventListener 上方 会导致 页面svg节点抖动 位置重新计算\n    this.onEventListener({\n      type : 'canvasClicked',\n      item : null\n    })\n    \n    this.deselectItem()\n  }\n\n  onItemMouseOut (item) {\n    this.onItemMouseOver({\n      type: 'canvas',\n      item: {\n        nodeCount: this.graph.nodes().length,\n        relationshipCount: this.graph.relationships().length\n      }\n    })\n    this.onEventListener({\n      type : 'canvasMouseOver',\n      item \n    })\n  }\n// 反选\n  onContrarySelected(item){\n    this.onEventListener({\n      type : 'contrarySelected',\n      item\n    })\n    this.deselectItem()\n  }\n  //清除选择 \n  onClearSelected(item){\n    this.onEventListener({\n      type : 'clearSelected',\n      item\n    })\n    this.deselectItem()\n  }\n  // 撤回到上一种状态\n  onBackStatus(item){\n    this.onEventListener({\n      type : 'backStatus',\n      item\n    })\n    this.deselectItem()\n  }\n  // 回到初始状态\n  onInitStatus(item){\n    this.onEventListener({\n      type : 'initStatus',\n      item\n    })\n  }\n  // 播放过度动画\n  onStartFrame(item){\n    console.log(this.graph)\n    this.graph.resetGraph()\n    this.graphView.update()\n    this.onEventListener({\n      type : 'startFrame',\n      item : this.ctrlClickedArr\n    })\n  }\n  // 生成图\n  onMadeChart(item){\n    this.onEventListener({\n      type : 'madeChart',\n      item : this.ctrlClickedArr\n    })\n    this.deselectItem()\n  }\n  // 新增边\n  onAddRel(item){\n    this.onEventListener({\n      type : 'addRel',\n      item \n    })\n    this.deselectItem()\n  }\n\n  bindEventHandlers () {\n    this.graphView\n      .on('nodeMouseOver', this.onNodeMouseOver.bind(this))\n      .on('nodeMouseOut', this.onItemMouseOut.bind(this))\n      .on('menuMouseOver', this.onMenuMouseOver.bind(this))\n      .on('menuMouseOut', this.onItemMouseOut.bind(this))\n      .on('relMouseOver', this.onRelationshipMouseOver.bind(this))\n      .on('relMouseOut', this.onItemMouseOut.bind(this))\n      .on('relationshipClicked', this.onRelationshipClicked.bind(this))\n      .on('canvasClicked', this.onCanvasClicked.bind(this))\n      .on('nodeClose', this.nodeClose.bind(this))\n      .on('nodeClicked', this.nodeClicked.bind(this))\n      .on('nodeDblClicked', this.nodeDblClicked.bind(this))\n      .on('nodeUnlock', this.nodeUnlock.bind(this))\n      .on('nodeDelete', this.nodeDelete.bind(this))\n      .on('nodeNew', this.nodeNew.bind(this))\n      .on('nodeEdit', this.nodeEdit.bind(this))\n      .on('nodeCtrlClick', this.onNodeCtrlClick.bind(this))\n      .on('nodeClickRight', this.onNodeClickRight.bind(this))\n      .on('contrarySelected', this.onContrarySelected.bind(this))\n      .on('clearSelected', this.onClearSelected.bind(this))\n      .on('backStatus', this.onBackStatus.bind(this))\n      .on('initStatus', this.onInitStatus.bind(this))\n      .on('startFrame', this.onStartFrame.bind(this))\n      .on('madeChart',this.onMadeChart.bind(this))\n      .on('addRel',this.onAddRel.bind(this))\n    this.onItemMouseOut()\n  }\n}\n","\n/* global DOMParser */\n\nimport d3 from 'd3'\n\n\nd3.selection.enter.prototype.appendSVG = function (SVGString) {\n  return this.select(function () {\n    return this.appendChild(\n      document.importNode(\n        new DOMParser().parseFromString(SVGString, 'application/xml')\n          .documentElement.firstChild,\n        true\n      )\n    )\n  })\n}\n","/*\n * Copyright (c) 2002-2019 \"Neo4j,\"\n * Neo4j Sweden AB [http://neo4j.com]\n *\n * This file is part of Neo4j.\n *\n * Neo4j is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\nimport d3 from 'd3'\nexport const prepareForExport = (svgElement, graphElement, type) => {\n  const dimensions = getSvgDimensions(graphElement)\n  let svg = d3.select(\n    document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n  )\n\n  svg.append('title').text('Neo4j Graph Visualization')\n  svg.append('desc').text('Created using Neo4j (http://www.neo4j.com/)')\n\n  switch (type) {\n    case 'plan': {\n      svg = appendPlanLayers(svgElement, svg)\n      break\n    }\n    case 'graph':\n    default:\n      svg = appendGraphLayers(svgElement, svg)\n  }\n\n  svg.selectAll('.overlay, .ring').remove()\n  svg.selectAll('.context-menu-item').remove()\n  svg.selectAll('text').attr('font-family', 'sans-serif')\n\n  svg.attr('width', dimensions.width)\n  svg.attr('height', dimensions.height)\n  svg.attr('viewBox', dimensions.viewBox)\n\n  return svg\n}\n\nconst getSvgDimensions = view => {\n  let boundingBox, dimensions\n  boundingBox = view.boundingBox()\n  dimensions = {\n    width: boundingBox.width,\n    height: boundingBox.height,\n    viewBox: [\n      boundingBox.x,\n      boundingBox.y,\n      boundingBox.width,\n      boundingBox.height\n    ].join(' ')\n  }\n  return dimensions\n}\n\nconst appendGraphLayers = (svgElement, svg) => {\n  window.d3\n    .select(svgElement)\n    .selectAll('g.layer')\n    .each(function (node) {\n      svg.node().appendChild(\n        window.d3\n          .select(this)\n          .node()\n          .cloneNode(true)\n      )\n    })\n  return svg\n}\nconst appendPlanLayers = (svgElement, svg) => {\n  window.d3\n    .select(svgElement)\n    .selectAll('g.layer')\n    .each(function (node) {\n      svg.node().appendChild(\n        window.d3\n          .select(this)\n          .node()\n          .cloneNode(true)\n      )\n    })\n  return svg\n}\n","/*\n * Copyright (c) 2002-2019 \"Neo4j,\"\n * Neo4j Sweden AB [http://neo4j.com]\n *\n * This file is part of Neo4j.\n *\n * Neo4j is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport { prepareForExport } from './svgUtils'\nimport FileSaver from 'file-saver'\n\nexport const downloadPNGFromSVG = (svg, graph, type) => {\n  const svgObj = prepareForExport(svg, graph, type)\n  const svgData = htmlCharacterRefToNumericalRef(svgObj.node())\n  console.log(svgData)\n  let canvas\n  canvas = document.createElement('canvas')\n  canvas.width = svgObj.attr('width')\n  canvas.height = svgObj.attr('height')\n\n  window.canvg(canvas, svgData)\n  return downloadWithDataURI(type + '.png', canvas.toDataURL('image/png'))\n}\nexport const gainPngBase64 =(svg, graph, type) => {\n  const svgObj = prepareForExport(svg, graph, type)\n  const svgData = htmlCharacterRefToNumericalRef(svgObj.node())\n\n  let canvas\n  canvas = document.createElement('canvas')\n  canvas.width = svgObj.attr('width')\n  canvas.height = svgObj.attr('height')\n\n  window.canvg(canvas, svgData)\n  return gainbase64(type + '.png', canvas.toDataURL('image/png'))\n}\n\nconst gainbase64 = (filename, dataURI) => {\n  var byteString, i, ia, j, mimeString, ref\n  byteString = null\n  if (dataURI.split(',')[0].indexOf('base64') >= 0) {\n    byteString = window.atob(dataURI.split(',')[1])\n  } else {\n    byteString = unescape(dataURI.split(',')[1])\n  }\n  mimeString = dataURI\n    .split(',')[0]\n    .split(':')[1]\n    .split(';')[0]\n  ia = new Uint8Array(byteString.length)\n  for (\n    i = j = 0, ref = byteString.length;\n    ref >= 0 ? j <= ref : j >= ref;\n    i = ref >= 0 ? ++j : --j\n  ) {\n    ia[i] = byteString.charCodeAt(i)\n  }\n  return new Blob([ia], { type: mimeString })\n  return  'data:image/png;base64,'+ btoa(String.fromCharCode.apply(null, ia));\n}\n\nexport const downloadSVG = (svg, graph, type) => {\n  const svgObj = prepareForExport(svg, graph, type)\n  const svgData = htmlCharacterRefToNumericalRef(svgObj.node())\n\n  return download(type + '.svg', 'image/svg+xml;charset=utf-8', svgData)\n}\n\nconst htmlCharacterRefToNumericalRef = node =>\n  new window.XMLSerializer()\n    .serializeToString(node)\n    .replace(/&nbsp;/g, '&#160;')\n\nconst download = (filename, mime, data) => {\n  const blob = new Blob([data], { type: mime })\n  return FileSaver.saveAs(blob, filename)\n}\n\nconst downloadWithDataURI = (filename, dataURI) => {\n  var byteString, i, ia, j, mimeString, ref\n  byteString = null\n  if (dataURI.split(',')[0].indexOf('base64') >= 0) {\n    byteString = window.atob(dataURI.split(',')[1])\n  } else {\n    byteString = unescape(dataURI.split(',')[1])\n  }\n  mimeString = dataURI\n    .split(',')[0]\n    .split(':')[1]\n    .split(';')[0]\n  ia = new Uint8Array(byteString.length)\n  for (\n    i = j = 0, ref = byteString.length;\n    ref >= 0 ? j <= ref : j >= ref;\n    i = ref >= 0 ? ++j : --j\n  ) {\n    ia[i] = byteString.charCodeAt(i)\n  }\n  return download(filename, mimeString, ia)\n}\n","import {\n  selectorStringToArray,\n  selectorArrayToString\n} from '../shared/services/grassUtils'\n\nexport default function neoGraphStyle() {\n  // 修改默认的样式\n  const defaultStyle = {\n    \"node\": {\n      \"diameter\": \"35px\",\n      \"color\": \"#f9d684\",\n      \"border-color\": \"#f9d684\",\n      \"border-width\": \"2px\",\n      \"text-color-internal\": \"#454545\",\n      \"font-size\": \"10px\"\n    },\n    \"node.changed\": {\n      \"diameter\": \"25px\",\n      \"color\": \"#adadad\",\n      \"border-color\": \"#adadad\",\n      \"border-width\": \"2px\",\n      \"text-color-internal\": \"#454545\",\n      \"font-size\": \"10px\"\n    },\n    \"node.cryptoRelated\": {\n      \"diameter\": \"25px\",\n      \"color\": \"#adadad\",\n      \"border-color\": \"#adadad\",\n      \"border-width\": \"2px\",\n      \"text-color-internal\": \"#454545\",\n      \"font-size\": \"10px\"\n    },\n    \"node.UncryptoRelated\": {\n      \"diameter\": \"25px\",\n      \"color\": \"#adadad\",\n      \"border-color\": \"#adadad\",\n      \"border-width\": \"2px\",\n      \"text-color-internal\": \"#454545\",\n      \"font-size\": \"10px\"\n    },\n    \"relationship\": {\n      \"color\": \"#A5ABB6\",\n      \"shaft-width\": \"1px\",\n      \"font-size\": \"8px\",\n      \"padding\": \"3px\",\n      \"text-color-external\": \"#000000\",\n      \"text-color-internal\": \"#FFFFFF\",\n      \"caption\": \"<type>\"\n    },\n    \"node.Project\": {\n      \"color\": \"#346894\",\n      \"border-color\": \"#346894\",\n      \"text-color-internal\": \"#FFFFFF\",\n      \"defaultCaption\": \"<id>\",\n      \"diameter\": \"65px\",\n      \"caption\": \"{name}\"\n    },\n    \"node.Sector\": {\n      \"color\": \"#a75a29\",\n      \"border-color\": \"#a75a29\",\n      \"text-color-internal\": \"#ffffff\",\n      \"defaultCaption\": \"<id>\",\n      \"diameter\": \"80px\"\n    },\n    \"node.Capital\": {\n      \"color\": \"#09274b\",\n      \"border-color\": \"#09274b\",\n      \"text-color-internal\": \"#FFFFFF\",\n      \"defaultCaption\": \"<id>\",\n      \"diameter\": \"65px\"\n    },\n    \"node.Token\": {\n      \"color\": \"#346894\",\n      \"border-color\": \"#346894\",\n      \"text-color-internal\": \"#FFFFFF\",\n      \"defaultCaption\": \"<id>\",\n      \"diameter\": \"50px\"\n    },\n    \"node.Person\": {\n      \"color\": \"#d79d53\",\n      \"border-color\": \"#d79d53\",\n      \"text-color-internal\": \"#1c1c1c\",\n      \"defaultCaption\": \"<id>\",\n      \"caption\": \"{name}\",\n      \"diameter\": \"50px\"\n    },\n    \"node.School\": {\n      \"caption\": \"{name}\",\n      \"diameter\": \"80px\",\n      \"color\": \"#604740\",\n      \"border-color\": \"#604740\",\n      \"text-color-internal\": \"#ffffff\"\n    },\n    \"node.FundingRound\": {\n      \"caption\": \"{name}\",\n      \"diameter\": \"35px\",\n      \"color\": \"#a0a0a0\",\n      \"border-color\": \"#a0a0a0\",\n      \"text-color-internal\": \"#ffffff\"\n    }\n  }\n  const defaultSizes = [{\n      diameter: '10px'\n    },\n    {\n      diameter: '20px'\n    },\n    {\n      diameter: '50px'\n    },\n    {\n      diameter: '65px'\n    },\n    {\n      diameter: '80px'\n    }\n  ]\n  const defaultIconCodes = [{\n      'icon-code': 'a'\n    },\n    {\n      'icon-code': '\"'\n    },\n    {\n      'icon-code': 'z'\n    },\n    {\n      'icon-code': '_'\n    },\n    {\n      'icon-code': '/'\n    },\n    {\n      'icon-code': '>'\n    },\n    {\n      'icon-code': 'k'\n    }\n  ]\n  const defaultArrayWidths = [{\n      'shaft-width': '1px'\n    },\n    {\n      'shaft-width': '2px'\n    },\n    {\n      'shaft-width': '3px'\n    },\n    {\n      'shaft-width': '5px'\n    },\n    {\n      'shaft-width': '8px'\n    },\n    {\n      'shaft-width': '13px'\n    },\n    {\n      'shaft-width': '25px'\n    },\n    {\n      'shaft-width': '38px'\n    }\n  ]\n  const defaultColors = [{\n      color: '#FFE081',\n      'border-color': '#9AA1AC',\n      'text-color-internal': '#FFFFFF'\n    },\n    {\n      color: '#C990C0',\n      'border-color': '#b261a5',\n      'text-color-internal': '#FFFFFF'\n    },\n    {\n      color: '#F79767',\n      'border-color': '#f36924',\n      'text-color-internal': '#FFFFFF'\n    },\n    {\n      color: '#57C7E3',\n      'border-color': '#23b3d7',\n      'text-color-internal': '#FFFFFF'\n    },\n    {\n      color: '#F16667',\n      'border-color': '#eb2728',\n      'text-color-internal': '#FFFFFF'\n    },\n    {\n      color: '#D9C8AE',\n      'border-color': '#c0a378',\n      'text-color-internal': '#604A0E'\n    },\n    {\n      color: '#8DCC93',\n      'border-color': '#5db665',\n      'text-color-internal': '#604A0E'\n    },\n    {\n      color: '#ECB5C9',\n      'border-color': '#da7298',\n      'text-color-internal': '#604A0E'\n    },\n    {\n      color: '#4C8EDA',\n      'border-color': '#2870c2',\n      'text-color-internal': '#FFFFFF'\n    },\n    {\n      color: '#FFC454',\n      'border-color': '#d7a013',\n      'text-color-internal': '#604A0E'\n    },\n    {\n      color: '#DA7194',\n      'border-color': '#cc3c6c',\n      'text-color-internal': '#FFFFFF'\n    },\n    {\n      color: '#569480',\n      'border-color': '#447666',\n      'text-color-internal': '#FFFFFF'\n    }\n  ]\n  const Selector = (function () {\n    function Selector(tag1, classes1) {\n      this.tag = tag1\n      this.classes = classes1 != null ? classes1 : []\n    }\n\n    Selector.prototype.toString = function () {\n      return selectorArrayToString([this.tag].concat(this.classes))\n    }\n\n    return Selector\n  })()\n\n  const StyleRule = (function () {\n    function StyleRule(selector1, props1) {\n      this.selector = selector1\n      this.props = props1\n    }\n\n    StyleRule.prototype.matches = function (selector) {\n      if (this.selector.tag !== selector.tag) {\n        return false\n      }\n      for (let i = 0; i < this.selector.classes.length; i++) {\n        const classs = this.selector.classes[i]\n        if (classs != null && selector.classes.indexOf(classs) === -1) {\n          return false\n        }\n      }\n      return true\n    }\n\n    StyleRule.prototype.matchesExact = function (selector) {\n      return (\n        this.matches(selector) &&\n        this.selector.classes.length === selector.classes.length\n      )\n    }\n\n    return StyleRule\n  })()\n\n  const StyleElement = (function () {\n    function StyleElement(selector) {\n      this.selector = selector\n      this.props = {}\n    }\n\n    StyleElement.prototype.applyRules = function (rules, item) {\n      for (let i = 0; i < rules.length; i++) {\n        const rule = rules[i]\n        if (rule.matches(this.selector)) {\n          this.props = {\n            ...this.props,\n            ...rule.props\n          }\n          this.props.caption = this.props.caption || this.props.defaultCaption\n        }\n      }\n      return this\n    }\n\n    StyleElement.prototype.get = function (attr) {\n      return this.props[attr] || ''\n    }\n\n    return StyleElement\n  })()\n\n  const GraphStyle = (function () {\n    function GraphStyle() {\n      this.rules = []\n      try {\n        this.loadRules()\n      } catch (_error) {\n        // e = _error\n      }\n    }\n\n    const parseSelector = function (key) {\n      let tokens = selectorStringToArray(key)\n      return new Selector(tokens[0], tokens.slice(1))\n    }\n\n    const selector = function (item) {\n      if (item.isNode) {\n        return nodeSelector(item)\n      } else if (item.isRelationship) {\n        return relationshipSelector(item)\n      }\n    }\n\n    const nodeSelector = function (node) {\n      node = node || {}\n      const classes = node.labels != null ? node.labels : []\n      return new Selector('node', classes)\n    }\n\n    const relationshipSelector = function (rel) {\n      rel = rel || {}\n      const classes = rel.type != null ? [rel.type] : []\n      return new Selector('relationship', classes)\n    }\n\n    const findRule = function (selector, rules) {\n      for (let i = 0; i < rules.length; i++) {\n        let rule = rules[i]\n        if (rule.matchesExact(selector)) {\n          return rule\n        }\n      }\n    }\n\n    const findAvailableDefaultColor = function (rules) {\n      const usedColors = rules\n        .filter(rule => {\n          return rule.props.color != null\n        })\n        .map(rule => {\n          return rule.props.color\n        })\n      let index =\n        usedColors.length - 1 > defaultColors ? 0 : usedColors.length - 1\n      return defaultColors[index]\n    }\n\n    const getDefaultNodeCaption = function (item) {\n      if (\n        !item ||\n        !(item.propertyList != null ? item.propertyList.length : 0) > 0\n      ) {\n        return {\n          defaultCaption: '<id>'\n        }\n      }\n      const captionPrioOrder = [\n        /^name$/i,\n        /^title$/i,\n        /^label$/i,\n        /name$/i,\n        /description$/i,\n        /^.+/\n      ]\n      let defaultCaption = captionPrioOrder.reduceRight(function (\n          leading,\n          current\n        ) {\n          let hits = item.propertyList.filter(function (prop) {\n            return current.test(prop.key)\n          })\n          if (hits.length) {\n            return '{' + hits[0].key + '}'\n          } else {\n            return leading\n          }\n        },\n        '')\n      defaultCaption || (defaultCaption = '<id>')\n      return {\n        caption: defaultCaption\n      }\n    }\n\n    GraphStyle.prototype.calculateStyle = function (selector, item) {\n      return new StyleElement(selector).applyRules(this.rules, item)\n    }\n\n    // GraphStyle.prototype.forEntity = function (item) {\n    //   return this.calculateStyle(selector(item))\n    // }\n\n    GraphStyle.prototype.setDefaultNodeStyling = function (selector, item) {\n      let defaultColor = true\n      let defaultCaption = true\n      for (let i = 0; i < this.rules.length; i++) {\n        let rule = this.rules[i]\n        if (rule.selector.classes.length > 0 && rule.matches(selector)) {\n          if (rule.props.hasOwnProperty('color')) {\n            defaultColor = false\n          }\n          if (rule.props.hasOwnProperty('caption')) {\n            defaultCaption = false\n          }\n        }\n      }\n      const minimalSelector = new Selector(\n        selector.tag,\n        selector.classes.sort().slice(0, 1)\n      )\n      if (defaultColor) {\n        this.changeForSelector(\n          minimalSelector,\n          findAvailableDefaultColor(this.rules)\n        )\n      }\n      if (defaultCaption) {\n        return this.changeForSelector(\n          minimalSelector,\n          getDefaultNodeCaption(item)\n        )\n      }\n    }\n\n    GraphStyle.prototype.changeForSelector = function (selector, props) {\n      let rule = findRule(selector, this.rules)\n      if (rule == null) {\n        rule = new StyleRule(selector, props)\n        this.rules.push(rule)\n      }\n      rule.props = {\n        ...rule.props,\n        ...props\n      }\n      return rule\n    }\n\n    GraphStyle.prototype.destroyRule = function (rule) {\n      const idx = this.rules.indexOf(rule)\n      if (idx != null) {\n        this.rules.splice(idx, 1)\n      }\n    }\n\n    GraphStyle.prototype.importGrass = function (string) {\n      try {\n        const rules = this.parse(string)\n        return this.loadRules(rules)\n      } catch (_error) {\n        // e = _error\n      }\n    }\n\n    GraphStyle.prototype.parse = function (string) {\n      const chars = string.split('')\n      let insideString = false\n      let insideProps = false\n      let keyword = ''\n      let props = ''\n      let rules = {}\n      for (let i = 0; i < chars.length; i++) {\n        const c = chars[i]\n        let skipThis = true\n        switch (c) {\n          case '{':\n            if (!insideString) {\n              insideProps = true\n            } else {\n              skipThis = false\n            }\n            break\n          case '}':\n            if (!insideString) {\n              insideProps = false\n              rules[keyword] = props\n              keyword = ''\n              props = ''\n            } else {\n              skipThis = false\n            }\n            break\n          case \"'\":\n            insideString ^= true\n            break\n          default:\n            skipThis = false\n        }\n        if (skipThis) {\n          continue\n        }\n        if (insideProps) {\n          props += c\n        } else {\n          if (!c.match(/[\\s\\n]/)) {\n            keyword += c\n          }\n        }\n      }\n      for (let k in rules) {\n        const v = rules[k]\n        rules[k] = {}\n        v.split(';').forEach(prop => {\n          const [key, val] = prop.split(':')\n          if (key && val) {\n            rules[k][key.trim()] = val.trim()\n          }\n        })\n      }\n      return rules\n    }\n\n    GraphStyle.prototype.resetToDefault = function () {\n      this.loadRules()\n      return true\n    }\n\n    GraphStyle.prototype.toSheet = function () {\n      let sheet = {}\n      this.rules.forEach(rule => {\n        sheet[rule.selector.toString()] = rule.props\n      })\n      return sheet\n    }\n\n    GraphStyle.prototype.toString = function () {\n      let str = ''\n      this.rules.forEach(r => {\n        str += r.selector.toString() + ' {\\n'\n        for (let k in r.props) {\n          let v = r.props[k]\n          if (k === 'caption') {\n            v = \"'\" + v + \"'\"\n          }\n          str += '  ' + k + ': ' + v + ';\\n'\n        }\n        str += '}\\n\\n'\n      })\n      return str\n    }\n\n    GraphStyle.prototype.loadRules = function (data) {\n      if (typeof data !== 'object') {\n        data = defaultStyle\n      }\n      this.rules.length = 0\n      for (let key in data) {\n        const props = data[key]\n        this.rules.push(new StyleRule(parseSelector(key), props))\n      }\n      return this\n    }\n\n    GraphStyle.prototype.defaultSizes = function () {\n      return defaultSizes\n    }\n\n    GraphStyle.prototype.defaultIconCodes = function () {\n      return defaultIconCodes\n    }\n\n    GraphStyle.prototype.defaultArrayWidths = function () {\n      return defaultArrayWidths\n    }\n\n    GraphStyle.prototype.defaultColors = function () {\n      return defaultColors\n    }\n\n    GraphStyle.prototype.interpolate = function (str, item) {\n      let ips = str.replace(/\\{([^{}]*)\\}/g, function (a, b) {\n        let r = item.propertyMap[b]\n        if (typeof r === 'object') {\n          return r.join(', ')\n        }\n        if (typeof r === 'string' || typeof r === 'number') {\n          return r\n        }\n        return ''\n      })\n      if (ips.length < 1 && str === '{type}' && item.isRelationship) {\n        ips = '<type>'\n      }\n      if (ips.length < 1 && str === '{id}' && item.isNode) {\n        ips = '<id>'\n      }\n      return ips.replace(/^<(id|type)>$/, function (a, b) {\n        const r = item[b]\n        if (typeof r === 'string' || typeof r === 'number') {\n          return r\n        }\n        return ''\n      })\n    }\n\n    GraphStyle.prototype.forNode = function (node) {\n      node = node || {}\n      const selector = nodeSelector(node)\n      if ((node.labels != null ? node.labels.length : 0) > 0) {\n        this.setDefaultNodeStyling(selector, node)\n      }\n      return this.calculateStyle(selector, node)\n    }\n\n    GraphStyle.prototype.forRelationship = function (rel) {\n      const selector = relationshipSelector(rel)\n      return this.calculateStyle(selector, rel)\n    }\n\n    return GraphStyle\n  })()\n  return new GraphStyle()\n}","export function parseGrass (string) {\n  let result\n  try {\n    result = JSON.parse(string)\n  } catch (e) {\n    result = parseGrassCSS(string)\n  }\n  return result\n}\n\nfunction parseGrassCSS (string) {\n  let chars = string.split('')\n  let insideString = false\n  let insideProps = false\n  let insideBinding = false\n  let keyword = ''\n  let props = ''\n  let rules = {}\n  let i, j\n\n  for (i = 0; i < chars.length; i++) {\n    const c = chars[i]\n    let skipThis = true\n    switch (c) {\n      case '{':\n        if (insideString) {\n          skipThis = false\n        } else if (insideProps) {\n          insideBinding = true\n        } else {\n          insideProps = true\n        }\n        break\n      case '}':\n        if (insideString) {\n          skipThis = false\n        } else if (insideBinding) {\n          insideBinding = false\n        } else {\n          insideProps = false\n          rules[keyword] = props\n          keyword = ''\n          props = ''\n        }\n        break\n      case \"'\":\n      case '\"':\n        insideString = !insideString\n        break\n      default:\n        skipThis = false\n        break\n    }\n\n    if (skipThis) {\n      continue\n    }\n\n    if (insideProps) {\n      props += c\n    } else if (!c.match(/[\\s\\n]/)) {\n      keyword += c\n    }\n  }\n\n  const keys = Object.keys(rules)\n  for (i = 0; i < keys.length; i++) {\n    const val = rules[keys[i]]\n    rules[keys[i]] = {}\n    const props = val.split(';')\n    for (j = 0; j < props.length; j++) {\n      const propKeyVal = props[j].split(':')\n      if (propKeyVal && propKeyVal.length === 2) {\n        const prop = propKeyVal[0].trim()\n        const value = propKeyVal[1].trim()\n        rules[keys[i]][prop] = value\n      }\n    }\n  }\n\n  return rules\n}\n\nexport const objToCss = obj => {\n  if (typeof obj !== 'object') {\n    console.error('Need a object but got ', typeof obj, obj)\n    return false\n  }\n  let output = ''\n  try {\n    let level = '  '\n    for (let selector in obj) {\n      if (obj.hasOwnProperty(selector)) {\n        output += selector + ' {\\n' + level\n        for (let style in obj[selector]) {\n          if (obj[selector].hasOwnProperty(style)) {\n            output +=\n              style +\n              ': ' +\n              quoteSpecialStyles(style, obj[selector][style]) +\n              ';\\n' +\n              level\n          }\n        }\n        output = output.trim() + '\\n'\n        output += '}\\n'\n      }\n    }\n  } catch (e) {\n    return false\n  }\n  return output\n}\n\nconst shouldQuoteStyle = style => ['defaultCaption', 'caption'].includes(style)\nconst quoteSpecialStyles = (style, value) =>\n  (shouldQuoteStyle(style) ? '\"' : '') +\n  value +\n  (shouldQuoteStyle(style) ? '\"' : '')\n\nexport const selectorStringToArray = selector => {\n  // Negative lookbehind simulation since js support is very limited.\n  // We want to match all . that are not preceded by \\\\\n  // Instead we reverse and look\n  // for . that are not followed by \\\\ (negative lookahead)\n  selector = selector\n    .split('')\n    .reverse()\n    .join('')\n  var re = /(.+?)(?!\\.\\\\)(?:\\.|$)/g\n  const out = []\n  let m\n  while ((m = re.exec(selector)) !== null) {\n    const res = m[1]\n      .split('')\n      .reverse()\n      .join('')\n    out.push(res)\n  }\n\n  return out\n    .filter(r => r)\n    .reverse()\n    .map(r => r.replace(/\\\\./g, '.'))\n}\n\nexport const selectorArrayToString = selectors => {\n  const escaped = selectors.map(r => r.replace(/\\./g, '\\\\.'))\n  return escaped.join('.')\n}\n","\nexport const font = {}\n\nexport const dim = {\n  // Editor bar\n  editorbarHeight: 71,\n  // Frame\n  frameBodyHeight: 550,\n  frameTitlebarHeight: 39,\n  frameStatusbarHeight: 39,\n  frameBodyPadding: 20\n}\n","import styled from 'styled-components'\n\nexport const legendRowHeight = 32\nexport const inspectorFooterContractedHeight = 22\nconst pMarginTop = 6\n\n// Themes is here because the colors are unique to this component\nconst getColor = (theme, name) => {\n  const themes = {\n    normal: {\n      svgBackground: '#f9fbfd'\n    },\n    dark: {\n      svgBackground: '#5a6070'\n    }\n  }\n  if (themes[theme] === undefined) theme = 'normal'\n  return themes[theme][name] || ''\n}\n\nexport const StyledSvgWrapper = styled.div`\n  line-height: 0;\n  height: 100%;\n  position: relative;\n  > svg {\n    height: 100%;\n    width: 100%;\n    background-color: ${props => getColor(props.theme.name, 'svgBackground')};\n    .node {\n      cursor: pointer;\n      > .ring {\n        fill: none;\n        opacity: 0;\n        stroke: #6ac6ff;\n      }\n      .outline {\n        cursor: pointer;\n      }\n      &.selected {\n        > .ring {\n          stroke: #fdcc59;\n          opacity: 0.3;\n        }\n      }\n      &:hover {\n        > .ring {\n          stroke: #6ac6ff;\n          opacity: 0.3;\n        }\n      }\n    }\n    .nodes.ctrlClick{\n      .node{\n        opacity : 0.3\n      }\n      .ctrlClicked{\n        opacity : 1\n      }\n    }\n    .nodes{\n      .hide{\n        opacity : 0 !important;\n        cursor : auto !important;  \n        &.outline {\n          cursor: auto !important;\n        }\n        .outline {\n          cursor: auto !important;\n        }\n        &:hover {\n          > .ring {\n            stroke: #6ac6ff !important;\n            opacity: 0 !important;\n          }\n        }\n      }\n    }\n    .relationship {\n      > .overlay {\n        opacity: 0;\n        fill: #6ac6ff;\n      }\n      &.selected {\n        > .overlay {\n          fill: #fdcc59;\n          opacity: 0.3;\n        }\n      }\n      %.\n      &:hover {\n        > .overlay {\n          fill: #6ac6ff;\n          opacity: 0.3;\n        }\n      }\n      &.hide {\n        opacity : 0;\n        &:hover{\n          > .overlay {\n            fill: #6ac6ff;\n            opacity: 0;\n          }\n        }\n      }\n    }\n    .right-menu{\n      position : absolute;\n      z-index : 10;\n      .right-menu-text{\n          font-size : 10px;\n          fill : #666;\n          dominant-baseline: middle; \n          &:hover{\n            fill : rgb(87,199,227)\n            cursor: pointer;\n          }\n      }\n      rect:hover{\n        cursor: pointer;\n        .right-menu-text{\n          fill : rgb(87,199,227)\n        }\n      }\n      &:hover{\n        .right-menu-text{\n          cursor: pointer;\n          fill : rgb(87,199,227)\n        }\n      }\n    }\n    .remove_node {\n      .expand_node {\n        &:hover {\n          border: 2px #000 solid;\n        }\n      }\n    }\n    path {\n      &.context-menu-item {\n        stroke-width: 2px;\n        fill: #d2d5da;\n      }\n    }\n    text {\n      line-height: normal;\n      &.context-menu-item {\n        fill: #fff;\n        text-anchor: middle;\n        pointer-events: none;\n        font-size: 14px;\n      }\n    }\n    .context-menu-item {\n      cursor: pointer;\n      &:hover {\n        fill: #b9b9b9;\n        font-size: 14px;\n      }\n    }\n  }\n`\nexport const StyledStream = styled.div`\n  padding: 0;\n  display: flex;\n  flex-direction: column;\n  margin-top: 17px;\n`\n\nexport const p = styled.div`\n  margin-top: ${pMarginTop}px;\n  font-size: 12px;\n  width: 100%;\n  white-space: normal;\n`\n\nexport const StyledRowToggle = styled.div`\n  float: right;\n  display: block;\n  width: 21px;\n  height: 21px;\n  line-height: 21px;\n  text-align: center;\n  cursor: pointer;\n`\nexport const StyledCaret = styled.div`\n  font-size: 17px;\n  vertical-align: middle;\n`\n\nexport const StyledInspectorFooter = styled.div`\n  margin-top: 6px;\n  font-size: 12px;\n  width: 100%;\n  white-space: normal;\n  overflow: scroll;\n  &.contracted {\n    overflow: hidden;\n  }\n`\n\n// export const StyledInspectorFooter = styled.div`\n//   margin-top: 6px;\n//   font-size: 12px;\n//   width: 100%;\n//   white-space: normal;\n//   overflow: scroll;\n//   &.contracted {\n//     max-height: ${inspectorFooterContractedHeight}px;\n//     overflow: hidden;\n//   }\n// `\n\nexport const StyledInspectorFooterRow = styled.ul`\n  list-style: none;\n  word-break: break-word;\n  line-height: 21px;\n`\n\nexport const StyledInspectorFooterRowListKey = styled.div`\n  float: left;\n  font-weight: 800;\n`\n\nexport const StyledInspectorFooterRowListValue = styled.div`\n  padding-left: 3px;\n  overflow: hidden;\n  float: left;\n  white-space: pre-wrap;\n`\n\nexport const StyledInlineList = styled.ul`\n  padding-left: 0;\n  list-style: none;\n  word-break: break-word;\n`\n\nexport const StyledInlineListItem = styled.li`\n  display: inline-block;\n  padding-right: 5px;\n  padding-left: 5px;\n`\n\nexport const StyledStatusBarWrapper = styled.div`\n  height: 68px;\n  display: none;\n`\nexport const StyledStatusBar = styled.div`\n  min-height: 39px;\n  line-height: 39px;\n  color: ${props => props.theme.secondaryText};\n  font-size: 13px;\n  position: absolute;\n  background-color: ${props => props.theme.secondaryBackground};\n  white-space: nowrap;\n  overflow: hidden;\n  border-top: 1px solid #e6e9ef;\n  bottom: 0;\n  left: 0;\n  right: 0;\n`\n\nexport const StyledStatus = styled.div`\n  position: relative;\n  float: left;\n  padding-left: 16px;\n  margin-top: 0;\n  margin-bottom: 0;\n  width: 100%;\n  margin-top: 3px;\n  overflow: auto;\n`\n\nexport const StyledInspectorFooterRowListPair = styled(StyledInlineListItem)`\n  vertical-align: middle;\n  font-size: 13px;\n`\n\nexport const StyledToken = styled(StyledInlineListItem)`\n  display: inline-block;\n  font-weight: bold;\n  line-height: 1em;\n  text-align: center;\n  white-space: nowrap;\n  vertical-align: baseline;\n  user-select: none;\n  font-size: 12px;\n  margin-right: 5px;\n  cursor: pointer;\n`\nexport const StyledLabelToken = styled(StyledToken)`\n  padding: 4px 7px 4px 9px;\n  border-radius: 20px;\n`\nexport const StyledTokenRelationshipType = styled(StyledToken)`\n  padding: 4px 7px 4px 5px;\n  border-radius: 3px;\n`\n\nexport const tokenPropertyKey = styled(StyledToken)`\n  padding: 3px 5px 3px 5px;\n`\nexport const StyledTokenContextMenuKey = styled(StyledLabelToken)`\n  color: #f9fbfd;\n  background-color: #d2d5da;\n  padding: 4px 9px;\n`\n\nexport const StyledTokenCount = styled.span`\n  font-weight: normal;\n`\nexport const StyledLegendContents = styled.ul`\n  float: left;\n  line-height: 1em;\n  position: relative;\n  top: 3px;\n  top: -1px;\n`\n\nexport const StyledLegendRow = styled.div`\n  border-bottom: 1px solid #e6e9ef;\n  &.contracted {\n    overflow: hidden;\n  }\n`\n// 将默认最大高度去掉\n// export const StyledLegendRow = styled.div`\n//   border-bottom: 1px solid #e6e9ef;\n//   &.contracted {\n//     max-height: ${legendRowHeight}px;\n//     overflow: hidden;\n//   }\nexport const StyledLegend = styled.div`\n  background-color: ${props => props.theme.secondaryBackground};\n  position: absolute;\n  z-index: 1;\n  top: 0;\n  right: 0;\n  left: 0;\n`\nexport const StyledLegendInlineList = styled(StyledInlineList)`\n  padding: 7px 9px 0px 10px;\n`\nexport const StyledLegendInlineListItem = styled(StyledInlineListItem)`\n  display: inline-block;\n  margin-bottom: 3px;\n`\nexport const StyledPickerListItem = styled(StyledInlineListItem)`\n  padding-right: 5px;\n  padding-left: 0;\n  vertical-align: middle;\n  line-height: 0;\n`\n\nexport const StyledPickerSelector = styled.a`\n  background-color: #aaa;\n  display: inline-block;\n  height: 12px;\n  width: 12px;\n  margin-top: 1px;\n  line-height: 0;\n  cursor: pointer;\n  opacity: 0.4;\n  &:hover {\n    opacity: 1;\n  }\n  &.active {\n    opacity: 1;\n  }\n`\nexport const StyledCircleSelector = styled(StyledPickerSelector)`\n  border-radius: 50%;\n`\nexport const StyledCaptionSelector = styled.a`\n  cursor: pointer;\n  user-select: none;\n  display: inline-block;\n  padding: 1px 6px;\n  font-size: 12px;\n  line-height: 1em;\n  color: #9195a0;\n  border: 1px solid #9195a0;\n  overflow: hidden;\n  border-radius: 0.25em;\n  margin-right: 0;\n  font-weight: bold;\n  &:hover {\n    border-color: #aaa;\n    color: #aaa;\n    text-decoration: none;\n  }\n  &.active {\n    color: white;\n    background-color: #9195a0;\n  }\n`\n\nexport const StyledFullSizeContainer = styled.div`\n  position: relative;\n  height: 100%;\n`\n\nexport const StyledInspectorFooterStatusMessage = styled.div`\n  font-weight: bold;\n`\n\nexport const StyledZoomHolder = styled.div`\n  position: absolute;\n  bottom: 39px;\n  right: 0;\n  padding: 6px 6px 0 6px;\n  border-left: #e6e9ef solid 1px;\n  border-top: #e6e9ef solid 1px;\n  background: #fff;\n`\n\nexport const StyledZoomButton = styled.button`\n  display: list-item;\n  list-style-type: none;\n  font-size: 2em;\n  margin-bottom: 10px;\n  border: none;\n  color: #9b9da2;\n  background: transparent;\n  border-color: black;\n  padding: 2px 6px 3px;\n  &:hover {\n    color: black;\n  }\n  &:focus {\n    outline: none;\n  }\n  &.faded {\n    opacity: 0.3;\n    cursor: auto;\n    &:hover {\n      color: #9b9da2;\n    }\n  }\n`\n","\nimport d3 from 'd3'\n\nconst measureUsingCanvas = function (text, font) {\n  const canvasSelection = d3.select('canvas#textMeasurementCanvas').data([this])\n  canvasSelection\n    .enter()\n    .append('canvas')\n    .attr('id', 'textMeasurementCanvas')\n    .style('display', 'none')\n\n  const canvas = canvasSelection.node()\n  const context = canvas.getContext('2d')\n  context.font = font\n  return context.measureText(text).width\n}\n\nconst cache = function () {\n  const cacheSize = 10000\n  const map = {}\n  const list = []\n  return (key, calc) => {\n    const cached = map[key]\n    if (cached) {\n      return cached\n    } else {\n      const result = calc()\n      if (list.length > cacheSize) {\n        delete map[list.splice(0, 1)]\n        list.push(key)\n      }\n      return (map[key] = result)\n    }\n  }\n}\n\nexport default function (text, fontFamily, fontSize) {\n  const font = `normal normal normal ${fontSize}px/normal ${fontFamily}`\n  return cache()(text + font, () => measureUsingCanvas(text, font))\n}\n","\nexport default class LoopArrow {\n  constructor (\n    nodeRadius,\n    straightLength,\n    spreadDegrees,\n    shaftWidth,\n    headWidth,\n    headLength,\n    captionHeight\n  ) {\n    const spread = (spreadDegrees * Math.PI) / 180\n    const r1 = nodeRadius\n    const r2 = nodeRadius + headLength\n    const r3 = nodeRadius + straightLength\n    const loopRadius = r3 * Math.tan(spread / 2)\n    const shaftRadius = shaftWidth / 2\n    this.shaftLength = loopRadius * 3 + shaftWidth\n\n    class Point {\n      constructor (x, y) {\n        this.x = x\n        this.y = y\n      }\n      toString () {\n        return `${this.x} ${this.y}`\n      }\n    }\n\n    const normalPoint = function (sweep, radius, displacement) {\n      const localLoopRadius = radius * Math.tan(spread / 2)\n      const cy = radius / Math.cos(spread / 2)\n      return new Point(\n        (localLoopRadius + displacement) * Math.sin(sweep),\n        cy + (localLoopRadius + displacement) * Math.cos(sweep)\n      )\n    }\n    this.midShaftPoint = normalPoint(0, r3, shaftRadius + captionHeight / 2 + 2)\n    const startPoint = (radius, displacement) =>\n      normalPoint((Math.PI + spread) / 2, radius, displacement)\n    const endPoint = (radius, displacement) =>\n      normalPoint(-(Math.PI + spread) / 2, radius, displacement)\n\n    this.outline = function () {\n      const inner = loopRadius - shaftRadius\n      const outer = loopRadius + shaftRadius\n      return [\n        'M',\n        startPoint(r1, shaftRadius),\n        'L',\n        startPoint(r3, shaftRadius),\n        'A',\n        outer,\n        outer,\n        0,\n        1,\n        1,\n        endPoint(r3, shaftRadius),\n        'L',\n        endPoint(r2, shaftRadius),\n        'L',\n        endPoint(r2, -headWidth / 2),\n        'L',\n        endPoint(r1, 0),\n        'L',\n        endPoint(r2, headWidth / 2),\n        'L',\n        endPoint(r2, -shaftRadius),\n        'L',\n        endPoint(r3, -shaftRadius),\n        'A',\n        inner,\n        inner,\n        0,\n        1,\n        0,\n        startPoint(r3, -shaftRadius),\n        'L',\n        startPoint(r1, -shaftRadius),\n        'Z'\n      ].join(' ')\n    }\n\n    this.overlay = function (minWidth) {\n      const displacement = Math.max(minWidth / 2, shaftRadius)\n      const inner = loopRadius - displacement\n      const outer = loopRadius + displacement\n      return [\n        'M',\n        startPoint(r1, displacement),\n        'L',\n        startPoint(r3, displacement),\n        'A',\n        outer,\n        outer,\n        0,\n        1,\n        1,\n        endPoint(r3, displacement),\n        'L',\n        endPoint(r2, displacement),\n        'L',\n        endPoint(r2, -displacement),\n        'L',\n        endPoint(r3, -displacement),\n        'A',\n        inner,\n        inner,\n        0,\n        1,\n        0,\n        startPoint(r3, -displacement),\n        'L',\n        startPoint(r1, -displacement),\n        'Z'\n      ].join(' ')\n    }\n  }\n}\n","\nexport default class StraightArrow {\n  deflection = 0\n\n  constructor (\n    startRadius,\n    endRadius,\n    centreDistance,\n    shaftWidth,\n    headWidth,\n    headHeight,\n    captionLayout\n  ) {\n    this.length = centreDistance - (startRadius + endRadius)\n\n    this.shaftLength = this.length - headHeight\n    const startArrow = startRadius\n    const endShaft = startArrow + this.shaftLength\n    const endArrow = startArrow + this.length\n    const shaftRadius = shaftWidth / 2\n    const headRadius = headWidth / 2\n\n    this.midShaftPoint = {\n      x: startArrow + this.shaftLength / 2,\n      y: 0\n    }\n\n    this.outline = function (shortCaptionLength) {\n      if (captionLayout === 'external') {\n        const startBreak =\n          startArrow + (this.shaftLength - shortCaptionLength) / 2\n        const endBreak = endShaft - (this.shaftLength - shortCaptionLength) / 2\n\n        return [\n          'M',\n          startArrow,\n          shaftRadius,\n          'L',\n          startBreak,\n          shaftRadius,\n          'L',\n          startBreak,\n          -shaftRadius,\n          'L',\n          startArrow,\n          -shaftRadius,\n          'Z',\n          'M',\n          endBreak,\n          shaftRadius,\n          'L',\n          endShaft,\n          shaftRadius,\n          'L',\n          endShaft,\n          headRadius,\n          'L',\n          endArrow,\n          0,\n          'L',\n          endShaft,\n          -headRadius,\n          'L',\n          endShaft,\n          -shaftRadius,\n          'L',\n          endBreak,\n          -shaftRadius,\n          'Z'\n        ].join(' ')\n      } else {\n        return [\n          'M',\n          startArrow,\n          shaftRadius,\n          'L',\n          endShaft,\n          shaftRadius,\n          'L',\n          endShaft,\n          headRadius,\n          'L',\n          endArrow,\n          0,\n          'L',\n          endShaft,\n          -headRadius,\n          'L',\n          endShaft,\n          -shaftRadius,\n          'L',\n          startArrow,\n          -shaftRadius,\n          'Z'\n        ].join(' ')\n      }\n    }\n\n    this.overlay = function (minWidth) {\n      const radius = Math.max(minWidth / 2, shaftRadius)\n      return [\n        'M',\n        startArrow,\n        radius,\n        'L',\n        endArrow,\n        radius,\n        'L',\n        endArrow,\n        -radius,\n        'L',\n        startArrow,\n        -radius,\n        'Z'\n      ].join(' ')\n    }\n  }\n}\n","\nexport default class ArcArrow {\n  constructor (\n    startRadius,\n    endRadius,\n    endCentre,\n    deflection,\n    arrowWidth,\n    headWidth,\n    headLength,\n    captionLayout\n  ) {\n    this.deflection = deflection\n    const square = l => l * l\n\n    const deflectionRadians = (this.deflection * Math.PI) / 180\n    const startAttach = {\n      x: Math.cos(deflectionRadians) * startRadius,\n      y: Math.sin(deflectionRadians) * startRadius\n    }\n\n    const radiusRatio = startRadius / (endRadius + headLength)\n    const homotheticCenter = (-endCentre * radiusRatio) / (1 - radiusRatio)\n\n    const intersectWithOtherCircle = function (\n      fixedPoint,\n      radius,\n      xCenter,\n      polarity\n    ) {\n      const gradient = fixedPoint.y / (fixedPoint.x - homotheticCenter)\n      const hc = fixedPoint.y - gradient * fixedPoint.x\n\n      const A = 1 + square(gradient)\n      const B = 2 * (gradient * hc - xCenter)\n      const C = square(hc) + square(xCenter) - square(radius)\n\n      const intersection = {\n        x: (-B + polarity * Math.sqrt(square(B) - 4 * A * C)) / (2 * A)\n      }\n      intersection.y = (intersection.x - homotheticCenter) * gradient\n\n      return intersection\n    }\n\n    const endAttach = intersectWithOtherCircle(\n      startAttach,\n      endRadius + headLength,\n      endCentre,\n      -1\n    )\n\n    const g1 = -startAttach.x / startAttach.y\n    const c1 = startAttach.y + square(startAttach.x) / startAttach.y\n    const g2 = -(endAttach.x - endCentre) / endAttach.y\n    const c2 =\n      endAttach.y + ((endAttach.x - endCentre) * endAttach.x) / endAttach.y\n\n    const cx = (c1 - c2) / (g2 - g1)\n    const cy = g1 * cx + c1\n\n    const arcRadius = Math.sqrt(\n      square(cx - startAttach.x) + square(cy - startAttach.y)\n    )\n    const startAngle = Math.atan2(startAttach.x - cx, cy - startAttach.y)\n    const endAngle = Math.atan2(endAttach.x - cx, cy - endAttach.y)\n    let sweepAngle = endAngle - startAngle\n    if (this.deflection > 0) {\n      sweepAngle = 2 * Math.PI - sweepAngle\n    }\n\n    this.shaftLength = sweepAngle * arcRadius\n    if (startAngle > endAngle) {\n      this.shaftLength = 0\n    }\n\n    let midShaftAngle = (startAngle + endAngle) / 2\n    if (this.deflection > 0) {\n      midShaftAngle += Math.PI\n    }\n    this.midShaftPoint = {\n      x: cx + arcRadius * Math.sin(midShaftAngle),\n      y: cy - arcRadius * Math.cos(midShaftAngle)\n    }\n\n    const startTangent = function (dr) {\n      const dx = (dr < 0 ? 1 : -1) * Math.sqrt(square(dr) / (1 + square(g1)))\n      const dy = g1 * dx\n      return {\n        x: startAttach.x + dx,\n        y: startAttach.y + dy\n      }\n    }\n\n    const endTangent = function (dr) {\n      const dx = (dr < 0 ? -1 : 1) * Math.sqrt(square(dr) / (1 + square(g2)))\n      const dy = g2 * dx\n      return {\n        x: endAttach.x + dx,\n        y: endAttach.y + dy\n      }\n    }\n\n    const angleTangent = (angle, dr) => ({\n      x: cx + (arcRadius + dr) * Math.sin(angle),\n      y: cy - (arcRadius + dr) * Math.cos(angle)\n    })\n\n    const endNormal = function (dc) {\n      const dx =\n        (dc < 0 ? -1 : 1) * Math.sqrt(square(dc) / (1 + square(1 / g2)))\n      const dy = dx / g2\n      return {\n        x: endAttach.x + dx,\n        y: endAttach.y - dy\n      }\n    }\n\n    const endOverlayCorner = function (dr, dc) {\n      const shoulder = endTangent(dr)\n      const arrowTip = endNormal(dc)\n      return {\n        x: shoulder.x + arrowTip.x - endAttach.x,\n        y: shoulder.y + arrowTip.y - endAttach.y\n      }\n    }\n\n    const coord = point => `${point.x},${point.y}`\n\n    const shaftRadius = arrowWidth / 2\n    const headRadius = headWidth / 2\n    const positiveSweep = startAttach.y > 0 ? 0 : 1\n    const negativeSweep = startAttach.y < 0 ? 0 : 1\n\n    this.outline = function (shortCaptionLength) {\n      if (startAngle > endAngle) {\n        return [\n          'M',\n          coord(endTangent(-headRadius)),\n          'L',\n          coord(endNormal(headLength)),\n          'L',\n          coord(endTangent(headRadius)),\n          'Z'\n        ].join(' ')\n      }\n\n      if (captionLayout === 'external') {\n        let captionSweep = shortCaptionLength / arcRadius\n        if (this.deflection > 0) {\n          captionSweep *= -1\n        }\n\n        const startBreak = midShaftAngle - captionSweep / 2\n        const endBreak = midShaftAngle + captionSweep / 2\n\n        return [\n          'M',\n          coord(startTangent(shaftRadius)),\n          'L',\n          coord(startTangent(-shaftRadius)),\n          'A',\n          arcRadius - shaftRadius,\n          arcRadius - shaftRadius,\n          0,\n          0,\n          positiveSweep,\n          coord(angleTangent(startBreak, -shaftRadius)),\n          'L',\n          coord(angleTangent(startBreak, shaftRadius)),\n          'A',\n          arcRadius + shaftRadius,\n          arcRadius + shaftRadius,\n          0,\n          0,\n          negativeSweep,\n          coord(startTangent(shaftRadius)),\n          'Z',\n          'M',\n          coord(angleTangent(endBreak, shaftRadius)),\n          'L',\n          coord(angleTangent(endBreak, -shaftRadius)),\n          'A',\n          arcRadius - shaftRadius,\n          arcRadius - shaftRadius,\n          0,\n          0,\n          positiveSweep,\n          coord(endTangent(-shaftRadius)),\n          'L',\n          coord(endTangent(-headRadius)),\n          'L',\n          coord(endNormal(headLength)),\n          'L',\n          coord(endTangent(headRadius)),\n          'L',\n          coord(endTangent(shaftRadius)),\n          'A',\n          arcRadius + shaftRadius,\n          arcRadius + shaftRadius,\n          0,\n          0,\n          negativeSweep,\n          coord(angleTangent(endBreak, shaftRadius))\n        ].join(' ')\n      } else {\n        return [\n          'M',\n          coord(startTangent(shaftRadius)),\n          'L',\n          coord(startTangent(-shaftRadius)),\n          'A',\n          arcRadius - shaftRadius,\n          arcRadius - shaftRadius,\n          0,\n          0,\n          positiveSweep,\n          coord(endTangent(-shaftRadius)),\n          'L',\n          coord(endTangent(-headRadius)),\n          'L',\n          coord(endNormal(headLength)),\n          'L',\n          coord(endTangent(headRadius)),\n          'L',\n          coord(endTangent(shaftRadius)),\n          'A',\n          arcRadius + shaftRadius,\n          arcRadius + shaftRadius,\n          0,\n          0,\n          negativeSweep,\n          coord(startTangent(shaftRadius))\n        ].join(' ')\n      }\n    }\n\n    this.overlay = function (minWidth) {\n      const radius = Math.max(minWidth / 2, shaftRadius)\n\n      return [\n        'M',\n        coord(startTangent(radius)),\n        'L',\n        coord(startTangent(-radius)),\n        'A',\n        arcRadius - radius,\n        arcRadius - radius,\n        0,\n        0,\n        positiveSweep,\n        coord(endTangent(-radius)),\n        'L',\n        coord(endOverlayCorner(-radius, headLength)),\n        'L',\n        coord(endOverlayCorner(radius, headLength)),\n        'L',\n        coord(endTangent(radius)),\n        'A',\n        arcRadius + radius,\n        arcRadius + radius,\n        0,\n        0,\n        negativeSweep,\n        coord(startTangent(radius))\n      ].join(' ')\n    }\n  }\n}\n","\nimport measureText from './textMeasurement'\nimport LoopArrow from './loopArrow'\nimport StraightArrow from './straightArrow'\nimport ArcArrow from './arcArrow'\n\nexport default class PairwiseArcsRelationshipRouting {\n  constructor (style) {\n    this.style = style\n  }\n\n  measureRelationshipCaption (relationship, caption) {\n    const fontFamily = 'sans-serif'\n    const padding = parseFloat(\n      this.style.forRelationship(relationship).get('padding')\n    )\n    return (\n      measureText(caption, fontFamily, relationship.captionHeight) + padding * 2\n    )\n  }\n\n  captionFitsInsideArrowShaftWidth (relationship) {\n    return (\n      parseFloat(this.style.forRelationship(relationship).get('shaft-width')) >\n      relationship.captionHeight\n    )\n  }\n\n  measureRelationshipCaptions (relationships) {\n    return (() => {\n      const result = []\n      for (let relationship of Array.from(relationships)) {\n        relationship.captionHeight = parseFloat(\n          this.style.forRelationship(relationship).get('font-size')\n        )\n        relationship.captionLength = this.measureRelationshipCaption(\n          relationship,\n          relationship.caption\n        )\n        result.push(\n          (relationship.captionLayout =\n            this.captionFitsInsideArrowShaftWidth(relationship) &&\n            !relationship.isLoop()\n              ? 'internal'\n              : 'external')\n        )\n      }\n      return result\n    })()\n  }\n\n  shortenCaption (relationship, caption, targetWidth) {\n    let shortCaption = caption || 'caption'\n    while (true) {\n      if (shortCaption.length <= 2) {\n        return ['', 0]\n      }\n      shortCaption = shortCaption.substr(0, shortCaption.length - 2) + '\\u2026'\n      const width = this.measureRelationshipCaption(relationship, shortCaption)\n      if (width < targetWidth) {\n        return [shortCaption, width]\n      }\n    }\n  }\n\n  computeGeometryForNonLoopArrows (nodePairs) {\n    const square = distance => distance * distance\n    return (() => {\n      const result = []\n      for (var nodePair of Array.from(nodePairs)) {\n        if (!nodePair.isLoop()) {\n          const dx = nodePair.nodeA.x - nodePair.nodeB.x\n          const dy = nodePair.nodeA.y - nodePair.nodeB.y\n          var angle = ((Math.atan2(dy, dx) / Math.PI) * 180 + 360) % 360\n          var centreDistance = Math.sqrt(square(dx) + square(dy))\n          result.push(\n            (() => {\n              const result1 = []\n              for (let relationship of Array.from(nodePair.relationships)) {\n                relationship.naturalAngle =\n                  relationship.target === nodePair.nodeA\n                    ? (angle + 180) % 360\n                    : angle\n                result1.push((relationship.centreDistance = centreDistance))\n              }\n              return result1\n            })()\n          )\n        } else {\n          result.push(undefined)\n        }\n      }\n      return result\n    })()\n  }\n\n  distributeAnglesForLoopArrows (nodePairs, relationships) {\n    return (() => {\n      const result = []\n      for (var nodePair of Array.from(nodePairs)) {\n        if (nodePair.isLoop()) {\n          var i, separation\n          let angles = []\n          const node = nodePair.nodeA\n          for (var relationship of Array.from(relationships)) {\n            if (!relationship.isLoop()) {\n              if (relationship.source === node) {\n                angles.push(relationship.naturalAngle)\n              }\n              if (relationship.target === node) {\n                angles.push(relationship.naturalAngle + 180)\n              }\n            }\n          }\n          angles = angles.map(a => (a + 360) % 360).sort((a, b) => a - b)\n          if (angles.length > 0) {\n            var end, start\n            var biggestGap = {\n              start: 0,\n              end: 0\n            }\n            for (i = 0; i < angles.length; i++) {\n              const angle = angles[i]\n              start = angle\n              end = i === angles.length - 1 ? angles[0] + 360 : angles[i + 1]\n              if (end - start > biggestGap.end - biggestGap.start) {\n                biggestGap.start = start\n                biggestGap.end = end\n              }\n            }\n            separation =\n              (biggestGap.end - biggestGap.start) /\n              (nodePair.relationships.length + 1)\n            result.push(\n              (() => {\n                const result1 = []\n                for (i = 0; i < nodePair.relationships.length; i++) {\n                  relationship = nodePair.relationships[i]\n                  result1.push(\n                    (relationship.naturalAngle =\n                      (biggestGap.start + (i + 1) * separation - 90) % 360)\n                  )\n                }\n                return result1\n              })()\n            )\n          } else {\n            separation = 360 / nodePair.relationships.length\n            result.push(\n              (() => {\n                const result2 = []\n                for (i = 0; i < nodePair.relationships.length; i++) {\n                  relationship = nodePair.relationships[i]\n                  result2.push((relationship.naturalAngle = i * separation))\n                }\n                return result2\n              })()\n            )\n          }\n        } else {\n          result.push(undefined)\n        }\n      }\n      return result\n    })()\n  }\n\n  layoutRelationships (graph) {\n    const nodePairs = graph.groupedRelationships()\n    this.computeGeometryForNonLoopArrows(nodePairs)\n    this.distributeAnglesForLoopArrows(nodePairs, graph.relationships())\n\n    return (() => {\n      const result = []\n      for (var nodePair of Array.from(nodePairs)) {\n        for (var relationship of Array.from(nodePair.relationships)) {\n          delete relationship.arrow\n        }\n\n        var middleRelationshipIndex = (nodePair.relationships.length - 1) / 2\n        var defaultDeflectionStep = 30\n        const maximumTotalDeflection = 150\n        const numberOfSteps = nodePair.relationships.length - 1\n        const totalDeflection = defaultDeflectionStep * numberOfSteps\n\n        var deflectionStep =\n          totalDeflection > maximumTotalDeflection\n            ? maximumTotalDeflection / numberOfSteps\n            : defaultDeflectionStep\n\n        result.push(\n          (() => {\n            const result1 = []\n            for (let i = 0; i < nodePair.relationships.length; i++) {\n              var ref\n              relationship = nodePair.relationships[i]\n              const shaftWidth =\n                parseFloat(\n                  this.style.forRelationship(relationship).get('shaft-width')\n                ) || 2\n              const headWidth = shaftWidth + 6\n              const headHeight = headWidth\n\n              if (nodePair.isLoop()) {\n                relationship.arrow = new LoopArrow(\n                  relationship.source.radius,\n                  40,\n                  defaultDeflectionStep,\n                  shaftWidth,\n                  headWidth,\n                  headHeight,\n                  relationship.captionHeight\n                )\n              } else {\n                if (i === middleRelationshipIndex) {\n                  relationship.arrow = new StraightArrow(\n                    relationship.source.radius,\n                    relationship.target.radius,\n                    relationship.centreDistance,\n                    shaftWidth,\n                    headWidth,\n                    headHeight,\n                    relationship.captionLayout\n                  )\n                } else {\n                  let deflection =\n                    deflectionStep * (i - middleRelationshipIndex)\n\n                  if (nodePair.nodeA !== relationship.source) {\n                    deflection *= -1\n                  }\n\n                  relationship.arrow = new ArcArrow(\n                    relationship.source.radius,\n                    relationship.target.radius,\n                    relationship.centreDistance,\n                    deflection,\n                    shaftWidth,\n                    headWidth,\n                    headHeight,\n                    relationship.captionLayout\n                  )\n                }\n              }\n\n              result1.push(\n                ([\n                  relationship.shortCaption,\n                  relationship.shortCaptionLength\n                ] = Array.from(\n                  (ref =\n                    relationship.arrow.shaftLength > relationship.captionLength\n                      ? [relationship.caption, relationship.captionLength]\n                      : this.shortenCaption(\n                        relationship,\n                        relationship.caption,\n                        relationship.arrow.shaftLength\n                      ))\n                )),\n                ref\n              )\n            }\n            return result1\n          })()\n        )\n      }\n      return result\n    })()\n  }\n}\n","\nimport PairwiseArcsRelationshipRouting from '../utils/pairwiseArcsRelationshipRouting'\nimport measureText from '../utils/textMeasurement'\n\nexport default class NeoD3Geometry {\n  constructor (style) {\n    this.style = style\n    this.relationshipRouting = new PairwiseArcsRelationshipRouting(this.style)\n  }\n  formatNodeCaptions (nodes) {\n    return Array.from(nodes).map(\n      node => node.caption = fitCaptionIntoCircle(node, this.style)\n    )\n  }\n\n  formatRelationshipCaptions (relationships) {\n    return (() => {\n      const result = []\n      for (let relationship of Array.from(relationships)) {\n        const template = this.style.forRelationship(relationship).get('caption')\n        result.push(\n          (relationship.caption = this.style.interpolate(\n            template,\n            relationship\n          ))\n        )\n      }\n      return result\n    })()\n  }\n\n  setNodeRadii (nodes) {\n    return Array.from(nodes).map(\n      node =>\n        (node.radius = parseFloat(this.style.forNode(node).get('diameter')) / 2)\n    )\n  }\n\n  onGraphChange (graph) {\n    this.setNodeRadii(graph.nodes())\n    this.formatNodeCaptions(graph.nodes())\n    this.formatRelationshipCaptions(graph.relationships())\n    return this.relationshipRouting.measureRelationshipCaptions(\n      graph.relationships()\n    )\n  }\n\n  onTick (graph) {\n    return this.relationshipRouting.layoutRelationships(graph)\n  }\n}\n\nlet square = distance => distance * distance\nlet addShortenedNextWord = (line, word, measure) => {\n  const result = []\n  while (!(word.length <= 2)) {\n    word = word.substr(0, word.length - 2) + '\\u2026'\n    if (measure(word) < line.remainingWidth) {\n      line.text += ` ${word}`\n      break\n    } else {\n      result.push(undefined)\n    }\n  }\n  return result\n}\nlet noEmptyLines = function (lines) {\n  for (let line of Array.from(lines)) {\n    if (line.text.length === 0) {\n      return false\n    }\n  }\n  return true\n}\n\nlet fitCaptionIntoCircle = function (node, style) {\n  const template = style.forNode(node).get('caption')\n  // 获取显示的文字信息\n  let captionText = style.interpolate(template, node)\n  const fontFamily = 'sans-serif'\n  const fontSize = parseFloat(style.forNode(node).get('font-size'))\n  const lineHeight = fontSize\n  const measure = text => measureText(text, fontFamily, fontSize)\n\n  const words = captionText.split(' ')\n\n  const emptyLine = function (lineCount, iLine) {\n    let baseline = (1 + iLine - lineCount / 2) * lineHeight\n    if (style.forNode(node).get('icon-code')) {\n      baseline = baseline + node.radius / 3\n    }\n    const containingHeight =\n      iLine < lineCount / 2 ? baseline - lineHeight : baseline\n    const lineWidth =\n      Math.sqrt(square(node.radius) - square(containingHeight)) * 2\n    return {\n      node,\n      text: '',\n      baseline,\n      remainingWidth: lineWidth\n    }\n  }\n\n  const fitOnFixedNumberOfLines = function (lineCount) {\n    const lines = []\n    let iWord = 0\n    for (\n      let iLine = 0, end = lineCount - 1, asc = end >= 0;\n      asc ? iLine <= end : iLine >= end;\n      asc ? iLine++ : iLine--\n    ) {\n      const line = emptyLine(lineCount, iLine)\n      while (\n        iWord < words.length &&\n        measure(` ${words[iWord]}`) < line.remainingWidth\n      ) {\n        line.text += ` ${words[iWord]}`\n        line.remainingWidth -= measure(` ${words[iWord]}`)\n        iWord++\n      }\n      lines.push(line)\n    }\n    if (iWord < words.length) {\n      addShortenedNextWord(lines[lineCount - 1], words[iWord], measure)\n    }\n    return [lines, iWord]\n  }\n\n  let consumedWords = 0\n  const maxLines = (node.radius * 2) / fontSize\n\n  let lines = [emptyLine(1, 0)]\n  for (\n    let lineCount = 1, end = maxLines, asc = end >= 1;\n    asc ? lineCount <= end : lineCount >= end;\n    asc ? lineCount++ : lineCount--\n  ) {\n    const [candidateLines, candidateWords] = Array.from(\n      fitOnFixedNumberOfLines(lineCount)\n    )\n    if (noEmptyLines(candidateLines)) {\n      ;[lines, consumedWords] = Array.from([candidateLines, candidateWords])\n    }\n    if (consumedWords >= words.length) {\n      return lines\n    }\n  }\n  return lines\n}\n","\n\nconst icons = {\n  'Expand / Collapse':\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"icon\"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>Expand / Collapse</title><circle class=\"a\" cx=\"13.5\" cy=\"10.498\" r=\"3.75\"/><circle class=\"a\" cx=\"21\" cy=\"2.998\" r=\"2.25\"/><circle class=\"a\" cx=\"21\" cy=\"15.748\" r=\"2.25\"/><circle class=\"a\" cx=\"13.5\" cy=\"20.998\" r=\"2.25\"/><circle class=\"a\" cx=\"3\" cy=\"20.998\" r=\"2.25\"/><circle class=\"a\" cx=\"3.75\" cy=\"5.248\" r=\"2.25\"/><line class=\"a\" x1=\"16.151\" y1=\"7.848\" x2=\"19.411\" y2=\"4.588\"/><line class=\"a\" x1=\"16.794\" y1=\"12.292\" x2=\"19.079\" y2=\"14.577\"/><line class=\"a\" x1=\"13.5\" y1=\"14.248\" x2=\"13.5\" y2=\"18.748\"/><line class=\"a\" x1=\"10.851\" y1=\"13.147\" x2=\"4.59\" y2=\"19.408\"/><line class=\"a\" x1=\"10.001\" y1=\"9.149\" x2=\"5.61\" y2=\"6.514\"/></g></svg>',\n  Unlock:\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"icon\"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>Unlock</title><path class=\"a\" d=\"M.75,9.75V6a5.25,5.25,0,0,1,10.5,0V9.75\"/><rect class=\"a\" x=\"6.75\" y=\"9.75\" width=\"16.5\" height=\"13.5\" rx=\"1.5\" ry=\"1.5\"/><line class=\"a\" x1=\"15\" y1=\"15\" x2=\"15\" y2=\"18\"/></g></svg>',\n  New : \n    '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"icon\"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>news</title><polygon fill-rule=\"evenodd\"  points=\"13 11 22 11 22 13 13 13 13 22 11 22 11 13 2 13 2 11 11 11 11 2 13 2\"/></g></svg>',\n  Delete : \n  '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"icon\"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>news</title><path fill=\"#333333\" d=\"M19.376,9.81c-0.016-0.1-0.077-0.197-0.168-0.29c-0.733,0.745-3.683,0.868-7.209,0.868s-6.473-0.123-7.21-0.868C4.699,9.613,4.642,9.71,4.621,9.81H4.615l0.002,0.054c0,0.006-0.002,0.012-0.002,0.019c0,0.014,0.004,0.028,0.006,0.041l0.574,11.76h0.001C5.247,22.606,6.303,24,11.999,24c5.696,0,6.753-1.394,6.803-2.316h0.004l0.575-11.76c0.001-0.014,0.006-0.027,0.006-0.041c0-0.006-0.004-0.012-0.004-0.019l0.004-0.054H19.376z\"/><path fill=\"#333333\" d=\"M15.509,3.655V0.806c0-0.464-0.38-0.844-0.844-0.844H9.026c-0.463,0-0.842,0.379-0.842,0.842v2.882C5.467,3.994,3.607,4.618,3.607,5.341v1.373c0,0.282,0.285,0.55,0.797,0.792c1.34,0.629,4.238,1.066,7.595,1.066c3.36,0,6.256-0.437,7.598-1.066c0.509-0.242,0.796-0.51,0.796-0.792V5.341C20.393,4.593,18.389,3.949,15.509,3.655z M9.941,3.54L9.709,3.554v-1.15c0-0.503,0.07-0.915,0.153-0.915c0.085,0,0.565,0,1.069,0h1.831c0.501,0,0.983,0,1.067,0c0.084,0,0.153,0.412,0.153,0.915v1.132c-0.637-0.033-1.299-0.054-1.985-0.054C11.288,3.482,10.598,3.503,9.941,3.54z\"/></g></svg>',\n  Edit : \n  '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"icon\"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>edit</title> <path fill-rule=\"evenodd\" d=\"M14.8024118,6.44526791 L8.69610276,12.549589 C8.29095108,12.9079238 8.04030835,13.4092335 8,13.8678295 L8,16.0029438 L10.0639829,16.004826 C10.5982069,15.9670062 11.0954869,15.7183782 11.4947932,15.2616227 L17.556693,9.19972295 L14.8024118,6.44526791 Z M16.2168556,5.0312846 L18.9709065,7.78550938 L19.8647941,6.89162181 C19.9513987,6.80501747 20.0000526,6.68755666 20.0000526,6.56507948 C20.0000526,6.4426023 19.9513987,6.32514149 19.8647932,6.23853626 L17.7611243,4.13485646 C17.6754884,4.04854589 17.5589355,4 17.43735,4 C17.3157645,4 17.1992116,4.04854589 17.1135757,4.13485646 L16.2168556,5.0312846 Z M22,13 L22,20 C22,21.1045695 21.1045695,22 20,22 L4,22 C2.8954305,22 2,21.1045695 2,20 L2,4 C2,2.8954305 2.8954305,2 4,2 L11,2 L11,4 L4,4 L4,20 L20,20 L20,13 L22,13 Z M17.43735,2 C18.0920882,2 18.7197259,2.26141978 19.1781068,2.7234227 L21.2790059,4.82432181 C21.7406843,5.28599904 22.0000526,5.91216845 22.0000526,6.56507948 C22.0000526,7.21799052 21.7406843,7.84415992 21.2790068,8.30583626 L12.9575072,16.6237545 C12.2590245,17.4294925 11.2689,17.9245308 10.1346,18.0023295 L6,18.0023295 L6,17.0023295 L6.00324765,13.7873015 C6.08843822,12.7328366 6.57866679,11.7523321 7.32649633,11.0934196 L15.6953877,2.72462818 C16.1563921,2.2608295 16.7833514,2 17.43735,2 Z\"/></g></svg>',  \n    Remove:\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"icon\"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>Remove</title><path class=\"a\" d=\"M8.153,13.664a12.271,12.271,0,0,1-5.936-4.15L1.008,7.96a.75.75,0,0,1,0-.92L2.217,5.486A12.268,12.268,0,0,1,11.9.75h0a12.269,12.269,0,0,1,9.684,4.736L22.792,7.04a.748.748,0,0,1,0,.92L21.584,9.514\"/><path class=\"a\" d=\"M10.4,10.937A3.749,3.749,0,1,1,15.338,9\"/><circle class=\"a\" cx=\"17.15\" cy=\"17.25\" r=\"6\"/><line class=\"a\" x1=\"14.15\" y1=\"17.25\" x2=\"20.15\" y2=\"17.25\"/></g></svg>'\n}\n\nexport default icons\n","import d3 from 'd3'\nimport Renderer from '../components/renderer'\nimport icons from '../renders/icons'\n\nconst noop = function () {}\n\n// TODO:\nconst numberOfItemsInContextMenu = 6\n\nconst arc = function (radius, itemNumber, width) {\n  if (width == null) {\n    width = 30\n  }\n  itemNumber = itemNumber - 1\n  const startAngle = ((2 * Math.PI) / numberOfItemsInContextMenu) * itemNumber\n  const endAngle = startAngle + (2 * Math.PI) / numberOfItemsInContextMenu\n  const innerRadius = Math.max(radius + 8, 20)\n  return d3.svg\n    .arc()\n    .innerRadius(innerRadius)\n    .outerRadius(innerRadius + width)\n    .startAngle(startAngle)\n    .endAngle(endAngle)\n    .padAngle(0.03)\n}\n// 获取选中的node\nconst getSelectedNode = function (node) {\n  if (node.selected) {\n    return [node]\n  } else {\n    return []\n  }\n}\n\nconst attachContextEvent = (event, elems, viz, content, label) =>\n  (() => {\n    const result = []\n    for (let elem of Array.from(elems)) {\n      elem.on('mousedown.drag', function () {\n        d3.event.stopPropagation()\n        return null\n      })\n      elem.on('mouseup', node => viz.trigger(event, node))\n      elem.on('mouseover', function (node) {\n        node.contextMenu = {\n          menuSelection: event,\n          menuContent: content,\n          label\n        }\n        return viz.trigger('menuMouseOver', node)\n      })\n      result.push(\n        elem.on('mouseout', function (node) {\n          delete node.contextMenu\n          return viz.trigger('menuMouseOut', node)\n        })\n      )\n    }\n    return result\n  })()\n\nconst createMenuItem = function (\n  selection,\n  viz,\n  eventName,\n  itemNumber,\n  className,\n  position,\n  textValue,\n  helpValue\n) {\n  const path = selection.selectAll(`path.${className}`).data(getSelectedNode)\n  const iconPath = selection\n    .selectAll(`.icon.${className}`)\n    .data(getSelectedNode)\n\n  const tab = path\n    .enter()\n    .append('path')\n    .classed(className, true)\n    .classed('context-menu-item', true)\n    .attr({\n      d (node) {\n        return arc(node.radius, itemNumber, 1)()\n      }\n    })\n\n  const rawSvgIcon = icons[textValue];\n  // console.log(icons);\n  // console.log(rawSvgIcon)\n  const icon = iconPath\n    .enter()\n    .appendSVG(rawSvgIcon)\n    .classed(className, true)\n    .classed('context-menu-item', true)\n    .attr({\n      transform (node) {\n        return (\n          'translate(' +\n          Math.floor(\n            arc(node.radius, itemNumber).centroid()[0] +\n              (position[0] * 100) / 100\n          ) +\n          ',' +\n          Math.floor(\n            arc(node.radius, itemNumber).centroid()[1] +\n              (position[1] * 100) / 100\n          ) +\n          ')' +\n          ' ' +\n          'scale(0.7)'\n        )\n      },\n      color (node) {\n        return viz.style.forNode(node).get('text-color-internal')\n      },\n      fill(node){\n        return  viz.style.forNode(node).get('text-color-internal')\n      }\n    })\n  attachContextEvent(eventName, [tab, icon], viz, helpValue, rawSvgIcon)\n\n  tab\n    .transition()\n    .duration(200)\n    .attr({\n      d (node) {\n        return arc(node.radius, itemNumber)()\n      }\n    })\n\n  path\n    .exit()\n    .transition()\n    .duration(200)\n    .attr({\n      d (node) {\n        return arc(node.radius, itemNumber, 1)()\n      }\n    })\n    .remove()\n\n  return iconPath.exit().remove()\n}\n\nconst donutRemoveNode = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'nodeClose',\n      1,\n      'remove_node',\n      [-8, -8],\n      'Remove',\n      'Dismiss'\n    )\n  },\n\n  onTick: noop\n})\n\n\nconst donutExpandNode = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'nodeDblClicked',\n      2,\n      'expand_node',\n      [-8, -8],\n      'Expand / Collapse',\n      'Expand / Collapse child relationships'\n    )\n  },\n\n  onTick: noop\n})\n\nconst donutUnlockNode = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'nodeUnlock',\n      3,\n      'unlock_node',\n      [-8, -6],\n      'Unlock',\n      'Unlock the node to re-layout the graph'\n    )\n  },\n\n  onTick: noop\n})\n\n\n\n\nconst donutDeleteNode = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'nodeDelete',\n      4,\n      'delete_node',\n      [-10, -12],\n      'Delete',\n      'delete node'\n    )\n  },\n  onTick: noop\n\n})\n\n\nconst donutNewNode = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'nodeNew',\n      5,\n      'new_node',\n      [-9, -9],\n      'New',\n      'new node'\n    )\n  },\n  onTick: noop\n\n})\n\n\n\nconst donutEditNode = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'nodeEdit',\n      6,\n      'edit_node',\n      [-6, -6],\n      'Edit',\n      'edit node'\n    )\n  },\n  onTick: noop\n\n})\n\n\nconst menu = []\n\nmenu.push(donutExpandNode)\nmenu.push(donutRemoveNode)\nmenu.push(donutUnlockNode)\nmenu.push(donutDeleteNode)\nmenu.push(donutNewNode)\nmenu.push(donutEditNode)\n\nexport { menu }\n","\nimport d3 from \"d3\"\nimport Renderer from '../components/renderer'\n\nconst noop = function () {}\n\n// 获取选中的node\nconst getRightClickedNode = function (node) {\n  if (node.rightClicked) {\n    return [node]\n  } else {\n    return []\n  }\n}\n\nconst attachContextEvent = (event, elems, viz, content) =>\n  (() => {\n    const result = []\n    for (let elem of Array.from(elems)) {\n      elem.on('mousedown.drag', function () {\n        d3.event.stopPropagation()\n        return null\n      })\n      elem.on('mouseup', node => viz.trigger(event, node))\n    }  \n    return result\n  })()\n\nconst createMenuItem = function (\n  selection,\n  viz,\n  eventName,\n  itemNumber,\n  className,\n  text\n) {\n  let g = selection.selectAll(`.right-menu.${className}`);\n  g.remove();\n  let g1 =  selection.selectAll(`.right-menu.${className}`).data(getRightClickedNode)\n    .enter()\n    .append('g')\n    .classed(className,true)\n    .classed('right-menu',true)\n  let rec =   g1.append('rect')\n    .attr({\n      width : 100,\n      height : 20,\n      fill : 'white',\n      stroke : '#e8e8e8',\n      'stroke-width':1,\n    })\n  let txt =   g1.append('text')\n    .text(text)\n    .classed('right-menu-text',true)\n    .attr({\n        x : 10,\n        y : 10,\n    })\n\n    g1.attr({\n      transform : `translate(40,${20*itemNumber})`,\n    })\n  attachContextEvent(eventName, [rec,txt] , viz, text)\n\n  return;\n}\n\nconst donutClearNode = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'clearSelected',\n      0,\n      'clear_selected',\n      '清除选择'\n    )\n  },\n\n  onTick: noop\n})\nconst donutContraryNode = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'contrarySelected',\n      1,\n      'contrary_selected',\n      '反选'\n    )\n  },\n\n  onTick: noop\n})\n\nconst donutBackStatus = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'backStatus',\n      2,\n      'back_status',\n      '上一步'\n    )\n  },\n\n  onTick: noop\n})\nconst donutInitStatus = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'initStatus',\n      3,\n      'init_status',\n      '初始化'\n    )\n  },\n  onTick: noop\n})\nconst donutMadeChart = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'madeChart',\n      4,\n      'made_chart',\n      '生成图'\n    )\n  },\n  onTick: noop\n})\nconst donutStartFrame = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'startFrame',\n      3,\n      'start_frame',\n      '播放动画'\n    )\n  },\n  onTick: noop\n})\n\nconst donutAddRel = new Renderer({\n  onGraphChange (selection, viz) {\n    return createMenuItem(\n      selection,\n      viz,\n      'addRel',\n      1,\n      'add_rel',\n      '新增边'\n    )\n  },\n  onTick: noop\n})\n\nconst rightMenu = []\nconst rightMenu1 = []\n\nrightMenu.push(donutClearNode)\nrightMenu.push(donutContraryNode)\nrightMenu.push(donutBackStatus)\nrightMenu.push(donutInitStatus)\nrightMenu.push(donutMadeChart)\n// rightMenu.push(donutStartFrame)\nrightMenu1.push(donutAddRel)\n\n\nexport { rightMenu , rightMenu1 }\n","\nimport d3 from 'd3'\nexport default function clickHandler () {\n  const cc = function (selection) {\n    // euclidean distance\n    const dist = (a, b) =>\n      Math.sqrt(Math.pow(a[0] - b[0], 2), Math.pow(a[1] - b[1], 2))\n    let down\n    const tolerance = 5\n    let wait = null\n    selection.on('mousedown', function () {\n      d3.event.target.__data__.fixed = true\n      down = d3.mouse(document.body)\n      return d3.event.stopPropagation()\n    })\n\n    return selection.on('mouseup', function () {\n      if (dist(down, d3.mouse(document.body)) > tolerance) {\n      } else {\n        if (wait) {\n          window.clearTimeout(wait)\n          wait = null\n          return event.dblclick(d3.event.target.__data__)\n        } else {\n          event.click(d3.event.target.__data__)\n          return (wait = window.setTimeout(\n            (e => () => (wait = null))(d3.event),\n            250\n          ))\n        }\n      }\n    })\n  }\n\n  var event = d3.dispatch('click', 'dblclick')\n  return d3.rebind(cc, event, 'on')\n}\n","import d3 from 'd3'\nimport NeoD3Geometry from './graphGeometry'\nimport * as vizRenderers from '../renders/init'\nimport { menu as menuRenderer } from '../renders/menu'\nimport { rightMenu , rightMenu1} from '../renders/rightMenu'\nimport vizClickHandler from '../utils/clickHandler'\n\nconst vizFn = function (el, measureSize, graph, layout, style) {\n  const viz = { style }\n  const root = d3.select(el)\n  const baseGroup = root.append('g').attr('transform', 'translate(0,0)')\n  // 渲染底层画布\n  const rect = baseGroup\n    .append('rect')\n    .style('fill', 'none')\n    .style('pointer-events', 'all')\n    // Make the rect cover the whole surface\n    .attr('x', '-2500')\n    .attr('y', '-2500')\n    .attr('width', '5000')\n    .attr('height', '5000')\n    .attr('transform', 'scale(1)')\n// 渲染显示节点的g组\n  const container = baseGroup.append('g')\n  const geometry = new NeoD3Geometry(style)\n\n\n  // This flags that a panning is ongoing and won't trigger\n  // 'canvasClick' event when panning ends.\n  let draw = false\n\n  // Arbitrary dimension used to keep force layout aligned with\n  // the centre of the svg view-port.\n  const layoutDimension = 200\n\n  let updateViz = true\n\n  // To be overridden\n  viz.trigger = function (event, ...args) {\n    console.log(event);\n  }\n\n  \n  const onNodeClick = node => {\n    updateViz = false\n    if(d3.event.button ==  0){\n      if(d3.event.ctrlKey){\n        graph.isCtrlClick = true;\n        return viz.trigger('nodeCtrlClick',node)\n      }else{\n        return viz.trigger('nodeClicked', node)\n      }\n    }else{\n      return viz.trigger('nodeClickRight',node)\n    }\n  }\n\n  const onNodeDblClick = node => viz.trigger('nodeDblClicked', node)\n\n  const onNodeDragToggle = node => viz.trigger('nodeDragToggle', node)\n\n  const onRelationshipClick = relationship => {\n    d3.event.stopPropagation()\n    updateViz = false\n    return viz.trigger('relationshipClicked', relationship)\n  }\n\n  const onNodeMouseOver = node => viz.trigger('nodeMouseOver', node)\n  const onNodeMouseOut = node => viz.trigger('nodeMouseOut', node)\n  const onNodeMouseUp = function(node){\n    if(d3.event.button ==  0){\n      if(d3.event.ctrlKey){\n        graph.isCtrlClick = true;\n        return viz.trigger('nodeCtrlClick',node)\n      }\n    }else{\n      return viz.trigger('nodeClickRight',node)\n    }\n  }\n\n  const onRelMouseOver = rel => viz.trigger('relMouseOver', rel)\n  const onRelMouseOut = rel => viz.trigger('relMouseOut', rel)\n\n  let zoomLevel = null\n\n  const zoomed = function () {\n    draw = true\n    return container.attr(\n      'transform',\n      `translate(${zoomBehavior.translate()})scale(${zoomBehavior.scale()})`\n    )\n  }\n\n  var zoomBehavior = d3.behavior\n    .zoom()\n    .scaleExtent([0.2, 1])\n    .on('zoom', zoomed)\n\n  const interpolateZoom = (translate, scale) =>\n    d3\n      .transition()\n      .duration(500)\n      .tween('zoom', function () {\n        const t = d3.interpolate(zoomBehavior.translate(), translate)\n        const s = d3.interpolate(zoomBehavior.scale(), scale)\n        return function (a) {\n          zoomBehavior.scale(s(a)).translate(t(a))\n          return zoomed()\n        }\n      })\n\n  let isZoomingIn = true\n\n  viz.zoomInClick = function () {\n    isZoomingIn = true\n    return zoomClick(this)\n  }\n\n  viz.zoomOutClick = function () {\n    isZoomingIn = false\n    return zoomClick(this)\n  }\n\n  var zoomClick = function (element) {\n    draw = true\n    const limitsReached = { zoomInLimit: false, zoomOutLimit: false }\n\n    if (isZoomingIn) {\n      zoomLevel = Number((zoomBehavior.scale() * (1 + 0.2 * 1)).toFixed(2))\n      if (zoomLevel >= zoomBehavior.scaleExtent()[1]) {\n        limitsReached.zoomInLimit = true\n        interpolateZoom(zoomBehavior.translate(), zoomBehavior.scaleExtent()[1])\n      } else {\n        interpolateZoom(zoomBehavior.translate(), zoomLevel)\n      }\n    } else {\n      zoomLevel = Number((zoomBehavior.scale() * (1 + 0.2 * -1)).toFixed(2))\n      if (zoomLevel <= zoomBehavior.scaleExtent()[0]) {\n        limitsReached.zoomOutLimit = true\n        interpolateZoom(zoomBehavior.translate(), zoomBehavior.scaleExtent()[0])\n      } else {\n        interpolateZoom(zoomBehavior.translate(), zoomLevel)\n      }\n    }\n    return limitsReached\n  }\n  // Background click event\n  // Check if panning is ongoing\n  rect.on('click', function () {\n    if (!draw) {\n      return viz.trigger('canvasClicked', el)\n    }\n  })\n\n  baseGroup\n    .call(zoomBehavior)\n    .on('dblclick.zoom', null)\n    // Single click is not panning\n    .on('click.zoom', () => (draw = false))\n    .on('DOMMouseScroll.zoom', null)\n    .on('wheel.zoom', null)\n    .on('mousewheel.zoom', null)\n\n  const newStatsBucket = function () {\n    const bucket = {\n      frameCount: 0,\n      geometry: 0,\n      relationshipRenderers: (function () {\n        const timings = {}\n        vizRenderers.relationship.forEach(r => (timings[r.name] = 0))\n        return timings\n      })()\n    }\n    bucket.duration = () => bucket.lastFrame - bucket.firstFrame\n    bucket.fps = () =>\n      ((1000 * bucket.frameCount) / bucket.duration()).toFixed(1)\n    bucket.lps = () =>\n      ((1000 * bucket.layout.layoutSteps) / bucket.duration()).toFixed(1)\n    bucket.top = function () {\n      let time\n      const renderers = []\n      for (let name in bucket.relationshipRenderers) {\n        time = bucket.relationshipRenderers[name]\n        renderers.push({\n          name,\n          time\n        })\n      }\n      renderers.push({\n        name: 'forceLayout',\n        time: bucket.layout.layoutTime\n      })\n      renderers.sort((a, b) => b.time - a.time)\n      const totalRenderTime = renderers.reduce(\n        (prev, current) => prev + current.time,\n        0\n      )\n      return renderers\n        .map(\n          d => `${d.name}: ${((100 * d.time) / totalRenderTime).toFixed(1)}%`\n        )\n        .join(', ')\n    }\n    return bucket\n  }\n\n  let currentStats = newStatsBucket()\n\n  const now =\n    window.performance && window.performance.now\n      ? () => window.performance.now()\n      : () => Date.now()\n\n  const render = function () {\n    if (!currentStats.firstFrame) {\n      currentStats.firstFrame = now()\n    }\n    currentStats.frameCount++\n    const startRender = now()\n    geometry.onTick(graph)\n    currentStats.geometry += now() - startRender\n\n    const nodeGroups = container\n      .selectAll('g.node')\n      .attr('transform', d => `translate(${d.x},${d.y})`)\n\n    for (var renderer of Array.from(vizRenderers.node)) {\n      nodeGroups.call(renderer.onTick, viz)\n    }\n\n    const relationshipGroups = container\n      .selectAll('g.relationship')\n      .attr(\n        'transform',\n        d =>\n          `translate(${d.source.x} ${d.source.y}) rotate(${d.naturalAngle +\n            180})`\n      )\n    for (renderer of Array.from(vizRenderers.relationship)) {\n      const startRenderer = now()\n      relationshipGroups.call(renderer.onTick, viz)\n      currentStats.relationshipRenderers[renderer.name] += now() - startRenderer\n    }\n\n    return (currentStats.lastFrame = now())\n  }\n  \n  // 初始化 力导向图\n  const force = layout.init(render)\n\n  // Add custom drag event listeners\n  force\n    .drag()\n    .on('dragstart.node', d => onNodeDragToggle(d))\n    .on('dragend.node', () => onNodeDragToggle())\n\n  viz.collectStats = function () {\n    const latestStats = currentStats\n    latestStats.layout = force.collectStats()\n    currentStats = newStatsBucket()\n    return latestStats\n  }\n// update  就是再进行一遍渲染\n  viz.update = function () {\n    if (!graph) {\n      return\n    }\n    const layers = container\n      .selectAll('g.layer')\n      .data(['relationships', 'nodes'])\n    layers\n      .enter()\n      .append('g')\n      .attr('class', d => `layer ${d}`)\n\n    layers.classed('ctrlClick' , graph.isCtrlClick)\n    const nodes = graph.nodes()\n    const relationships = graph.relationships()\n\n    const relationshipGroups = container\n      .select('g.layer.relationships')\n      .selectAll('g.relationship')\n      .data(relationships, d => d.id)\n      .attr('class',d=>{\n        return d.className\n      })\n\n    relationshipGroups\n      .enter()\n      .append('g')\n      .attr('class', d=>{\n        return d.className\n      })\n      .attr('opacity',node=>{\n        return node.className == 'node-relation_link' ? 0.5 : 1\n       })\n      .on('mousedown', onRelationshipClick)\n      .on('mouseover', onRelMouseOver)\n      .on('mouseout', onRelMouseOut)\n\n    relationshipGroups.classed(\n      {\n        \n      'selected' :\n      relationship => relationship.selected,\n       'relationship' : true,\n       'hide' : \n       rel => rel.display == 'hide'\n      }\n    )\n\n    geometry.onGraphChange(graph)\n    if(graph.initConfig.rightMenu.self){\n      for (var renderer of Array.from(vizRenderers.relationshipSelf)) {\n        relationshipGroups.call(renderer.onGraphChange, viz)\n      }\n\n    }else{\n      for (var renderer of Array.from(vizRenderers.relationship)) {\n        relationshipGroups.call(renderer.onGraphChange, viz)\n      }\n\n    }\n\n    relationshipGroups.exit().remove()\n    const nodeGroups = container\n      .select('g.layer.nodes')\n      .selectAll('g.node')\n      .data(nodes, d => d.id)\n      .attr('class',node=>{\n        return node.className\n      })\n    nodeGroups\n      .enter()\n      .append('g')\n      .attr('class' , node => node.className)\n      .call(force.drag)\n      .call(clickHandler)\n      .on('mouseover', onNodeMouseOver)\n      .on('mouseout', onNodeMouseOut)\n      .append('p')\n      // .on('mouseup', onNodeMouseUp)\n    // 增加选中的className\n    nodeGroups.classed({'selected': node => node.selected , 'ctrlClicked' : node => {\n      return node.ctrlClicked\n    } ,   'hide' : node =>  node.display == 'hide' ,'node' : true})\n\n// 渲染节点\n    if(graph.initConfig.rightMenu.self){\n      for (renderer of Array.from(vizRenderers.nodeSelf)) {\n        nodeGroups.call(renderer.onGraphChange, viz)\n      }\n\n    }else{\n      for (renderer of Array.from(vizRenderers.node)) {\n        nodeGroups.call(renderer.onGraphChange, viz)\n      }\n    }\n// 渲染菜单\n    if(graph.initConfig.leftMenu.show){\n      for (renderer of Array.from(menuRenderer)) {\n        nodeGroups.call(renderer.onGraphChange, viz )\n      }\n    }\n//  渲染右击菜单\n    if(graph.initConfig.rightMenu.show){\n      if(graph.initConfig.rightMenu.self){\n        for(renderer of Array.from(rightMenu1)){\n          nodeGroups.call(renderer.onGraphChange,viz )\n        }\n      }else{\n        for(renderer of Array.from(rightMenu)){\n          nodeGroups.call(renderer.onGraphChange,viz )\n        }\n      }\n    }\n\n    nodeGroups.exit().remove()\n\n    if (updateViz ) {\n      force.update(graph, [layoutDimension, layoutDimension])\n      viz.resize()\n      viz.trigger('updated')\n      }\n    return (updateViz = true)\n  }\n  viz.resize = function () {\n    const size = measureSize()\n    return root.attr(\n      'viewBox',\n      [\n        0,\n        (layoutDimension - size.height) / 2,\n        layoutDimension,\n        size.height\n      ].join(' ')\n    )\n  }\n\n  viz.boundingBox = () => container.node().getBBox()\n  viz.force = force\n\n  var clickHandler = vizClickHandler()\n  clickHandler.on('click', onNodeClick)\n  clickHandler.on('dblclick', onNodeDblClick)\n\n  return viz\n}\n\nexport default vizFn\n","\nimport d3 from 'd3'\n\nconst collision = {\n  avoidOverlap: nodes => {\n    const q = d3.geom.quadtree(nodes)\n    return Array.from(nodes).map(n => q.visit(collide(n)))\n  }\n}\nconst collide = node => {\n  let r = node.radius + 10\n  const nx1 = node.x - r\n  const nx2 = node.x + r\n  const ny1 = node.y - r\n  const ny2 = node.y + r\n  return (quad, x1, y1, x2, y2) => {\n    let l, x, y\n    if (quad.point && quad.point !== node) {\n      x = node.x - quad.point.x\n      y = node.y - quad.point.y\n      l = Math.sqrt(x * x + y * y)\n      r = node.radius + 10 + quad.point.radius\n    }\n    if (l < r) {\n      l = ((l - r) / l) * 0.5\n      node.x -= x *= l\n      node.y -= y *= l\n      quad.point.x += x\n      quad.point.y += y\n    }\n    return x1 > nx2 || x2 < nx1 || y1 > ny2 || y2 < ny1\n  }\n}\n\nexport default collision\n","import d3 from 'd3'\nimport collision from './collision'\nimport circularLayout from '../utils/circularLayout'\nimport cloneArray from '../utils/arrays'\n\nconst layout = {\n  force: () => {\n    return {\n      init: render => {\n        const forceLayout = {}\n\n        const linkDistance = 45\n\n        const d3force = d3.layout\n          .force()\n          .linkDistance(\n            relationship =>\n              relationship.source.radius +\n              relationship.target.radius +\n              linkDistance\n          )\n          .charge(-1000)\n        const newStatsBucket = function () {\n          const bucket = {\n            layoutTime: 0,\n            layoutSteps: 0\n          }\n          return bucket\n        }\n        let currentStats = newStatsBucket()\n\n        forceLayout.collectStats = function () {\n          const latestStats = currentStats\n          currentStats = newStatsBucket()\n          return latestStats\n        }\n\n        const accelerateLayout = function () {\n          let maxStepsPerTick = 100\n          const maxAnimationFramesPerSecond = 60\n          const maxComputeTime = 1000 / maxAnimationFramesPerSecond\n          const now =\n            window.performance && window.performance.now\n              ? () => window.performance.now()\n              : () => Date.now()\n\n          const d3Tick = d3force.tick\n          return (d3force.tick = function () {\n            const startTick = now()\n            let step = maxStepsPerTick\n            while (step-- && now() - startTick < maxComputeTime) {\n              const startCalcs = now()\n              currentStats.layoutSteps++\n\n              collision.avoidOverlap(d3force.nodes())\n\n              if (d3Tick()) {\n                maxStepsPerTick = 2\n                return true\n              }\n              currentStats.layoutTime += now() - startCalcs\n            }\n            render()\n            return false\n          })\n        }\n\n        accelerateLayout()\n\n        const oneRelationshipPerPairOfNodes = graph =>\n          Array.from(graph.groupedRelationships()).map(\n            pair => pair.relationships[0]\n          )\n\n        forceLayout.update = function (graph, size) {\n          let nodes = cloneArray(graph.nodes())\n          const relationships = oneRelationshipPerPairOfNodes(graph)\n          const radius = (nodes.length * linkDistance) / (Math.PI * 2)\n          const center = {\n            x: size[0] / 2,\n            y: size[1] / 2\n          }\n          circularLayout(nodes, center, radius)\n          return d3force\n            .nodes(nodes)\n            .links(relationships)\n            .size(size)\n            .start()\n        }\n\n        forceLayout.drag = d3force.drag\n        forceLayout.on = d3force.on\n        return forceLayout\n      }\n    }\n  }\n}\n\nexport default layout\n","\n\nexport default function cloneArray (original) {\n  const clone = new Array(original.length)\n  for (let idx = 0; idx < original.length; idx++) {\n    const node = original[idx]\n    clone[idx] = node\n  }\n  return clone\n}\n","\nexport default function circularLayout (nodes, center, radius) {\n  const unlocatedNodes = []\n  for (let node of Array.from(nodes)) {\n    if (!(node.x != null && node.y != null)) {\n      unlocatedNodes.push(node)\n    }\n  }\n  return (() => {\n    const result = []\n    for (let i = 0; i < unlocatedNodes.length; i++) {\n      const n = unlocatedNodes[i]\n      n.x =\n        center.x + radius * Math.sin((2 * Math.PI * i) / unlocatedNodes.length)\n      result.push(\n        (n.y =\n          center.y +\n          radius * Math.cos((2 * Math.PI * i) / unlocatedNodes.length))\n      )\n    }\n    return result\n  })()\n}\n","\nimport viz from './visualization'\nimport layout from './layout'\n\nexport default class graphView {\n  constructor (element, measureSize, graph, style) {\n    this.graph = graph\n    this.style = style\n    // 这部分可以用来做布局切换的逻辑\n    const forceLayout = layout.force()\n    this.viz = viz(element, measureSize, this.graph, forceLayout, this.style)\n    this.callbacks = {}\n    const { callbacks } = this\n    this.viz.trigger = (() => (event, ...args) =>\n      Array.from(callbacks[event] || []).map(callback =>\n        callback.apply(null, args)\n      ))()\n  }\n\n  on (event, callback) {\n    ;(this.callbacks[event] != null\n      ? this.callbacks[event]\n      : (this.callbacks[event] = [])\n    ).push(callback)\n    return this\n  }\n\n  layout (value) {\n    if (!arguments.length) {\n      return this.layout\n    }\n    this.layout = value\n    return this\n  }\n\n  grass (value) {\n    if (!arguments.length) {\n      return this.style.toSheet()\n    }\n    this.style.importGrass(value)\n    return this\n  }\n\n  update () {\n    this.viz.update()\n    return this\n  }\n\n  resize () {\n    this.viz.resize()\n    return this\n  }\n\n  boundingBox () {\n    return this.viz.boundingBox()\n  }\n\n  collectStats () {\n    return this.viz.collectStats()\n  }\n\n  zoomIn (elem) {\n    return this.viz.zoomInClick(elem)\n  }\n\n  zoomOut (elem) {\n    return this.viz.zoomOutClick(elem)\n  }\n}\n","import React, { Component } from 'react'\nimport { createGraph, mapRelationships, getGraphStats ,mapNodes } from '../mapper'\nimport { GraphEventHandler } from '../GraphEventHandler'\nimport '../lib/visualization/index'\nimport deepmerge from 'deepmerge'\nimport { downloadPNGFromSVG,gainPngBase64} from \"../../shared/exporting/imageUtils\";\nimport d3 from \"d3\";\n\nimport neoGraphStyle from '../graphStyle'\n\nimport { dim } from './browser-styles'\nimport { StyledZoomHolder, StyledSvgWrapper, StyledZoomButton } from './styled'\n// import { ZoomInIcon, ZoomOutIcon } from 'browser-components/icons/Icons'\nimport graphView from '../lib/visualization/components/graphView'\n\nlet svgElement = null;\nconst deduplicateNodes = nodes => {\n  return nodes.reduce(\n    (all, curr) => {\n      if (all.taken.indexOf(curr.id) > -1) {\n        return all\n      } else {\n        all.nodes.push(curr)\n        all.taken.push(curr.id)\n        return all\n      }\n    },\n    { nodes: [], taken: [] }\n  ).nodes\n}\nexport class GraphComponent extends Component {\n  constructor(props){\n    super(props);\n    const graphStyle = neoGraphStyle();\n    this.defaultStyle = graphStyle.toSheet()\n    if (this.props.graphStyleData) {\n      const rebasedStyle = deepmerge(\n        this.defaultStyle,\n        this.props.graphStyleData\n      )\n      graphStyle.loadRules(rebasedStyle)\n    }\n    this.state = {\n      initGraph : props.initGraphs,\n      stats: { labels: {}, relTypes: {} },\n      graphStyle,\n      zoomInLimitReached: true,\n      zoomOutLimitReached: false,\n      shouldResize: false,\n      nodes : [],\n      relationships : [],\n      graphEH : {},\n      graphView : {},\n      graph : {},\n      svgElement : \"\"\n    }\n    this.onGraphModelChange = this.onGraphModelChange.bind(this);\n  }\n  componentDidMount(){\n    //   console.log(this.props);\n  }\n\n\n  exportPNG () {\n    const graphElement  = this.state.graphView;\n    const type = 'graph';\n    console.log(svgElement,graphElement,type)\n    downloadPNGFromSVG(svgElement, graphElement, type)\n  }\n  gainPngBase64(){\n    const graphElement  = this.state.graphView;\n    const type = 'graph';\n    return gainPngBase64(svgElement, graphElement, type)\n  }\n  graphInit (el) {\n    // 渲染svg图\n    this.svgElement = el;\n    svgElement = el;\n  }\n  // 过滤之后要保留的节点 和 关系\n  retainNodesRel(info){\n    let {nodeMap, relMap} = info;\n    let {graph , graphView} = this.state;\n    let nodeMap1 = graph.nodeMap;\n    let relMap1 = graph.relationshipMap;\n    if(Object.keys(nodeMap).length == 0 && Object.keys(relMap).length == 0 ){\n      graph.resetGraph();\n      graphView.update();\n      return;\n    }\n    let nodes = graph._nodes.map(v=>{\n      return v.id\n    });\n    let rel = graph._relationships.map(v=>{\n      return v.id\n    });\n    nodes.map(id=>{\n      if(!nodeMap.hasOwnProperty(id)){\n        // 移除节点\n        this.graph.removeConnectedRelationships(nodeMap1[id])\n        this.graph.removeNode(nodeMap1[id])\n      }\n    })\n    rel.map(id=>{\n      if(!relMap.hasOwnProperty(relMap1[id])){\n        // 移除关系\n        this.graph.removeRel(relMap1[id]);\n      }\n    })\n    graphView.update()\n  }\n  // 增加节点\n  addNodesRel(info){\n    let {nodes, relationships} = info;\n    let {graph , graphView} = this.state;\n    graph.addNodes(mapNodes(nodes))\n    graph.addRelationships(mapRelationships(relationships, graph))\n    this.onGraphModelChange(getGraphStats(graph))\n    graphView.update()\n  }\n  // 扩展节点\n  extendNodesRel(d,info){\n    let {graph , graphView} = this.state;\n    let {nodes, relationships} = info;\n    graph.addExpandedNodes(d, mapNodes(nodes))\n    graph.addRelationships(mapRelationships(relationships, graph))\n    graph.checkNodeExtendRelToggle();\n\n    graphView.update()\n    this.onGraphModelChange(getGraphStats(graph))\n  }\n  //根据选中的节点生成图 \n  gainRelByNode(arr){\n    if(arr.length == 0) return {nodes : [] , relationships : []}\n    let {graph , graphView} = this.state;\n    return graph.gainRelByNode(arr)\n  }\n  // 重置图形\n  resetGraph(info){\n    let {nodes, relationships} = info;\n    let {graph , graphView , graphEH} = this.state;\n    graph.resetGraph();\n    graphEH.resetEH();\n    graph.addNodes(mapNodes(nodes))\n    graph.addRelationships(mapRelationships(relationships, graph))\n    this.onGraphModelChange(getGraphStats(graph))\n    graphView.update()\n  }\n  // 清空选择\n  clearSelected(){\n    let {graph , graphView , graphEH} = this.state;\n    graph.initSeleced();\n    graphEH.resetEH();\n    graphView.update()\n  }\n  // 隐藏节点\n  toggleByLabels(ds,type){\n    let {graph,graphView} = this.state;\n    if(type == 'node'){\n      graph.toggleNodeBylabels(ds);\n    }else{\n      graph.toggleRelByLabels(ds);\n    }\n    // d3.selectAll('.node').attr({'class' : 'hide node'})\n    // graphView.toggleUpdate()\n    graph.checkNodeExtendRelToggle();\n    graphView.update()\n    this.onGraphModelChange(getGraphStats(graph))\n  }\n  // 移除多个节点\n  removeByLabels(ds , type){\n    let {graph,graphView} = this.state;\n    if(type == 'node'){\n      graph.removeNodeByLabels(ds);\n    }else{\n      graph.removeRelByLabels(ds);\n    }\n    graphView.update()\n    this.onGraphModelChange(getGraphStats(graph))\n  }\n  // 更新节点 关系\n  updateNodesRel(nodes,rels){\n    let {graph,graphView} = this.state;\n    nodes.map(v=>{\n      graph.updateNodeProps(v);\n    })\n    rels.map(v=>{\n      graph.updateRelProps(v)\n    })\n    this.onGraphModelChange(getGraphStats(graph))\n    graphView.update()\n  }\n\n  // 更新某个节点的信息\n  updateOneNode(d){\n    let {graph,graphView} = this.state;\n    graph.updateNodeProps(d);\n    graphView.update()\n  }\n  // 移除单个节点\n  removeNode(d){\n    this.graph.removeConnectedRelationships(d)\n    this.graph.removeNode(d)\n  }\n  // 设置新的图表样式\n  updateStyleNodesRel(arr,type){\n    let {graphStyle ,graphView , graph} = this.state;\n    if(type == 'node' && arr.length > 0){\n      arr.forEach(v=>{\n        graphStyle.changeForSelector(v.selector, v.styleProp)\n      })\n    }\n    const rebasedStyle = deepmerge(this.defaultStyle, graphStyle.toSheet())\n    graphStyle.loadRules(rebasedStyle)\n    this.onGraphModelChange(getGraphStats(graph))\n    graphView.update()\n  }\n  zoomOut(){\n    let {graphView} = this.state;\n    let limits = graphView.zoomOut()\n    return limits;\n  }\n  zoomIn(){\n    let {graphView} = this.state;\n    let limits =  graphView.zoomIn()\n    return limits;\n  }\n  initGraph(info){\n    let {nodes = {},relationships = [] , config} = info;\n    let nodesDetail = deduplicateNodes(nodes)\n    let selectedItem = ''\n    if (nodes.length > parseInt(this.props.initialNodeDisplay)) {\n      nodes = nodes.slice(0, this.props.initialNodeDisplay)\n      relationships = this.props.relationships.filter(item => {\n        return nodes.filter(node => node.id === item.startNodeId) > 0\n      })\n      selectedItem = {\n        type: 'status-item',\n        item: `Not all return nodes are being displayed due to Initial Node Display setting. Only ${\n          this.props.initialNodeDisplay\n        } of ${nodes.length} nodes are being displayed`\n      }\n    }\n    this.initGraphView({nodes : nodesDetail  , relationships , config});\n  }\n  onGraphModelChange(stats){\n    this.setState({ stats: stats });\n    let {graph} = this.state;\n    if(this.props.getStats){\n      let labels = Object.keys(stats.labels);\n      let {graphStyle} = this.state;\n      let relTypes = Object.keys(stats.relTypes);\n      let a1 = [];\n      let a2 = [];\n      a1 = labels.map((v,i)=>{\n        let node = v != '*' && graph?.nodeLabelsMap?.[v] ? graph.nodeMap[graph.nodeLabelsMap[v][0]] : null;\n        let obj = {};\n        if(node && node.display == 'hide'){obj = {filter : true}}\n        let obj1 = {...graphStyle.forNode({\n          labels : [v]\n        }) , label : v ,  ...stats.labels[v] }\n         obj1.props = {...obj1.props, ...obj};\n        return  obj1 })\n      a2 = relTypes.map(v=>{\n        let rel = v != '*' && graph?.relLabelsMap?.[v] ? graph.relationshipMap[graph.relLabelsMap[v][0]] : null;\n        let obj = {};\n        if(rel && rel.display == 'hide'){obj = {filter : true}}\n        let obj1 = {...graphStyle.forRelationship({\n          type : v\n        }  ) , label : v , ...stats.relTypes[v]};\n        obj1.props = {...obj1.props , ...obj}\n        return obj1\n      })\n      this.props.getStats({labels : a1 , relTypes : a2});\n    }\n  }\n  \n\n  getVisualAreaHeight () {\n    return this.props.frameHeight && this.props.fullscreen\n      ? this.props.frameHeight -\n          (dim.frameStatusbarHeight + dim.frameTitlebarHeight * 2)\n      : this.props.frameHeight - dim.frameStatusbarHeight ||\n          this.svgElement.parentNode.offsetHeight\n  }\n  getNodeNeighbours (node, currentNeighbours, callback) {\n    callback(null, { nodes: [], relationships: [] })\n  }\n  \n  initGraphView ({nodes,relationships , config}) {\n    if(config == undefined){\n      config = {\n        rightMenu : {show : true},\n        leftMenu : {show : true}\n      }\n    }\n    if (!this.graphView) {\n      let NeoConstructor = graphView\n      let measureSize = () => {\n        return {\n          width: this.svgElement.offsetWidth,\n          height: this.getVisualAreaHeight()\n        }\n      }\n      this.graph = createGraph(nodes, relationships , config)\n      this.graphView = new NeoConstructor(\n        this.svgElement,\n        measureSize,\n        this.graph,\n        this.state.graphStyle\n      )\n      this.graphEH = new GraphEventHandler(\n        this.graph,\n        this.graphView,\n        this.getNodeNeighbours,\n        this.props.onItemMouseOver,\n        this.props.onItemSelect,\n        this.onGraphModelChange,\n        this.props.onEventListener\n      )\n      this.setState({\n        graphEH : this.graphEH,\n        graph : this.graph ,\n        graphView : this.graphView \n      })\n      this.graphEH.bindEventHandlers()\n      this.onGraphModelChange(getGraphStats(this.graph))\n      this.graphView.resize()\n      this.graphView.update()\n    }\n  }\n\n  render () {\n    return (\n      <StyledSvgWrapper theme={{name : 'normal'}}>\n        {/* 将图实例传递给子组件 */}\n        <svg className='neod3viz'   ref={this.graphInit.bind(this)} />\n      </StyledSvgWrapper>\n    )\n  }\n}\n\n\n\nexport default GraphComponent;","\r\nimport React, { useRef, useState } from \"react\";\r\nimport { DatePicker , Row , Col , Select , Button, message} from 'antd';\r\nimport moment from \"moment\";\r\nimport zhCN from 'antd/es/date-picker/locale/zh_CN';\r\nimport { UploadOutlined } from '@ant-design/icons';\r\nimport _ from \"lodash\"\r\n\r\nconst { RangePicker } = DatePicker;\r\n\r\nconst { Option } = Select;\r\n\r\nconst Header = (props)=> {\r\n    const [time , setTime] = useState([]);  //时间筛选\r\n    const [hasPro , setHasPro] = useState([]); //包含的项目\r\n    const [hasFound , setHasFound] = useState([]); //包含的投资人\r\n    const [allPro , setAllPro] = useState([]); //所有的项目\r\n    const [allFound , setAllFound] = useState([]); //所有的found\r\n    const jsonData = useRef(null);\r\n\r\n    const toGeneralGraph = ()=> {\r\n        // 过滤时间\r\n        let json = _.cloneDeep(jsonData.current);\r\n        if(json && json.length){\r\n             let data = json.filter(item => {\r\n                let {date = '',  found = [],    project = ''} = item;\r\n                let t = true;\r\n                let p = hasPro.length ?  hasPro.includes(project) : true;\r\n                found = found.filter(fName =>hasFound.length ? hasFound.includes(fName) : true);\r\n                item.allFounds = [...item.found];\r\n                item.found = found;\r\n                let f = found.length > 0;\r\n                if(hasFound.length){\r\n                    f = found.length === hasFound.length\r\n                }\r\n                if(time &&  time.length && ( date < time[0] || date> time[1])){\r\n                    t = false\r\n                };\r\n                return t && p && f;\r\n             });\r\n            //  根据过滤后的数据生成 节点和 关系图\r\n             let nodes = [] , relations = [] ;\r\n             for (const item of data) {\r\n                let {date , description , found ,  id ,  project , round} = item;\r\n                let startNode = {} , endNode = {}  ;\r\n                // 根据信息生成节点\r\n                endNode = {\r\n                    id : project,\r\n                    labels : [\"Project\"],\r\n                    className : 'Project',\r\n                    properties : {\r\n                        type : 'project',\r\n                        project,\r\n                        label_for_match: \"Project\",\r\n                        date ,\r\n                        name : project,\r\n                        id,\r\n                        description,\r\n                        round\r\n                    }\r\n                }\r\n                for (const foundItem of found) {\r\n                    startNode = {\r\n                        id : foundItem,\r\n                        labels : ['Person'],\r\n                        className : 'Person',\r\n                        properties : {type : 'fund' ,\r\n                        label_for_match: \"Person\", project , name : foundItem , date } \r\n                    }\r\n                    relations.push({\r\n                             id : `${foundItem}-${project}`,\r\n                             startNodeId : foundItem,\r\n                             endNodeId : project,\r\n                             type : 'fund to project',\r\n                             properties : {\r\n                                 name : `${id}->${project}`\r\n                             }\r\n                    })\r\n                    nodes.push(startNode);\r\n                }\r\n\r\n                nodes.push(endNode);\r\n             }\r\n            //  for (const item of data) {\r\n            //     let {date , description , found ,  id ,  project , round} = item;\r\n            //     if(!nodesMap[project]){\r\n            //         nodesMap[project] = { \r\n            //             id : project ,  \r\n            //             properties : { list : [] , type : 'project' , project , name : project }\r\n            //         }\r\n            //     }\r\n            //     nodesMap[project].properties.list.push({\r\n            //         id ,\r\n            //         date ,\r\n            //         found,\r\n            //         description,\r\n            //         round,\r\n            //     })\r\n            //      for (const foundItem of found) {\r\n            //          if(!nodesMap[foundItem]){\r\n            //             nodesMap[foundItem] = { \r\n            //                 id : foundItem , \r\n            //                 properties : { list : [] , type : 'found' , project , name : foundItem}\r\n            //             }\r\n            //          }\r\n            //          nodesMap[foundItem].properties.list.push({\r\n            //              id  ,\r\n            //              date ,\r\n            //              project,\r\n            //              round,\r\n            //              description\r\n            //          })\r\n            //      }\r\n            //  };\r\n            //  console.log(nodesMap)\r\n            //  for (const key in nodesMap) {\r\n            //      if (Object.hasOwnProperty.call(nodesMap, key)) {\r\n            //          const nodeItem = nodesMap[key];\r\n            //          nodes.push(nodeItem);\r\n            //          let id = nodeItem.id;\r\n            //          let {type ,  project} = nodeItem.properties;\r\n            //          if(type === 'found'){\r\n            //              relations.push({\r\n            //                  id : `${id}-${project}`,\r\n            //                  startNodeId : id,\r\n            //                  endNodeId : project,\r\n            //                  type : 'found to project',\r\n            //                  properties : {\r\n            //                      name : `${id}->${project}`\r\n            //                  }\r\n            //              })\r\n            //          }       \r\n            //      }\r\n            //  }\r\n\r\n             props.onGeneral && props.onGeneral({nodes , relations})\r\n\r\n        }else{\r\n            message.error('请先上传json数据');\r\n        }\r\n    }\r\n\r\n    const onChangeTime = (value)=> {\r\n        if(value && value.length){\r\n            setTime([\r\n                moment(new Date(value[0])).format('YYYY.HH.DD'),\r\n                moment(new Date(value[1])).format('YYYY.HH.DD')\r\n            ])\r\n        }else{\r\n            setTime([])\r\n        }\r\n    }\r\n\r\n    // 选择包含的项目\r\n    const onChangeSelectPro = (value)=>{\r\n        setHasPro(value);\r\n    }\r\n\r\n    // 选择包含的投资人\r\n    const onChangeSelectFound = (value) => {\r\n        setHasFound(value)\r\n    }\r\n\r\n    const onChangeFile = (event)=> {\r\n        var selectedFile = event.target.files[0];//获取读取的File对象\r\n        let {type } = selectedFile;\r\n        if(type  !== 'application/json'){\r\n            message.error('不支持此文件格式!');\r\n            return;\r\n        }\r\n        var reader = new FileReader();//这里是核心！！！读取操作就是由它完成的。\r\n         reader.readAsText(selectedFile);//读取文件的内容\r\n         reader.onload = function(){\r\n             toHandleJson(JSON.parse(this.result));\r\n         };\r\n         \r\n    }\r\n\r\n    const toHandleJson = (json)=>{\r\n        // 生成节点和关系\r\n        let allProject = []  , allFound = [];\r\n        for (const item of json) {\r\n            let {date , description , found ,  id ,  project = '' , round = 0} = item || {};\r\n            allProject.push({\r\n                id : `${id}_${project}`,\r\n                name : project,\r\n                properties : {id , description , date , round }\r\n            });\r\n            allFound = [...new Set([...allFound , ...found])];   \r\n        }\r\n        setAllPro(allProject);\r\n        setAllFound(allFound);\r\n        setHasFound([]);\r\n        setHasPro([allProject[0].name]);\r\n        jsonData.current = json;\r\n    }\r\n    \r\n    return(\r\n        <Row style={{padding : '20px'}}>\r\n            <Col span={4}>\r\n                <Button icon={<UploadOutlined />} className=\"input-button\">\r\n                Upload JSON\r\n                 <input type=\"file\" onChange={onChangeFile} />\r\n                </Button>\r\n            </Col>\r\n            <Col span={4}>\r\n                <RangePicker  locale={zhCN} onChange={onChangeTime}/>\r\n            </Col>\r\n            <Col span={12}>\r\n            <Select\r\n                mode=\"multiple\"\r\n                style={{ width: '40%'  , marginLeft : 10}}\r\n                placeholder=\"project\"\r\n                value={hasPro}\r\n                onChange={onChangeSelectPro}\r\n                optionLabelProp=\"label\"\r\n            >\r\n                {\r\n                    allPro.map(item => (\r\n                        <Option value={item.name} label={item.name} key={item.id}>\r\n                        <div className=\"demo-option-label-item\">\r\n                            {item.name}\r\n                        </div>\r\n                        </Option>\r\n                    ))\r\n                }\r\n            </Select>\r\n            <Select\r\n                mode=\"multiple\"\r\n                style={{ width: '40%' , marginLeft : 15}}\r\n                placeholder=\"fund\"\r\n                value={hasFound}\r\n                onChange={onChangeSelectFound}\r\n                optionLabelProp=\"label\"\r\n            >\r\n                {\r\n                    allFound.map((item,index) => (\r\n                        <Option value={item} label={item} key={`${item}-${index}`}>\r\n                        <div className=\"demo-option-label-item\">\r\n                            {item}\r\n                        </div>\r\n                        </Option>\r\n                    ))\r\n                }\r\n            </Select>\r\n            </Col>\r\n            <Col span=\"2\" offset=\"1\">\r\n                <Button type=\"primary\" onClick={toGeneralGraph}>生成图谱</Button>\r\n            </Col>\r\n        </Row>\r\n    )\r\n}\r\n\r\nexport default React.memo(Header , ()=> true)","import React, { useEffect, useState } from 'react';\nimport { Drawer , Tag} from 'antd';\n\n\nconst Drawers = (props) => {\n    const [visible, setVisible] = useState(props.visible);\n    let {info} = props;\n\n    useEffect(()=>{\n        setVisible(props.visible)\n    },[props.visible])\n  \n    const onClose = () => {\n      setVisible(false);\n      props.onClose && props.onClose()\n    };\n\n    return(\n        <>\n          <Drawer\n            title={<Tag color=\"green\">{info.id}</Tag>}\n            placement=\"right\"\n            closable={false}\n            onClose={onClose}\n            visible={visible}\n          >\n              {\n                  (info.properties || []).map(item => (\n                    item.key !== 'project' && <p key={item.key}><Tag color=\"blue\">{item.key}</Tag> : {item.value || '--'}</p>\n                ))\n              }\n          </Drawer>\n        </>\n    )\n}\n\nexport default Drawers;","import React, {  useRef, useState } from \"react\"\r\nimport D3Force from \"../../libs/react-d3-force/src/D3Visualization/components/Graphs\"\r\nimport Header from \"./Header\"\r\nimport Drawer from \"./Drawer\"\r\nimport  \"./Home.scss\"\r\nimport { Empty } from 'antd';\r\n\r\n\r\n        // d3Force.current.initGraph({\r\n        //     nodes : [\r\n        //         {\r\n        //             id: '1',\r\n        //             labels: ['school'],\r\n        //             properties: {\r\n        //                 name : 'node 1'\r\n        //             }\r\n        //         }\r\n        //     ],\r\n        //     relationships : [\r\n        //         {\r\n        //             id : '3',\r\n        //             startNodeId : '1',\r\n        //             endNodeId : '2',\r\n        //             type : 'rel1',\r\n        //             properties : {\r\n        //                 name : '关系1'\r\n        //             }\r\n        //         },\r\n        //     ]\r\n        // })\r\n\r\nexport default function(){\r\n    const d3Force = useRef(null);\r\n    const isFirst = useRef(null);\r\n    const [show,setShow] = useState(false);\r\n    const [node , setNode] = useState({});\r\n    const [num , setNum] = useState(0);\r\n\r\n    const onItemSelect = (item)=> {\r\n        if(item.type === 'node'){\r\n            setShow(true);\r\n            setNode(item.item)\r\n        }\r\n    }\r\n\r\n    const onClose = ()=> {\r\n        setShow(false)\r\n    }\r\n\r\n    const onGeneral = ({nodes , relations})=>{\r\n        setNum(nodes.length);\r\n        if(!isFirst.current){\r\n            d3Force.current.initGraph({\r\n                nodes,\r\n                relationships : relations\r\n            });\r\n            isFirst.current = true;\r\n        }else{\r\n            d3Force.current.resetGraph({\r\n                nodes,\r\n                relationships : relations\r\n            });\r\n        }\r\n    }\r\n    return(\r\n        <div>\r\n            <Header onGeneral={onGeneral}></Header>\r\n            <Drawer  visible={show} onClose={onClose} info={node}/>\r\n            <div className=\"graph\">\r\n                {num === 0 && (\r\n                    <div className=\"empty\">\r\n                        <Empty  image={Empty.PRESENTED_IMAGE_SIMPLE} />\r\n                    </div>\r\n                )}\r\n                <D3Force  \r\n                    ref={d3Force}\r\n                    getStats={function(){}}\r\n                    onItemMouseOver={function(){}}  \r\n                    onEventListener = { function (){}}\r\n                    onItemSelect={onItemSelect}\r\n                ></D3Force> \r\n            </div>\r\n        </div>\r\n    )\r\n}","import './App.css';\nimport Home from \"./pages/home/Home\"\nimport 'antd/dist/antd.css'; // or 'antd/dist/antd.less'\n\nfunction App() {\n  return (\n    <Home />\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","\nimport parseUrl from 'url-parse'\n// import { DESKTOP, CLOUD, WEB } from '../modules/app/appDuck'\n\n/**\n * The work objects expected shape:\n  {\n    workFn,\n    onSuccess = () => {},\n    onError = () => {},\n    onSkip = () => {}\n  }\n * workFn needs to return either a resolving Promise or a truthy value\n * for the chain to continue\n */\n\nexport const serialExecution = (...args) => {\n  if (!args.length) {\n    return Promise.reject(Error('Nothing to do'))\n  }\n  let out = Promise.resolve()\n  args.forEach(arg => {\n    if (!arg) return\n    arg.prior = out\n    out = linkPromises(arg)\n  })\n  return out\n}\n\nconst linkPromises = next => {\n  if (!next || !next.workFn) {\n    return Promise.reject(Error('Nothing to do'))\n  }\n  if (next && !next.prior) {\n    return Promise.resolve()\n  }\n  return (\n    next.prior\n      // Set `catch` before `then` not to catch it's own rejection\n      // so only following promises catches it\n      .catch(e => {\n        next.onSkip && next.onSkip()\n        return Promise.reject(e) // Continue rejection chain\n      })\n      .then(() => {\n        return new Promise((resolve, reject) => {\n          next.onStart && next.onStart()\n          const res = next.workFn()\n          if (!res) {\n            next.onError && next.onError()\n            return reject(new Error('workFn failed'))\n          }\n          if (res && !res.then) {\n            next.onSuccess && next.onSuccess(res)\n            return resolve(res)\n          }\n          return res\n            .then(r => {\n              next.onSuccess && next.onSuccess(r)\n              resolve(r)\n            })\n            .catch(e => {\n              next.onError && next.onError(e)\n              reject(e)\n            })\n        })\n      })\n  )\n}\n\nexport const deepEquals = (x, y) => {\n  if (x && y && typeof x === 'object' && typeof y === 'object') {\n    if (Object.keys(x).length !== Object.keys(y).length) return false\n    return Object.keys(x).every(key => deepEquals(x[key], y[key]))\n  }\n  return x === y\n}\n\nexport const shallowEquals = (a, b) => {\n  for (let key in a) if (a[key] !== b[key]) return false\n  for (let key in b) if (!(key in a)) return false\n  return true\n}\n\nexport const flatten = arr =>\n  arr.reduce((a, b) => a.concat(Array.isArray(b) ? flatten(b) : b), [])\n\nexport const moveInArray = (fromIndex, toIndex, arr) => {\n  if (!Array.isArray(arr)) return false\n  if (fromIndex < 0 || fromIndex >= arr.length) return false\n  if (toIndex < 0 || toIndex >= arr.length) return false\n  const newArr = [].concat(arr)\n  const el = arr[fromIndex]\n  newArr.splice(fromIndex, 1)\n  newArr.splice(toIndex, 0, el)\n  return newArr\n}\n\nexport const debounce = (fn, time, context = null) => {\n  let pending\n  return (...args) => {\n    if (pending) clearTimeout(pending)\n    pending = setTimeout(\n      () => typeof fn === 'function' && fn.apply(context, args),\n      parseInt(time)\n    )\n  }\n}\n\nexport const throttle = (fn, time, context = null) => {\n  let blocking\n  return (...args) => {\n    if (blocking) return\n    blocking = true\n    typeof fn === 'function' && fn.apply(context, args)\n    setTimeout(() => (blocking = false), parseInt(time))\n  }\n}\n\nexport const firstSuccessPromise = (list, fn) => {\n  return list.reduce((promise, item) => {\n    return promise.catch(() => fn(item)).then(r => Promise.resolve(r))\n  }, Promise.reject(new Error()))\n}\n\nexport const isRoutingHost = host => {\n  return /^bolt\\+routing:\\/\\//.test(host)\n}\n\nexport const toBoltHost = host => {\n  return (\n    'bolt://' +\n    (host || '') // prepend with bolt://\n      .replace(/(.*(?=@+)@|(bolt|bolt\\+routing):\\/\\/)/, '') // remove bolt or bolt+routing protocol and auth info\n  )\n}\n\nexport const hostIsAllowed = (uri, whitelist = null) => {\n  if (whitelist === '*') return true\n  const urlInfo = getUrlInfo(uri)\n  const hostname = urlInfo.hostname\n  const hostnamePlusProtocol = urlInfo.protocol + '//' + hostname\n  const whitelistedHosts =\n    whitelist && whitelist !== ''\n      ? extractWhitelistFromConfigString(whitelist)\n      : []\n  return (\n    whitelistedHosts.indexOf(hostname) > -1 ||\n    whitelistedHosts.indexOf(hostnamePlusProtocol) > -1\n  )\n}\n\nexport const extractWhitelistFromConfigString = str =>\n  str.split(',').map(s => s.trim().replace(/\\/$/, ''))\n\nexport const addProtocolsToUrlList = list => {\n  return list.reduce((all, uri) => {\n    if (!uri || uri === '*') return all\n    const urlInfo = getUrlInfo(uri)\n    if (urlInfo.protocol) return all.concat(uri)\n    return all.concat(['https://' + uri, 'http://' + uri])\n  }, [])\n}\n\nexport const resolveWhitelistWildcard = (list, resolveTo = []) => {\n  return list.reduce((all, entry) => {\n    if (entry && entry.trim() === '*') {\n      entry = resolveTo\n    }\n    return all.concat(entry)\n  }, [])\n}\n\nexport const getUrlInfo = url => {\n  let protocolMissing = false\n\n  // prepend a default protocol, if none was found\n  if (url.match(/^(.+:\\/\\/)?/)[1] === undefined) {\n    url = 'http://' + url\n    protocolMissing = true\n  }\n\n  const {\n    protocol,\n    username,\n    password,\n    host,\n    hostname,\n    port,\n    pathname,\n    query: search,\n    hash\n  } = parseUrl(url, {})\n\n  return {\n    protocol: protocolMissing ? '' : protocol,\n    username,\n    password,\n    host,\n    hostname,\n    port,\n    pathname,\n    search,\n    hash\n  }\n}\n\nexport const getUrlParamValue = (name, url) => {\n  if (!url) return false\n  let out = []\n  const re = new RegExp('[\\\\?&]' + name + '=([^&#]*)', 'g')\n  let results\n  while ((results = re.exec(url)) !== null) {\n    if (results && results[1]) out.push(results[1])\n  }\n  if (!out.length) return undefined\n  return out\n}\n\nexport const toHumanReadableBytes = input => {\n  let number = +input\n  if (!isFinite(number)) {\n    return '-'\n  }\n\n  if (number < 1024) {\n    return `${number} B`\n  }\n\n  number /= 1024\n  let units = ['KiB', 'MiB', 'GiB', 'TiB']\n\n  for (let unit of Array.from(units)) {\n    if (number < 1024) {\n      return `${number.toFixed(2)} ${unit}`\n    }\n    number /= 1024\n  }\n\n  return `${number.toFixed(2)} PiB`\n}\n\nexport const getBrowserName = function () {\n  if (!!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0) {\n    return 'Opera'\n  }\n  if (typeof InstallTrigger !== 'undefined') {\n    return 'Firefox'\n  }\n  if (navigator.userAgent.match(/Version\\/[\\d.]+.*Safari/)) {\n    return 'Safari'\n  }\n  if (window.chrome) {\n    return 'Chrome'\n  }\n  if (document.documentMode) {\n    return 'Internet Explorer'\n  }\n  if (window.StyleMedia) {\n    return 'Edge'\n  }\n  return 'Unknown'\n}\n\nexport const removeComments = (string = '') => {\n  return string\n    .split(/\\r?\\n/)\n    .filter(line => !line.startsWith('//'))\n    .join('\\r\\n')\n}\n\nexport const canUseDOM = () =>\n  !!(\n    typeof window !== 'undefined' &&\n    window.document &&\n    window.document.createElement\n  )\n\nexport const ecsapeCypherMetaItem = str =>\n  /^[A-Za-z][A-Za-z0-9_]*$/.test(str)\n    ? str\n    : '`' + str.replace(/`/g, '``') + '`'\n\nexport const parseTimeMillis = timeWithOrWithoutUnit => {\n  timeWithOrWithoutUnit += '' // cast to string\n  const readUnit = timeWithOrWithoutUnit.match(/\\D+/)\n  const value = parseInt(timeWithOrWithoutUnit)\n\n  const unit = readUnit === undefined || readUnit === null ? 's' : readUnit[0] // Assume seconds\n\n  switch (unit) {\n    case 'ms':\n      return value\n    case 's':\n      return value * 1000\n    case 'm':\n      return value * 60 * 1000\n    default:\n      return 0\n  }\n}\n\nexport const arrayToObject = array =>\n  array.reduce((obj, item) => {\n    const key = Object.keys(item)[0]\n    const value = Object.values(item)[0]\n    obj[key] = value\n    return obj\n  }, {})\n\nexport const stringifyMod = (\n  value,\n  modFn = null,\n  prettyLevel = false,\n  skipOpeningIndentation = false\n) => {\n  prettyLevel = !prettyLevel\n    ? false\n    : prettyLevel === true\n      ? 1\n      : parseInt(prettyLevel)\n  const nextPrettyLevel = prettyLevel ? prettyLevel + 1 : false\n  const newLine = prettyLevel ? '\\n' : ''\n  const indentation =\n    prettyLevel && !skipOpeningIndentation ? Array(prettyLevel).join('  ') : ''\n  const endIndentation = prettyLevel ? Array(prettyLevel).join('  ') : ''\n  const propSpacing = prettyLevel ? ' ' : ''\n  const toString = Object.prototype.toString\n  const isArray =\n    Array.isArray ||\n    function (a) {\n      return toString.call(a) === '[object Array]'\n    }\n  const escMap = {\n    '\"': '\"',\n    '\\\\': '\\\\',\n    '\\b': '\\b',\n    '\\f': '\\f',\n    '\\n': '\\n',\n    '\\r': '\\r',\n    '\\t': '\\t'\n  }\n  const escFunc = function (m) {\n    return (\n      escMap[m] || '\\\\u' + (m.charCodeAt(0) + 0x10000).toString(16).substr(1)\n    )\n  }\n  const escRE = /[\\\\\"\\u0000-\\u001F\\u2028\\u2029]/g // eslint-disable-line no-control-regex\n  if (modFn) {\n    const modVal = modFn && modFn(value)\n    if (typeof modVal !== 'undefined') return indentation + modVal\n  }\n  if (value == null) return indentation + 'null'\n  if (typeof value === 'number') {\n    return indentation + (isFinite(value) ? value.toString() : 'null')\n  }\n  if (typeof value === 'boolean') return indentation + value.toString()\n  if (typeof value === 'object') {\n    if (typeof value.toJSON === 'function') {\n      return stringifyMod(value.toJSON(), modFn, nextPrettyLevel)\n    } else if (isArray(value)) {\n      let hasValues = false\n      let res = ''\n      for (let i = 0; i < value.length; i++) {\n        hasValues = true\n        res +=\n          (i ? ',' : '') +\n          newLine +\n          stringifyMod(value[i], modFn, nextPrettyLevel)\n      }\n      return (\n        indentation +\n        '[' +\n        res +\n        (hasValues ? newLine + endIndentation : '') +\n        ']'\n      )\n    } else if (toString.call(value) === '[object Object]') {\n      let tmp = []\n      for (const k in value) {\n        if (value.hasOwnProperty(k)) {\n          tmp.push(\n            stringifyMod(k, modFn, nextPrettyLevel) +\n              ':' +\n              propSpacing +\n              stringifyMod(value[k], modFn, nextPrettyLevel, true)\n          )\n        }\n      }\n      return (\n        indentation +\n        '{' +\n        newLine +\n        tmp.join(',' + newLine) +\n        newLine +\n        endIndentation +\n        '}'\n      )\n    }\n  }\n  return indentation + '\"' + value.toString().replace(escRE, escFunc) + '\"'\n}\n\nexport const safetlyAddObjectProp = (obj, prop, val) => {\n  obj = escapeReservedProps(obj, prop)\n  obj[prop] = val\n  return obj\n}\n\nexport const safetlyRemoveObjectProp = (obj, prop) => {\n  if (!hasReservedProp(obj, prop)) {\n    return obj\n  }\n  delete obj[prop]\n  obj = unEscapeReservedProps(obj, prop)\n  return obj\n}\n\nexport const escapeReservedProps = (obj, prop) => {\n  if (!hasReservedProp(obj, prop)) {\n    return obj\n  }\n  obj = safetlyAddObjectProp(obj, getEscapedObjectProp(prop), obj[prop])\n  delete obj[prop]\n  return obj\n}\n\nexport const unEscapeReservedProps = (obj, prop) => {\n  let propName = getEscapedObjectProp(prop)\n  if (!hasReservedProp(obj, propName)) {\n    return obj\n  }\n  while (true) {\n    if (!hasReservedProp(obj, propName)) {\n      break\n    }\n    obj[getUnescapedObjectProp(propName)] = obj[propName]\n    delete obj[propName]\n    propName = getEscapedObjectProp(propName)\n  }\n  return obj\n}\n\nconst getEscapedObjectProp = prop => `\\\\${prop}`\nconst getUnescapedObjectProp = prop =>\n  prop.indexOf('\\\\') === 0 ? prop.substr(1) : prop // A bit weird because of escape chars\n\nexport const hasReservedProp = (obj, propName) =>\n  Object.prototype.hasOwnProperty.call(obj, propName)\n\n// Epic helpers\nexport const put = dispatch => action => dispatch(action)\n\nexport const optionalToString = v =>\n  ![null, undefined].includes(v) && typeof v.toString === 'function'\n    ? v.toString()\n    : v\n\nexport const toKeyString = str => btoa(encodeURIComponent(str))\n\nexport const generateBoltHost = host => {\n  const urlParts = (host || '').split('://')\n  const protocol = urlParts.length > 1 ? `${urlParts[0]}://` : 'bolt://'\n  host = urlParts.length > 1 ? urlParts[1] : urlParts[0]\n  return protocol + (host || 'localhost:7687')\n}\n\nexport function flushPromises () {\n  return new Promise(resolve => setImmediate(resolve))\n}\n\nexport async function sleep (ms) {\n  return new Promise(resolve => setTimeout(resolve, ms))\n}\n\n"],"sourceRoot":""}