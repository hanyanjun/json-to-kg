{"version":3,"sources":["libs/react-d3-force/src/shared/services/utils.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/renderer.js","libs/react-d3-force/src/D3Visualization/lib/visualization/renders/init.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/graph.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/node.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/relationship.js","libs/react-d3-force/src/D3Visualization/mapper.js","libs/react-d3-force/src/D3Visualization/GraphEventHandler.js","libs/react-d3-force/src/D3Visualization/lib/visualization/d3-appendSvg.js","libs/react-d3-force/src/shared/exporting/svgUtils.js","libs/react-d3-force/src/shared/exporting/imageUtils.js","libs/react-d3-force/src/D3Visualization/graphStyle.js","libs/react-d3-force/src/shared/services/grassUtils.js","libs/react-d3-force/src/D3Visualization/components/browser-styles.js","libs/react-d3-force/src/D3Visualization/components/styled.jsx","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/textMeasurement.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/loopArrow.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/straightArrow.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/arcArrow.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/pairwiseArcsRelationshipRouting.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/graphGeometry.js","libs/react-d3-force/src/D3Visualization/lib/visualization/renders/icons.js","libs/react-d3-force/src/D3Visualization/lib/visualization/renders/menu.js","libs/react-d3-force/src/D3Visualization/lib/visualization/renders/rightMenu.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/clickHandler.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/visualization.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/collision.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/layout.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/arrays.js","libs/react-d3-force/src/D3Visualization/lib/visualization/utils/circularLayout.js","libs/react-d3-force/src/D3Visualization/lib/visualization/components/graphView.js","libs/react-d3-force/src/D3Visualization/components/Graphs.js","pages/home/Header.js","pages/home/Drawer.js","pages/home/Home.js","pages/block123/index.js","pages/block123/match.js","utils/index.js","pages/time/Header.js","pages/time/Time.js","router/index.js","App.js","reportWebVitals.js","index.js"],"names":["optionalToString","v","undefined","includes","toString","Renderer","opts","onGraphChange","onTick","Object","assign","this","noop","nodeDefs","selection","viz","defs","selectAll","data","node","enter","append","classed","attr","patternContentUnits","id","width","height","exit","remove","nodeOutline","circles","cx","cy","r","radius","fill","isFilter","style","forNode","get","stroke","nodeCaption","text","caption","line","baseline","nodeIcon","nodeRing","insert","nodeRingStrokeSize","arrowPath","name","paths","rel","forRelationship","d","arrow","outline","shortCaptionLength","relationshipBg","texts","midShaftPoint","x","captionLength","captionHeight","y","parseFloat","naturalAngle","relationshipType","captionLayout","shortCaption","relationshipOverlay","rects","overlay","push","nodeSelf","relationship","relationshipSelf","Graph","config","addExpandedNodes","nodes","Array","from","eNode","findNode","nodeMap","_nodes","expandedNodeMap","concat","addNodesLabelsMap","collapseNode","forEach","removeConnectedRelationships","removeNode","addNodes","bind","updateNode","initConfig","resetGraph","addRelationships","addInternalRelationships","pruneInternalRelationships","findNodeNeighbourIds","findRelationship","findAllRelationshipToNode","nodeLabelsMap","relLabelsMap","relationshipMap","_relationships","filterNodeByLabelMap","filterRelByLabelMap","isCtrlClick","groups","nodePair","NodePair","source","target","relationships","result","ignored","pair","values","labels","length","map","display","Set","splice","indexOf","ids","arr","removeNodes","removeRels","rels","removeRel","v1","isPro","init","changeDisplay","type","obj","key","hasOwnProperty","value","expanded","minified","relations","nMap","existingRelationship","addRelLabelsMap","internal","filter","node1","node2","nodeA","nodeB","Node","properties","className","isNode","isRelationship","label_for_match","labelsAll","propertyMap","propertyList","keys","i","graph","Relationship","mapProperties","_","stringifyValues","k","mapNodes","mapRelationships","startNodeId","endNodeId","getGraphStats","labelStats","relTypeStats","label","count","relTypes","GraphEventHandler","graphView","getNodeNeighbours","onItemMouseOver","onItemSelected","onGraphModelChange","onEventListener","selectedItem","rightClickedItem","ctrlClickedArr","rightClickedMap","item","selected","update","isUpdate","rightClicked","nodeCount","relationshipCount","deselectItem","graphModelChanged","fixed","selectItem","layerX","px","layerY","py","ctrlClicked","clearSelected","clearRightSelected","nodeCollapse","contextMenu","hoveredItem","hovered","itemWithMenu","content","menuContent","menuSelection","console","log","on","onNodeMouseOver","onItemMouseOut","onMenuMouseOver","onRelationshipMouseOver","onRelationshipClicked","onCanvasClicked","nodeClose","nodeClicked","nodeDblClicked","nodeUnlock","nodeDelete","nodeNew","nodeEdit","onNodeCtrlClick","onNodeClickRight","onContrarySelected","onClearSelected","onBackStatus","onInitStatus","onStartFrame","onMadeChart","onAddRel","d3","prototype","appendSVG","SVGString","select","appendChild","document","importNode","DOMParser","parseFromString","documentElement","firstChild","prepareForExport","svgElement","graphElement","dimensions","getSvgDimensions","svg","createElementNS","appendPlanLayers","appendGraphLayers","viewBox","view","boundingBox","join","window","each","cloneNode","gainbase64","filename","dataURI","byteString","ia","j","mimeString","ref","split","atob","unescape","Uint8Array","charCodeAt","Blob","htmlCharacterRefToNumericalRef","XMLSerializer","serializeToString","replace","download","mime","blob","FileSaver","saveAs","downloadWithDataURI","neoGraphStyle","defaultStyle","defaultSizes","diameter","defaultIconCodes","defaultArrayWidths","defaultColors","color","Selector","tag1","classes1","tag","classes","StyleRule","selector1","props1","selector","props","matches","classs","matchesExact","StyleElement","applyRules","rules","rule","defaultCaption","GraphStyle","loadRules","_error","parseSelector","tokens","reverse","m","re","out","exec","res","selectorStringToArray","slice","nodeSelector","relationshipSelector","calculateStyle","setDefaultNodeStyling","defaultColor","minimalSelector","sort","changeForSelector","usedColors","index","findAvailableDefaultColor","reduceRight","leading","current","hits","prop","test","getDefaultNodeCaption","findRule","destroyRule","idx","importGrass","string","parse","chars","insideString","insideProps","keyword","c","skipThis","match","val","trim","resetToDefault","toSheet","sheet","str","interpolate","ips","a","b","dim","StyledSvgWrapper","styled","div","theme","themes","normal","svgBackground","dark","getColor","StyledInlineList","ul","StyledInlineListItem","li","StyledToken","secondaryText","secondaryBackground","StyledLabelToken","StyledPickerSelector","span","button","fontFamily","fontSize","font","list","calc","cached","cache","canvasSelection","context","getContext","measureText","measureUsingCanvas","LoopArrow","nodeRadius","straightLength","spreadDegrees","shaftWidth","headWidth","headLength","spread","Math","PI","r1","r2","r3","loopRadius","tan","shaftRadius","shaftLength","Point","normalPoint","sweep","displacement","localLoopRadius","cos","sin","startPoint","endPoint","inner","outer","minWidth","max","StraightArrow","startRadius","endRadius","centreDistance","headHeight","deflection","startArrow","endShaft","endArrow","headRadius","startBreak","endBreak","ArcArrow","endCentre","arrowWidth","square","l","deflectionRadians","startAttach","radiusRatio","homotheticCenter","endAttach","fixedPoint","xCenter","polarity","gradient","hc","A","B","C","intersection","sqrt","intersectWithOtherCircle","g1","c1","g2","arcRadius","startAngle","atan2","endAngle","sweepAngle","midShaftAngle","startTangent","dr","dx","endTangent","dy","angleTangent","angle","endNormal","dc","endOverlayCorner","shoulder","arrowTip","coord","point","positiveSweep","negativeSweep","captionSweep","PairwiseArcsRelationshipRouting","padding","measureRelationshipCaption","captionFitsInsideArrowShaftWidth","isLoop","targetWidth","substr","nodePairs","distance","result1","separation","angles","end","start","biggestGap","result2","groupedRelationships","computeGeometryForNonLoopArrows","distributeAnglesForLoopArrows","middleRelationshipIndex","numberOfSteps","deflectionStep","shortenCaption","NeoD3Geometry","relationshipRouting","fitCaptionIntoCircle","template","setNodeRadii","formatNodeCaptions","formatRelationshipCaptions","measureRelationshipCaptions","layoutRelationships","noEmptyLines","lines","captionText","lineHeight","measure","words","emptyLine","lineCount","iLine","containingHeight","lineWidth","remainingWidth","fitOnFixedNumberOfLines","iWord","asc","word","addShortenedNextWord","consumedWords","maxLines","candidateLines","candidateWords","icons","Unlock","New","Delete","Edit","Remove","arc","itemNumber","innerRadius","outerRadius","padAngle","getSelectedNode","createMenuItem","eventName","position","textValue","helpValue","path","iconPath","tab","rawSvgIcon","event","elems","elem","stopPropagation","trigger","attachContextEvent","transform","floor","centroid","transition","duration","donutRemoveNode","donutExpandNode","donutUnlockNode","donutDeleteNode","donutNewNode","donutEditNode","menu","getRightClickedNode","rec","txt","donutClearNode","donutContraryNode","donutBackStatus","donutInitStatus","donutMadeChart","donutAddRel","rightMenu","rightMenu1","clickHandler","dispatch","rebind","down","wait","__data__","mouse","body","pow","clearTimeout","dblclick","click","setTimeout","vizFn","el","measureSize","layout","root","baseGroup","rect","container","geometry","draw","layoutDimension","updateViz","onNodeDragToggle","onRelationshipClick","onNodeMouseOut","onRelMouseOver","onRelMouseOut","zoomLevel","zoomed","zoomBehavior","translate","scale","behavior","zoom","scaleExtent","interpolateZoom","tween","t","s","isZoomingIn","zoomInClick","zoomClick","zoomOutClick","element","limitsReached","zoomInLimit","zoomOutLimit","Number","toFixed","call","newStatsBucket","bucket","frameCount","relationshipRenderers","timings","vizRenderers","lastFrame","firstFrame","layoutSteps","time","renderers","layoutTime","totalRenderTime","reduce","prev","currentStats","now","performance","Date","force","startRender","nodeGroups","renderer","relationshipGroups","startRenderer","drag","collectStats","latestStats","layers","self","leftMenu","show","menuRenderer","resize","size","getBBox","vizClickHandler","ctrlKey","collision","avoidOverlap","q","geom","quadtree","n","visit","collide","nx1","nx2","ny1","ny2","quad","x1","y1","x2","y2","render","forceLayout","d3force","linkDistance","charge","maxStepsPerTick","d3Tick","tick","startTick","step","startCalcs","accelerateLayout","original","clone","cloneArray","oneRelationshipPerPairOfNodes","center","unlocatedNodes","circularLayout","links","callbacks","args","callback","apply","arguments","GraphComponent","graphStyle","graphStyleData","rebasedStyle","deepmerge","state","initGraph","initGraphs","stats","zoomInLimitReached","zoomOutLimitReached","shouldResize","graphEH","canvas","svgObj","svgData","createElement","canvg","toDataURL","downloadPNGFromSVG","gainPngBase64","info","relMap","nodeMap1","relMap1","checkNodeExtendRelToggle","gainRelByNode","resetEH","initSeleced","ds","toggleNodeBylabels","toggleRelByLabels","removeNodeByLabels","removeRelByLabels","updateNodeProps","updateRelProps","styleProp","zoomOut","zoomIn","nodesDetail","all","curr","taken","deduplicateNodes","parseInt","initialNodeDisplay","initGraphView","setState","getStats","a1","a2","obj1","frameHeight","fullscreen","parentNode","offsetHeight","currentNeighbours","NeoConstructor","createGraph","offsetWidth","getVisualAreaHeight","onItemSelect","bindEventHandlers","graphInit","Component","RangePicker","DatePicker","Option","Select","Header","useState","setTime","hasPro","setHasPro","hasFound","setHasFound","allPro","setAllPro","allFound","setAllFound","jsonData","useRef","toHandleJson","json","allProject","date","description","found","project","round","icon","UploadOutlined","onChange","selectedFile","files","reader","FileReader","readAsText","onload","JSON","message","error","locale","zhCN","moment","format","mode","marginLeft","placeholder","optionLabelProp","offset","onClick","cloneDeep","p","fName","allFounds","f","endNode","startNode","foundItem","onGeneral","React","memo","Drawers","visible","setVisible","useEffect","title","placement","closable","onClose","d3Force","isFirst","setShow","setNode","num","setNum","Drawer","image","Empty","PRESENTED_IMAGE_SIMPLE","Neo4j","require","neo4j","url","username","password","runMatch","dataDetail","records","generalId","substring","random","resultData","nameMap","idMap","myChart","range","setRange","initChart","chartDom","getElementById","echarts","params","filterData","then","toRenderGraph","catch","times","min","timestamp","toGeneralNodeRel","toGeneralTimeLine","timeLine","chartData","option","xAxis","boundaryGap","yAxis","dataZoom","series","smooth","symbol","lineStyle","setOption","initChartLine","Promise","resolve","reject","len","some","iMap","origin","next","exact","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.b9b90049.chunk.js","sourcesContent":["\r\nimport parseUrl from 'url-parse'\r\n// import { DESKTOP, CLOUD, WEB } from '../modules/app/appDuck'\r\n\r\n/**\r\n * The work objects expected shape:\r\n  {\r\n    workFn,\r\n    onSuccess = () => {},\r\n    onError = () => {},\r\n    onSkip = () => {}\r\n  }\r\n * workFn needs to return either a resolving Promise or a truthy value\r\n * for the chain to continue\r\n */\r\n\r\nexport const serialExecution = (...args) => {\r\n  if (!args.length) {\r\n    return Promise.reject(Error('Nothing to do'))\r\n  }\r\n  let out = Promise.resolve()\r\n  args.forEach(arg => {\r\n    if (!arg) return\r\n    arg.prior = out\r\n    out = linkPromises(arg)\r\n  })\r\n  return out\r\n}\r\n\r\nconst linkPromises = next => {\r\n  if (!next || !next.workFn) {\r\n    return Promise.reject(Error('Nothing to do'))\r\n  }\r\n  if (next && !next.prior) {\r\n    return Promise.resolve()\r\n  }\r\n  return (\r\n    next.prior\r\n      // Set `catch` before `then` not to catch it's own rejection\r\n      // so only following promises catches it\r\n      .catch(e => {\r\n        next.onSkip && next.onSkip()\r\n        return Promise.reject(e) // Continue rejection chain\r\n      })\r\n      .then(() => {\r\n        return new Promise((resolve, reject) => {\r\n          next.onStart && next.onStart()\r\n          const res = next.workFn()\r\n          if (!res) {\r\n            next.onError && next.onError()\r\n            return reject(new Error('workFn failed'))\r\n          }\r\n          if (res && !res.then) {\r\n            next.onSuccess && next.onSuccess(res)\r\n            return resolve(res)\r\n          }\r\n          return res\r\n            .then(r => {\r\n              next.onSuccess && next.onSuccess(r)\r\n              resolve(r)\r\n            })\r\n            .catch(e => {\r\n              next.onError && next.onError(e)\r\n              reject(e)\r\n            })\r\n        })\r\n      })\r\n  )\r\n}\r\n\r\nexport const deepEquals = (x, y) => {\r\n  if (x && y && typeof x === 'object' && typeof y === 'object') {\r\n    if (Object.keys(x).length !== Object.keys(y).length) return false\r\n    return Object.keys(x).every(key => deepEquals(x[key], y[key]))\r\n  }\r\n  return x === y\r\n}\r\n\r\nexport const shallowEquals = (a, b) => {\r\n  for (let key in a) if (a[key] !== b[key]) return false\r\n  for (let key in b) if (!(key in a)) return false\r\n  return true\r\n}\r\n\r\nexport const flatten = arr =>\r\n  arr.reduce((a, b) => a.concat(Array.isArray(b) ? flatten(b) : b), [])\r\n\r\nexport const moveInArray = (fromIndex, toIndex, arr) => {\r\n  if (!Array.isArray(arr)) return false\r\n  if (fromIndex < 0 || fromIndex >= arr.length) return false\r\n  if (toIndex < 0 || toIndex >= arr.length) return false\r\n  const newArr = [].concat(arr)\r\n  const el = arr[fromIndex]\r\n  newArr.splice(fromIndex, 1)\r\n  newArr.splice(toIndex, 0, el)\r\n  return newArr\r\n}\r\n\r\nexport const debounce = (fn, time, context = null) => {\r\n  let pending\r\n  return (...args) => {\r\n    if (pending) clearTimeout(pending)\r\n    pending = setTimeout(\r\n      () => typeof fn === 'function' && fn.apply(context, args),\r\n      parseInt(time)\r\n    )\r\n  }\r\n}\r\n\r\nexport const throttle = (fn, time, context = null) => {\r\n  let blocking\r\n  return (...args) => {\r\n    if (blocking) return\r\n    blocking = true\r\n    typeof fn === 'function' && fn.apply(context, args)\r\n    setTimeout(() => (blocking = false), parseInt(time))\r\n  }\r\n}\r\n\r\nexport const firstSuccessPromise = (list, fn) => {\r\n  return list.reduce((promise, item) => {\r\n    return promise.catch(() => fn(item)).then(r => Promise.resolve(r))\r\n  }, Promise.reject(new Error()))\r\n}\r\n\r\nexport const isRoutingHost = host => {\r\n  return /^bolt\\+routing:\\/\\//.test(host)\r\n}\r\n\r\nexport const toBoltHost = host => {\r\n  return (\r\n    'bolt://' +\r\n    (host || '') // prepend with bolt://\r\n      .replace(/(.*(?=@+)@|(bolt|bolt\\+routing):\\/\\/)/, '') // remove bolt or bolt+routing protocol and auth info\r\n  )\r\n}\r\n\r\nexport const hostIsAllowed = (uri, whitelist = null) => {\r\n  if (whitelist === '*') return true\r\n  const urlInfo = getUrlInfo(uri)\r\n  const hostname = urlInfo.hostname\r\n  const hostnamePlusProtocol = urlInfo.protocol + '//' + hostname\r\n  const whitelistedHosts =\r\n    whitelist && whitelist !== ''\r\n      ? extractWhitelistFromConfigString(whitelist)\r\n      : []\r\n  return (\r\n    whitelistedHosts.indexOf(hostname) > -1 ||\r\n    whitelistedHosts.indexOf(hostnamePlusProtocol) > -1\r\n  )\r\n}\r\n\r\nexport const extractWhitelistFromConfigString = str =>\r\n  str.split(',').map(s => s.trim().replace(/\\/$/, ''))\r\n\r\nexport const addProtocolsToUrlList = list => {\r\n  return list.reduce((all, uri) => {\r\n    if (!uri || uri === '*') return all\r\n    const urlInfo = getUrlInfo(uri)\r\n    if (urlInfo.protocol) return all.concat(uri)\r\n    return all.concat(['https://' + uri, 'http://' + uri])\r\n  }, [])\r\n}\r\n\r\nexport const resolveWhitelistWildcard = (list, resolveTo = []) => {\r\n  return list.reduce((all, entry) => {\r\n    if (entry && entry.trim() === '*') {\r\n      entry = resolveTo\r\n    }\r\n    return all.concat(entry)\r\n  }, [])\r\n}\r\n\r\nexport const getUrlInfo = url => {\r\n  let protocolMissing = false\r\n\r\n  // prepend a default protocol, if none was found\r\n  if (url.match(/^(.+:\\/\\/)?/)[1] === undefined) {\r\n    url = 'http://' + url\r\n    protocolMissing = true\r\n  }\r\n\r\n  const {\r\n    protocol,\r\n    username,\r\n    password,\r\n    host,\r\n    hostname,\r\n    port,\r\n    pathname,\r\n    query: search,\r\n    hash\r\n  } = parseUrl(url, {})\r\n\r\n  return {\r\n    protocol: protocolMissing ? '' : protocol,\r\n    username,\r\n    password,\r\n    host,\r\n    hostname,\r\n    port,\r\n    pathname,\r\n    search,\r\n    hash\r\n  }\r\n}\r\n\r\nexport const getUrlParamValue = (name, url) => {\r\n  if (!url) return false\r\n  let out = []\r\n  const re = new RegExp('[\\\\?&]' + name + '=([^&#]*)', 'g')\r\n  let results\r\n  while ((results = re.exec(url)) !== null) {\r\n    if (results && results[1]) out.push(results[1])\r\n  }\r\n  if (!out.length) return undefined\r\n  return out\r\n}\r\n\r\nexport const toHumanReadableBytes = input => {\r\n  let number = +input\r\n  if (!isFinite(number)) {\r\n    return '-'\r\n  }\r\n\r\n  if (number < 1024) {\r\n    return `${number} B`\r\n  }\r\n\r\n  number /= 1024\r\n  let units = ['KiB', 'MiB', 'GiB', 'TiB']\r\n\r\n  for (let unit of Array.from(units)) {\r\n    if (number < 1024) {\r\n      return `${number.toFixed(2)} ${unit}`\r\n    }\r\n    number /= 1024\r\n  }\r\n\r\n  return `${number.toFixed(2)} PiB`\r\n}\r\n\r\nexport const getBrowserName = function () {\r\n  if (!!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0) {\r\n    return 'Opera'\r\n  }\r\n  if (typeof InstallTrigger !== 'undefined') {\r\n    return 'Firefox'\r\n  }\r\n  if (navigator.userAgent.match(/Version\\/[\\d.]+.*Safari/)) {\r\n    return 'Safari'\r\n  }\r\n  if (window.chrome) {\r\n    return 'Chrome'\r\n  }\r\n  if (document.documentMode) {\r\n    return 'Internet Explorer'\r\n  }\r\n  if (window.StyleMedia) {\r\n    return 'Edge'\r\n  }\r\n  return 'Unknown'\r\n}\r\n\r\nexport const removeComments = (string = '') => {\r\n  return string\r\n    .split(/\\r?\\n/)\r\n    .filter(line => !line.startsWith('//'))\r\n    .join('\\r\\n')\r\n}\r\n\r\nexport const canUseDOM = () =>\r\n  !!(\r\n    typeof window !== 'undefined' &&\r\n    window.document &&\r\n    window.document.createElement\r\n  )\r\n\r\nexport const ecsapeCypherMetaItem = str =>\r\n  /^[A-Za-z][A-Za-z0-9_]*$/.test(str)\r\n    ? str\r\n    : '`' + str.replace(/`/g, '``') + '`'\r\n\r\nexport const parseTimeMillis = timeWithOrWithoutUnit => {\r\n  timeWithOrWithoutUnit += '' // cast to string\r\n  const readUnit = timeWithOrWithoutUnit.match(/\\D+/)\r\n  const value = parseInt(timeWithOrWithoutUnit)\r\n\r\n  const unit = readUnit === undefined || readUnit === null ? 's' : readUnit[0] // Assume seconds\r\n\r\n  switch (unit) {\r\n    case 'ms':\r\n      return value\r\n    case 's':\r\n      return value * 1000\r\n    case 'm':\r\n      return value * 60 * 1000\r\n    default:\r\n      return 0\r\n  }\r\n}\r\n\r\nexport const arrayToObject = array =>\r\n  array.reduce((obj, item) => {\r\n    const key = Object.keys(item)[0]\r\n    const value = Object.values(item)[0]\r\n    obj[key] = value\r\n    return obj\r\n  }, {})\r\n\r\nexport const stringifyMod = (\r\n  value,\r\n  modFn = null,\r\n  prettyLevel = false,\r\n  skipOpeningIndentation = false\r\n) => {\r\n  prettyLevel = !prettyLevel\r\n    ? false\r\n    : prettyLevel === true\r\n      ? 1\r\n      : parseInt(prettyLevel)\r\n  const nextPrettyLevel = prettyLevel ? prettyLevel + 1 : false\r\n  const newLine = prettyLevel ? '\\n' : ''\r\n  const indentation =\r\n    prettyLevel && !skipOpeningIndentation ? Array(prettyLevel).join('  ') : ''\r\n  const endIndentation = prettyLevel ? Array(prettyLevel).join('  ') : ''\r\n  const propSpacing = prettyLevel ? ' ' : ''\r\n  const toString = Object.prototype.toString\r\n  const isArray =\r\n    Array.isArray ||\r\n    function (a) {\r\n      return toString.call(a) === '[object Array]'\r\n    }\r\n  const escMap = {\r\n    '\"': '\"',\r\n    '\\\\': '\\\\',\r\n    '\\b': '\\b',\r\n    '\\f': '\\f',\r\n    '\\n': '\\n',\r\n    '\\r': '\\r',\r\n    '\\t': '\\t'\r\n  }\r\n  const escFunc = function (m) {\r\n    return (\r\n      escMap[m] || '\\\\u' + (m.charCodeAt(0) + 0x10000).toString(16).substr(1)\r\n    )\r\n  }\r\n  const escRE = /[\\\\\"\\u0000-\\u001F\\u2028\\u2029]/g // eslint-disable-line no-control-regex\r\n  if (modFn) {\r\n    const modVal = modFn && modFn(value)\r\n    if (typeof modVal !== 'undefined') return indentation + modVal\r\n  }\r\n  if (value == null) return indentation + 'null'\r\n  if (typeof value === 'number') {\r\n    return indentation + (isFinite(value) ? value.toString() : 'null')\r\n  }\r\n  if (typeof value === 'boolean') return indentation + value.toString()\r\n  if (typeof value === 'object') {\r\n    if (typeof value.toJSON === 'function') {\r\n      return stringifyMod(value.toJSON(), modFn, nextPrettyLevel)\r\n    } else if (isArray(value)) {\r\n      let hasValues = false\r\n      let res = ''\r\n      for (let i = 0; i < value.length; i++) {\r\n        hasValues = true\r\n        res +=\r\n          (i ? ',' : '') +\r\n          newLine +\r\n          stringifyMod(value[i], modFn, nextPrettyLevel)\r\n      }\r\n      return (\r\n        indentation +\r\n        '[' +\r\n        res +\r\n        (hasValues ? newLine + endIndentation : '') +\r\n        ']'\r\n      )\r\n    } else if (toString.call(value) === '[object Object]') {\r\n      let tmp = []\r\n      for (const k in value) {\r\n        if (value.hasOwnProperty(k)) {\r\n          tmp.push(\r\n            stringifyMod(k, modFn, nextPrettyLevel) +\r\n              ':' +\r\n              propSpacing +\r\n              stringifyMod(value[k], modFn, nextPrettyLevel, true)\r\n          )\r\n        }\r\n      }\r\n      return (\r\n        indentation +\r\n        '{' +\r\n        newLine +\r\n        tmp.join(',' + newLine) +\r\n        newLine +\r\n        endIndentation +\r\n        '}'\r\n      )\r\n    }\r\n  }\r\n  return indentation + '\"' + value.toString().replace(escRE, escFunc) + '\"'\r\n}\r\n\r\nexport const safetlyAddObjectProp = (obj, prop, val) => {\r\n  obj = escapeReservedProps(obj, prop)\r\n  obj[prop] = val\r\n  return obj\r\n}\r\n\r\nexport const safetlyRemoveObjectProp = (obj, prop) => {\r\n  if (!hasReservedProp(obj, prop)) {\r\n    return obj\r\n  }\r\n  delete obj[prop]\r\n  obj = unEscapeReservedProps(obj, prop)\r\n  return obj\r\n}\r\n\r\nexport const escapeReservedProps = (obj, prop) => {\r\n  if (!hasReservedProp(obj, prop)) {\r\n    return obj\r\n  }\r\n  obj = safetlyAddObjectProp(obj, getEscapedObjectProp(prop), obj[prop])\r\n  delete obj[prop]\r\n  return obj\r\n}\r\n\r\nexport const unEscapeReservedProps = (obj, prop) => {\r\n  let propName = getEscapedObjectProp(prop)\r\n  if (!hasReservedProp(obj, propName)) {\r\n    return obj\r\n  }\r\n  while (true) {\r\n    if (!hasReservedProp(obj, propName)) {\r\n      break\r\n    }\r\n    obj[getUnescapedObjectProp(propName)] = obj[propName]\r\n    delete obj[propName]\r\n    propName = getEscapedObjectProp(propName)\r\n  }\r\n  return obj\r\n}\r\n\r\nconst getEscapedObjectProp = prop => `\\\\${prop}`\r\nconst getUnescapedObjectProp = prop =>\r\n  prop.indexOf('\\\\') === 0 ? prop.substr(1) : prop // A bit weird because of escape chars\r\n\r\nexport const hasReservedProp = (obj, propName) =>\r\n  Object.prototype.hasOwnProperty.call(obj, propName)\r\n\r\n// Epic helpers\r\nexport const put = dispatch => action => dispatch(action)\r\n\r\nexport const optionalToString = v =>\r\n  ![null, undefined].includes(v) && typeof v.toString === 'function'\r\n    ? v.toString()\r\n    : v\r\n\r\nexport const toKeyString = str => btoa(encodeURIComponent(str))\r\n\r\nexport const generateBoltHost = host => {\r\n  const urlParts = (host || '').split('://')\r\n  const protocol = urlParts.length > 1 ? `${urlParts[0]}://` : 'bolt://'\r\n  host = urlParts.length > 1 ? urlParts[1] : urlParts[0]\r\n  return protocol + (host || 'localhost:7687')\r\n}\r\n\r\nexport function flushPromises () {\r\n  return new Promise(resolve => setImmediate(resolve))\r\n}\r\n\r\nexport async function sleep (ms) {\r\n  return new Promise(resolve => setTimeout(resolve, ms))\r\n}\r\n\r\n","\r\nexport default class Renderer {\r\n  onGraphChange = null\r\n  onTick = null\r\n  constructor (opts) {\r\n    if (opts == null) {\r\n      opts = {}\r\n    }\r\n    Object.assign(this, opts)\r\n    if (this.onGraphChange === null) {\r\n      this.onGraphChange = function () {}\r\n    }\r\n    if (this.onTick === null) {\r\n      this.onTick = function () {}\r\n    }\r\n  }\r\n}\r\n","import Renderer from '../components/renderer'\r\nconst noop = function () {}\r\n\r\nconst nodeRingStrokeSize = 8\r\n\r\n// 图片\r\nconst nodeDefs = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    const defs = selection.selectAll('defs.img').data(node => [node])\r\n    \r\n    defs.enter().append('defs').append('pattern').classed('pattern', true).attr({\r\n      patternContentUnits: 'objectBoundingBox',\r\n      id: 'avatar',\r\n      width: '100%',\r\n      height: '100%'\r\n    }).append('image').attr({\r\n      'height': 1,\r\n      'width': 1,\r\n      // 'xlink:href':'http://'\r\n      // 加了此处图片导出出错 后续跟进  TODO\r\n      'xlink:href': 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAEjklEQVR4nO3c2UrrUBTG8b9SpWLF4nHAEfXeN1BUFOcBRUUfwu74JDYd0Lb4SqWt4oBeOqB3ouKVei48nGOPTZudbjtlr8uma6/w40sCSUhdLBb74Acqk8kQi8WUrTc9Pc3a2ppUz9HREclkUsl8r9eLYRj09/dn/V6vZPX/yi148AOAbsIDxYBuwwPwKJlE7eE1NTUhhMiLB4oS6FY8UJDAdDpNPB4vdpm/NTMzw+rqqlRPufCgyAS6HQ+KSGAl4CUSCVKplJL5TU1NGIZBX1+f7Z6rqytnCdR4n3jhcFg+gRrvEy8UCvH29iaXQI2XjQcSFxGN9x0PbF5Eag2vubmZQCBQNB7YAEylUiQSCfm9tKjZ2VlWVlakesqNd3l5STgc/oYHBQ5hjZcfD/IksBLw4vE46XRayfzm5maEEPT29truKYQHFgnUePbwIEcCNd4nXigU4v39veB/sxKo8eTw4AugxpPHgz+HcK3h+Xw+AoHAj+MBeJLJJEdHR7L7aFluwgOo83g8yh5rzs3Nsby8LNVTbryLiwsikYgjPFD4UMmNeKDooZITvFgsRiaTUTEen8+HEIKenh7bPSrwQEEC3YwHRSawWvHC4TAfH2pO/Y4TqPFgdHTUGaDG+8Tb2dmRB9R4//BA8hw4Pz/P0tKS1LBy452fnxOJRH4EDyQANR6MjY2xvb2d9ZstQCd4h4eHHB8fS/VYlc/nwzAMuru7bfeUAg9sXIU1njUeFEhgufFaWloQQkjjhcNhJfMhPx7kSaDGK4z3+vqaO4HViHd2dkYkElEyH2B8fJytrS3L7a+vr5im+R1Q49nDCwaDXF9fZx/CGk8OD75cRBYWFlhcXJQa5nY8+APoBO/g4ICTkxOHu5pd1YoH4KkEvL29Pbq6umz3lBrv5eWFUCj0DQ+gXuM5xwPJmwkq8VpbWxFCVDUeSACWG+/09JRoNKpkPqjBA5uAtYY3MTHB5uam5faXlxdM0+Tm5qbgWgUBo9Eop6encntoUa2trRiGQWdnp+2eSsaDAndjNF7hsgTUePYqJ6DGs1/fzoFuw3t+fiYUCjnCg/8AVeL5/X6EEDWNB18OYY3nrDxQfryTkxMODg6UzAeYnJxkY2PDcrsqPIC6kZGRj7Ozs6IXgurBM02T29tbJfOUvWDp9/sxDIOOjg7bPdWONzAwoOYFS7fiCSGKB3QzntfrLQ7Q7XhQxAuWbsQbHBxkd3f3Lx44fMFS4/0r6QQ6wTs+Pubw8FB2lGVNTU2xvr5uub1UeCAJWC14wWCQu7s7JfMGBwcRQtDY2Jhzu21Av9/P3t4e7e3ttofXOh7YBKwGvKenJ0zTVIY3NDREIBDIiwc2LiIaL3/lBdR4hcsSUOPZq5znwLa2NoQQFY+3v7/P/f29knlO8CBHAjWeXGUl0Aleqb9eWUl48AXQrXhCCBoaGhyv4YFPPMMw+PXrl+3GUuM9Pj5immZF4QF43Ig3PDxMIBAoGg+gXuMVVx4ZPNWfwat2PJC4mVAOvGAwyMPDg5J5P4EHNm+oajzrKpjAUn+9sprwAH4DZmdcmtPQSQAAAAAASUVORK5CYII='\r\n    });\r\n\r\n    return defs.exit().remove()\r\n  },\r\n  onTick: noop\r\n})\r\n\r\nconst nodeOutline = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    const circles = selection.selectAll('circle.outline').data(node => [node])\r\n    circles\r\n      .enter()\r\n      .append('circle')\r\n      .classed('outline', true)\r\n      .attr({\r\n        cx: 0,\r\n        cy: 0\r\n      })\r\n    circles.attr({\r\n      r (node) {\r\n        return node.radius\r\n      },\r\n      fill (node) {\r\n        if(node.isFilter){\r\n          return 'url(#avatar)';\r\n        }\r\n        // if(/[frame|rootNode1|rootNode2]/.test(node.className)){\r\n          // return `url(#avatar)`\r\n        // }\r\n        return viz.style.forNode(node).get('color')\r\n      },\r\n      stroke (node) {\r\n        return viz.style.forNode(node).get('border-color')\r\n      },\r\n      'stroke-width' (node) {\r\n        return viz.style.forNode(node).get('border-width')\r\n      }\r\n    })\r\n\r\n    return circles.exit().remove()\r\n  },\r\n  onTick: noop\r\n})\r\n\r\nconst nodeCaption = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    const text = selection.selectAll('text.caption').data(node => node.caption)\r\n\r\n    text\r\n      .enter()\r\n      .append('text')\r\n      .classed('caption', true)\r\n      .attr({ 'text-anchor': 'middle' })\r\n      .attr({ 'pointer-events': 'none' })\r\n    \r\n    text\r\n      .text(line => {\r\n        // console.log(line);\r\n        // /[frame|rootNode1|rootNode2]/.test(line.node.className) ? '' : line.text\r\n        return line.text\r\n      })\r\n      .attr('y', line => line.baseline)\r\n      .attr('font-size', line => viz.style.forNode(line.node).get('font-size'))\r\n      .attr({\r\n        fill (line) {\r\n          return viz.style.forNode(line.node).get('text-color-internal')\r\n        }\r\n      })\r\n      // console.log(text);\r\n    return text.exit().remove()\r\n  },\r\n\r\n  onTick: noop\r\n})\r\n\r\nconst nodeIcon = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    const text = selection.selectAll('g').data(node => node.caption)\r\n    text\r\n      .enter()\r\n      .append('text')\r\n      .attr({ 'text-anchor': 'middle' })\r\n      .attr({ 'pointer-events': 'none' })\r\n      .attr({ 'font-family': 'streamline' })\r\n\r\n    text\r\n      .text(line => viz.style.forNode(line.node).get('icon-code'))\r\n      .attr('dy', line => line.node.radius / 16)\r\n      .attr('font-size', line => line.node.radius)\r\n      .attr({\r\n        fill (line) {\r\n          return viz.style.forNode(line.node).get('text-color-internal')\r\n        }\r\n      })\r\n\r\n    return text.exit().remove()\r\n  },\r\n\r\n  onTick: noop\r\n})\r\n\r\nconst nodeRing = new Renderer({\r\n  onGraphChange (selection) {\r\n    const circles = selection.selectAll('circle.ring').data(node => [node])\r\n    circles\r\n      .enter()\r\n      .insert('circle', '.outline')\r\n      .classed('ring', true)\r\n      .attr({\r\n        cx: 0,\r\n        cy: 0,\r\n        'stroke-width': nodeRingStrokeSize + 'px'\r\n      })\r\n\r\n    circles.attr({\r\n      r (node) {\r\n        return node.radius + 4\r\n      }\r\n    })\r\n\r\n    return circles.exit().remove()\r\n  },\r\n\r\n  onTick: noop\r\n})\r\n\r\nconst arrowPath = new Renderer({\r\n  name: 'arrowPath',\r\n  onGraphChange (selection, viz) {\r\n    const paths = selection.selectAll('path.outline').data(rel => [rel])\r\n\r\n    paths\r\n      .enter()\r\n      .append('path')\r\n      .classed('outline', true)\r\n\r\n    paths\r\n      .attr('fill', rel => viz.style.forRelationship(rel).get('color'))\r\n      .attr('stroke', 'none')\r\n\r\n    return paths.exit().remove()\r\n  },\r\n\r\n  onTick (selection) {\r\n    return selection\r\n      .selectAll('path')\r\n      .attr('d', d => d.arrow.outline(d.shortCaptionLength))\r\n  }\r\n})\r\n\r\n\r\n\r\n\r\n\r\nconst relationshipBg = new Renderer({\r\n  name: 'relationshipBg',\r\n  onGraphChange (selection, viz) {\r\n    const texts = selection.selectAll('rect').data(rel => [rel])\r\n\r\n    texts\r\n      .enter()\r\n      .append('rect')\r\n    return texts.exit().remove()\r\n  },\r\n\r\n  onTick (selection, viz) {\r\n    return selection\r\n      .selectAll('rect')\r\n      .attr('x', rel => rel.arrow.midShaftPoint.x - rel.captionLength/2)\r\n      .attr('width', rel => rel.captionLength)\r\n      .attr('height', rel => rel.captionHeight+5)\r\n      .attr('fill' ,   rel => {\r\n        if(rel.isFilter){\r\n          return 'url(#avatar)'\r\n        }\r\n        return 'none'\r\n      } )\r\n      .attr(\r\n        'y',\r\n        rel =>\r\n          rel.arrow.midShaftPoint.y +\r\n          parseFloat(viz.style.forRelationship(rel).get('font-size')) / 2 -\r\n          1 - (rel.captionHeight+10)/2\r\n      )\r\n      .attr('transform', function (rel) {\r\n        if (rel.naturalAngle < 90 || rel.naturalAngle > 270) {\r\n          return `rotate(180 ${rel.arrow.midShaftPoint.x} ${\r\n            rel.arrow.midShaftPoint.y\r\n          })`\r\n        } else {\r\n          return null\r\n        }\r\n      })\r\n  }\r\n})\r\n\r\n\r\n\r\n// 增加文字的text\r\nconst relationshipType = new Renderer({\r\n  name: 'relationshipType',\r\n  onGraphChange (selection, viz) {\r\n    const texts = selection.selectAll('text').data(rel => [rel])\r\n\r\n    texts\r\n      .enter()\r\n      .append('text')\r\n      .attr({ 'text-anchor': 'middle' })\r\n      .attr({ 'pointer-events': 'none'  })\r\n\r\n    texts\r\n      .attr('font-size', rel => viz.style.forRelationship(rel).get('font-size'))\r\n      .attr('fill', rel =>{\r\n        if(rel.isFilter){\r\n          return 'white'\r\n        }\r\n          return viz.style.forRelationship(rel).get(`text-color-${rel.captionLayout}`)\r\n        }\r\n      )\r\n\r\n    return texts.exit().remove()\r\n  },\r\n\r\n  onTick (selection, viz) {\r\n    return selection\r\n      .selectAll('text')\r\n      .attr('x', rel => rel.arrow.midShaftPoint.x)\r\n      .attr(\r\n        'y',\r\n        rel =>\r\n          rel.arrow.midShaftPoint.y +\r\n          parseFloat(viz.style.forRelationship(rel).get('font-size')) / 2 -\r\n          1\r\n      )\r\n      .attr('transform', function (rel) {\r\n        if (rel.naturalAngle < 90 || rel.naturalAngle > 270) {\r\n          return `rotate(180 ${rel.arrow.midShaftPoint.x} ${\r\n            rel.arrow.midShaftPoint.y\r\n          })`\r\n        } else {\r\n          return null\r\n        }\r\n      })\r\n      .text(rel => rel.shortCaption)\r\n  }\r\n})\r\n\r\nconst relationshipOverlay = new Renderer({\r\n  name: 'relationshipOverlay',\r\n  onGraphChange (selection) {\r\n    const rects = selection.selectAll('path.overlay').data(rel => [rel])\r\n\r\n    rects\r\n      .enter()\r\n      .append('path')\r\n      .classed('overlay', true)\r\n\r\n    return rects.exit().remove()\r\n  },\r\n\r\n  onTick (selection) {\r\n    const band = 16\r\n\r\n    return selection\r\n      .selectAll('path.overlay')\r\n      .attr('d', d => d.arrow.overlay(band))\r\n  }\r\n})\r\n\r\nconst node = []\r\nnode.push(nodeOutline)\r\nnode.push(nodeIcon)\r\nnode.push(nodeCaption)\r\nnode.push(nodeRing)\r\nnode.push(nodeDefs)\r\nconst nodeSelf = [];\r\nnodeSelf.push(nodeOutline)\r\nnodeSelf.push(nodeIcon)\r\nnodeSelf.push(nodeCaption)\r\nnodeSelf.push(nodeRing)\r\n\r\nconst relationship = []\r\nrelationship.push(arrowPath)\r\nrelationship.push(relationshipBg)\r\nrelationship.push(relationshipType)\r\nrelationship.push(nodeDefs)\r\nrelationship.push(relationshipOverlay)\r\n// relationship.push(relOutline)\r\n\r\nconst relationshipSelf = [];\r\nrelationshipSelf.push(arrowPath)\r\nrelationshipSelf.push(relationshipBg)\r\nrelationshipSelf.push(relationshipType)\r\nrelationshipSelf.push(relationshipOverlay)\r\n// relationshipSelf.push(relOutline)\r\n\r\n\r\n\r\nexport { node, relationship , nodeSelf , relationshipSelf }\r\n","import { relationship } from \"../renders/init\";\r\n\r\nexport default class Graph {\r\n  constructor (config) {\r\n    this.addNodes = this.addNodes.bind(this)\r\n    this.removeNode = this.removeNode.bind(this)\r\n    this.updateNode = this.updateNode.bind(this)\r\n    this.removeConnectedRelationships = this.removeConnectedRelationships.bind(\r\n      this\r\n    )\r\n    this.initConfig = config;\r\n    this.resetGraph = this.resetGraph.bind(this);\r\n    this.addRelationships = this.addRelationships.bind(this)\r\n    this.addInternalRelationships = this.addInternalRelationships.bind(this)\r\n    this.pruneInternalRelationships = this.pruneInternalRelationships.bind(this)\r\n    this.findNode = this.findNode.bind(this)\r\n    this.findNodeNeighbourIds = this.findNodeNeighbourIds.bind(this)\r\n    this.findRelationship = this.findRelationship.bind(this)\r\n    this.findAllRelationshipToNode = this.findAllRelationshipToNode.bind(this)\r\n    this.nodeMap = {}\r\n    this.nodeLabelsMap = {};\r\n    this.relLabelsMap = {};\r\n    this.expandedNodeMap = {}\r\n    this._nodes = []\r\n    this.relationshipMap = {}\r\n    this._relationships = []\r\n    this.filterNodeByLabelMap = {}\r\n    this.filterRelByLabelMap = {}\r\n    this.isCtrlClick = false\r\n  }\r\n\r\n  nodes () {\r\n    return this._nodes\r\n  }\r\n\r\n  relationships () {\r\n    return this._relationships\r\n  }\r\n\r\n  groupedRelationships () {\r\n    const groups = {}\r\n    for (let relationship of Array.from(this._relationships)) {\r\n      let nodePair = new NodePair(relationship.source, relationship.target)\r\n      nodePair = groups[nodePair] != null ? groups[nodePair] : nodePair\r\n      nodePair.relationships.push(relationship)\r\n      groups[nodePair] = nodePair\r\n    }\r\n    return (() => {\r\n      const result = []\r\n      for (let ignored in groups) {\r\n        const pair = groups[ignored]\r\n        result.push(pair)\r\n      }\r\n      return result\r\n    })()\r\n  }\r\n\r\n  addNodes (nodes) {\r\n    for (let node of Array.from(nodes)) {\r\n      if (this.findNode(node.id) == null) {\r\n        this.nodeMap[node.id] = node\r\n        this._nodes = Object.values(this.nodeMap)\r\n      }\r\n      this.addNodesLabelsMap(node);\r\n      \r\n    }\r\n    return this\r\n  }\r\n  addNodesLabelsMap(node){\r\n    if(node.labels.length > 0){\r\n       node.labels.map(v=>{\r\n          if(!this.nodeLabelsMap[v]){\r\n            this.nodeLabelsMap[v] = [];\r\n          }\r\n          // 增加的新的节点 如果label 为过滤则不显示\r\n          if(this.filterNodeByLabelMap[v]){\r\n            node.display = 'hide'\r\n          }\r\n          this.nodeLabelsMap[v].push(node.id);\r\n          this.nodeLabelsMap[v] = [...new Set (this.nodeLabelsMap[v])];\r\n       })\r\n    }\r\n    return this;\r\n  }\r\n  addExpandedNodes = (node, nodes) => {\r\n    for (let eNode of Array.from(nodes)) {\r\n      if (this.findNode(eNode.id) == null) {\r\n        this.nodeMap[eNode.id] = eNode\r\n        this._nodes.push(eNode)\r\n        this.expandedNodeMap[node.id] = this.expandedNodeMap[node.id]\r\n          ? this.expandedNodeMap[node.id].concat([eNode.id])\r\n          : [eNode.id]\r\n      }\r\n      this.addNodesLabelsMap(eNode);\r\n    }\r\n  }\r\n\r\n  removeNode (node) {\r\n    if (this.findNode(node.id) != null) {\r\n      delete this.nodeMap[node.id]\r\n      this._nodes.splice(this._nodes.indexOf(node), 1)\r\n    }\r\n    return this\r\n  }\r\n  removeNodes (nodes,ids){\r\n    if(ids){\r\n      ids.map(v=>{\r\n        if(this.nodeMap[v]){\r\n          this.removeConnectedRelationships(this.nodeMap[v]);\r\n          this.removeNode(this.nodeMap[v]);\r\n        }\r\n      })\r\n    }else{\r\n      nodes.map(v=>{\r\n        this.removeNode(v);\r\n      })\r\n    }\r\n  }\r\n  removeNodeByLabels(labels){\r\n    let arr = [];\r\n    labels.forEach(v=>{\r\n      arr = arr.concat(this.nodeLabelsMap[v]);\r\n      delete this.nodeLabelsMap[v];\r\n    })\r\n    this.removeNodes(null,[...new Set(arr)]);\r\n  }\r\n  removeRelByLabels(labels){\r\n    let arr = [];\r\n    labels.forEach(v=>{\r\n      arr = arr.concat(this.relLabelsMap[v]);\r\n      delete this.relLabelsMap[v];\r\n    })\r\n    this.removeRels(null,[...new Set(arr)]);\r\n  }\r\n  removeRels(rels,ids){\r\n    if(ids){\r\n      ids.map(v=>{\r\n        if(this.relationshipMap[v]){\r\n          this.removeRel(this.relationshipMap[v]);\r\n        }\r\n      })\r\n    }\r\n  }\r\n  toggleNodeBylabels(labels){\r\n    let nodes  = Object.values(this.nodeMap);\r\n    labels.forEach(v1=>{\r\n      if(!this.isPro(this.filterNodeByLabelMap,v1)){\r\n        this.filterNodeByLabelMap[v1] = true;\r\n      }else{\r\n        this.filterNodeByLabelMap[v1] = !this.filterNodeByLabelMap;\r\n      }\r\n      nodes.forEach(v=>{\r\n        let init = v.display;\r\n            if(v.labels.indexOf(v1) != -1){\r\n              v.display = this.changeDisplay(init);\r\n            }\r\n        this.nodeMap[v.id] = v;\r\n      })\r\n    })\r\n    this._nodes = Object.values(nodes)\r\n    return this\r\n  }\r\n  checkNodeExtendRelToggle(){\r\n    let rels = Object.values(this.relationshipMap);\r\n    rels.forEach(r=>{\r\n      if(r.target.display == 'hide' || r.source.display == 'hide' || this.filterRelByLabelMap[r.type]){\r\n        r.display = 'hide';\r\n      }else {\r\n         if(!this.filterRelByLabelMap[r.type]){\r\n             r.display = 'show';\r\n         }\r\n      }\r\n      this.relationshipMap[r.id]  = r\r\n      this._relationships.splice(this._relationships.indexOf(r),1,r);\r\n    })\r\n  }\r\n  isPro(obj,key){\r\n    return obj.hasOwnProperty(key);\r\n  }\r\n  changeDisplay(value){\r\n    if(value == 'unvalue'){\r\n      return 'hide';\r\n    }\r\n    if(value == 'show'){\r\n      return 'hide'\r\n    }\r\n    if(value = 'hide'){\r\n      return 'show'\r\n    }\r\n  }\r\n  toggleRelByLabels(labels){\r\n    let rels = Object.values(this.relationshipMap);\r\n    labels.forEach(v1=>{\r\n      if(!this.isPro(this.filterRelByLabelMap,v1)){\r\n        this.filterRelByLabelMap[v1] = true;\r\n      }else{\r\n        this.filterRelByLabelMap[v1] = !this.filterRelByLabelMap[v1];\r\n      }\r\n      rels.forEach(v=>{\r\n            let init = this.changeDisplay(v.display);\r\n            if(v.type == v1){\r\n              v.display = init;\r\n              this.relationshipMap[v.id] = v;\r\n              this._relationships.splice(this._relationships.indexOf(v),1,v);\r\n            }\r\n      })\r\n    })\r\n  }\r\n  removeRel(rel){\r\n    if( rel && this.relationshipMap[rel.id] ){\r\n      delete this.relationshipMap[rel.id];\r\n      this._relationships.splice(this._relationships.indexOf(rel), 1);\r\n    }\r\n    return this\r\n  }\r\n  collapseNode = node => {\r\n    if (!this.expandedNodeMap[node.id]) {\r\n      return\r\n    }\r\n    this.expandedNodeMap[node.id].forEach(id => {\r\n      const eNode = this.nodeMap[id]\r\n      this.collapseNode(eNode)\r\n      this.removeConnectedRelationships(eNode)\r\n      this.removeNode(eNode)\r\n    })\r\n    this.expandedNodeMap[node.id] = []\r\n  }\r\n\r\n  updateNode (node) {\r\n    if (this.findNode(node.id) != null) {\r\n      this.removeNode(node)\r\n      node.expanded = false\r\n      node.minified = true\r\n      this.addNodes([node])\r\n    }\r\n    return this\r\n  }\r\n  updateNodeProps(node){\r\n    if (this.findNode(node.id) != null) {\r\n      this.nodeMap[node.id] = Object.assign(this.nodeMap[node.id] , node)\r\n      this._nodes.splice(this._nodes.indexOf(node), this.nodeMap[node.id])\r\n    }\r\n    return this\r\n  }\r\n  updateRelProps(relationship){\r\n    if(this.relationshipMap[relationship.id] != null){\r\n      this.relationshipMap[relationship.id] = Object.assign(this.relationshipMap[relationship.id] , relationship)\r\n      this._relationships.splice(this._relationships.indexOf(relationship), 1 , this.relationshipMap[relationship.id])\r\n    }\r\n    return this\r\n  }\r\n  updateNodes (nodes){\r\n    for (let node of Array.from(nodes)) {\r\n      this.nodeMap[node.id]  = node\r\n      this._nodes = Object.values(this.nodeMap);\r\n    }\r\n    return this\r\n  }\r\n  updateRelationships(relations){\r\n    for (let r of Array.from(relations)) {\r\n      this.relationshipMap[r.id]  = r\r\n      this._relationships = Object.values(this.relationshipMap);\r\n    }\r\n    return this\r\n\r\n  }\r\n\r\n  removeConnectedRelationships (node) {\r\n    for (let r of Array.from(this.findAllRelationshipToNode(node))) {\r\n      this.updateNode(r.source)\r\n      this.updateNode(r.target)\r\n      this._relationships.splice(this._relationships.indexOf(r), 1)\r\n      delete this.relationshipMap[r.id]\r\n    }\r\n    return this\r\n  }\r\n  removeConnectedRelationshipss(nodes){\r\n    nodes.map(v=>{\r\n      this.removeConnectedRelationships(v)\r\n    })\r\n  }\r\n  gainRelByNode(arr){\r\n    let nodes  = [] , relationships = [];\r\n    let nMap = {};\r\n    arr.forEach(v=>{\r\n      nMap[v] = true;\r\n    })\r\n    arr.forEach(v=>{\r\n      if(this.findNode(v)){\r\n        nodes.push(this.findNode(v))\r\n      }\r\n    })\r\n    this._relationships.forEach(v=>{\r\n      if(nMap[v.source.id] && nMap[v.target.id]){\r\n        relationships.push(v);\r\n      }\r\n    })\r\n    return {nodes,relationships}\r\n  }\r\n\r\n  addRelationships (relationships) {\r\n    for (let relationship of Array.from(relationships)) {\r\n      const existingRelationship = this.findRelationship(relationship.id)\r\n      this.addRelLabelsMap(relationship);\r\n      if (existingRelationship != null) {\r\n        existingRelationship.internal = false\r\n      } else {\r\n        relationship.internal = false\r\n        this.relationshipMap[relationship.id] = relationship\r\n        this._relationships.push(relationship)\r\n      }\r\n    }\r\n    return this\r\n  }\r\n  addRelLabelsMap(rel){\r\n    if(rel.type){\r\n      if(!this.relLabelsMap[rel.type]){\r\n        this.relLabelsMap[rel.type] = [];\r\n      }\r\n      if(this.filterRelByLabelMap[rel.type]){\r\n        rel.display = 'hide';\r\n      }else{\r\n        rel.display = 'show';\r\n      }\r\n      this.relLabelsMap[rel.type].push(rel.id);\r\n      this.relLabelsMap[rel.type] = [...new Set (this.relLabelsMap[rel.type])];\r\n    }\r\n    return this;\r\n  }\r\n\r\n  addInternalRelationships (relationships) {\r\n    for (let relationship of Array.from(relationships)) {\r\n      relationship.internal = true\r\n      if (this.findRelationship(relationship.id) == null) {\r\n        this.relationshipMap[relationship.id] = relationship\r\n        this._relationships.push(relationship)\r\n      }\r\n    }\r\n    return this\r\n  }\r\n\r\n  pruneInternalRelationships () {\r\n    const relationships = this._relationships.filter(\r\n      relationship => !relationship.internal\r\n    )\r\n    this.relationshipMap = {}\r\n    this._relationships = []\r\n    return this.addRelationships(relationships)\r\n  }\r\n\r\n  findNode (id) {\r\n    return this.nodeMap[id]\r\n  }\r\n\r\n  findNodeNeighbourIds (id) {\r\n    return this._relationships\r\n      .filter(\r\n        relationship =>\r\n          relationship.source.id === id || relationship.target.id === id\r\n      )\r\n      .map(function (relationship) {\r\n        if (relationship.target.id === id) {\r\n          return relationship.source.id\r\n        }\r\n        return relationship.target.id\r\n      })\r\n  }\r\n\r\n  findRelationship (id) {\r\n    return this.relationshipMap[id]\r\n  }\r\n\r\n  findAllRelationshipToNode (node) {\r\n    return this._relationships.filter(\r\n      relationship =>\r\n        relationship.source.id === node.id || relationship.target.id === node.id\r\n    )\r\n  }\r\n\r\n  resetGraph () {\r\n    this.nodeMap = {}\r\n    this._nodes = []\r\n    this.relationshipMap = {}\r\n    this.filterRelByLabelMap = {}\r\n    this.filterNodeByLabelMap = {}\r\n    this.nodeLabelsMap = {}\r\n    this.relLabelsMap = {}\r\n    this.isCtrlClick = false\r\n    return (this._relationships = [])\r\n  }\r\n  initSeleced(){\r\n    this.isCtrlClick = false\r\n  }\r\n}\r\n\r\nclass NodePair {\r\n  constructor (node1, node2) {\r\n    this.relationships = []\r\n    if (node1.id < node2.id) {\r\n      this.nodeA = node1\r\n      this.nodeB = node2\r\n    } else {\r\n      this.nodeA = node2\r\n      this.nodeB = node1\r\n    }\r\n  }\r\n\r\n  isLoop () {\r\n    return this.nodeA === this.nodeB\r\n  }\r\n\r\n  toString () {\r\n    return `${this.nodeA.id}:${this.nodeB.id}`\r\n  }\r\n}\r\n","export default class Node {\r\n  isNode = true\r\n  isRelationship = false\r\n\r\n  constructor (id, labels, properties,className ) {\r\n    this.id = id\r\n    this.labels = [properties.label_for_match];\r\n    // this.labels = labels;\r\n    // console.log(labels);\r\n    this.labelsAll = labels;\r\n    this.className = className\r\n    this.display = 'unvalue';\r\n    this.isFilter = false;\r\n    this.propertyMap = properties\r\n    this.propertyList = (() => {\r\n      const result = []\r\n      for (let key of Object.keys(properties || {})) {\r\n        const value = properties[key]\r\n        result.push({ key, value })\r\n      }\r\n      return result\r\n    })()\r\n  }\r\n\r\n  toJSON () {\r\n    return this.propertyMap\r\n  }\r\n  gainMaxLabel(labels){\r\n    if(labels.length == 1) return labels;\r\n    let arr = [\"changed\" ,\"added\"  ,\"deleted\"  ,\"Notupdated\"  ,\"cryptoRelated\"  ,\"UncryptoRelated\",\"Tech\"];\r\n    for(let i = 0 ; i < labels.length ; i ++){\r\n      if(labels[i] == 'Capital'){\r\n        return ['Capital'];\r\n      }\r\n      if(labels[i] == 'School'){\r\n        return ['School'];\r\n      }\r\n      if(labels[i] == 'Project'){\r\n        return ['Project'];\r\n      }\r\n      if(labels[i] == 'Person'){\r\n        return ['Person'];\r\n      }\r\n      if(arr.indexOf(labels[i]) != -1){\r\n        return [labels[i]]\r\n      }\r\n    }\r\n  }\r\n\r\n  relationshipCount (graph) {\r\n    const node = this\r\n    const rels = []\r\n    for (let relationship of Array.from(graph.relationships())) {\r\n      if (relationship.source === node || relationship.target === node) {\r\n        rels.push(relationship)\r\n      }\r\n    }\r\n    return rels.length\r\n  }\r\n}\r\n","export default class Relationship {\r\n  isNode = false\r\n  isRelationship = true\r\n  constructor (id, source, target, type, properties , className) {\r\n    this.id = id\r\n    this.source = source\r\n    this.target = target\r\n    this.type = type\r\n    this.display = 'unvalue';\r\n    this.className = className\r\n    this.propertyMap = properties\r\n    this.propertyList = (() => {\r\n      const result = []\r\n      for (let key of Object.keys(this.propertyMap || {})) {\r\n        const value = this.propertyMap[key]\r\n        result.push({ key, value })\r\n      }\r\n      return result\r\n    })()\r\n  }\r\n\r\n  toJSON () {\r\n    return this.propertyMap\r\n  }\r\n  isLoop () {\r\n    return this.source === this.target\r\n  }\r\n}\r\n","import { optionalToString } from '../shared/services/utils'\r\nimport Graph from './lib/visualization/components/graph'\r\nimport Node from './lib/visualization/components/node'\r\nimport Relationship from './lib/visualization/components/relationship'\r\n\r\nconst mapProperties = _ => Object.assign({}, ...stringifyValues(_))\r\nconst stringifyValues = obj =>\r\n  Object.keys(obj).map(k => ({ [k]: optionalToString(obj[k]) }))\r\n\r\nexport function createGraph (nodes, relationships , config) {\r\n  let graph = new Graph(config)\r\n  graph.addNodes(mapNodes(nodes))\r\n  graph.addRelationships(mapRelationships(relationships, graph))\r\n  graph.display = { initialNodeDisplay: 300, nodeCount: 1 }\r\n  return graph\r\n}\r\n\r\nexport function mapNodes (nodes) {\r\n  return nodes.map(\r\n    node => new Node(node.id, node.labels, mapProperties(node.properties) , node.className || '')\r\n  )\r\n}\r\n\r\nexport function mapRelationships (relationships, graph) {\r\n  return relationships.map(rel => {\r\n    const source = graph.findNode(rel.startNodeId)\r\n    const target = graph.findNode(rel.endNodeId)\r\n    return new Relationship(\r\n      rel.id,\r\n      source,\r\n      target,\r\n      rel.type,\r\n      mapProperties(rel.properties),\r\n      rel.className\r\n    )\r\n  })\r\n}\r\n\r\nexport function getGraphStats (graph) {\r\n  let labelStats = {}\r\n  let relTypeStats = {}\r\n  graph.nodes().forEach(node => {\r\n    node.labels.forEach(label => {\r\n      if (labelStats['*']) {\r\n        labelStats['*'].count = labelStats['*'].count + 1\r\n      } else {\r\n        labelStats['*'] = {\r\n          count: 1,\r\n          properties: []\r\n        }\r\n      }\r\n      if (labelStats[label]) {\r\n        labelStats[label].count = labelStats[label].count + 1\r\n        labelStats[label].properties = Object.assign(\r\n          {},\r\n          labelStats[label].properties,\r\n          node.propertyMap\r\n        )\r\n      } else {\r\n        labelStats[label] = {\r\n          count: 1,\r\n          properties: node.propertyMap\r\n        }\r\n      }\r\n    })\r\n  })\r\n  graph.relationships().forEach(rel => {\r\n    if (relTypeStats['*']) {\r\n      relTypeStats['*'].count = relTypeStats['*'].count + 1\r\n    } else {\r\n      relTypeStats['*'] = {\r\n        count: 1,\r\n        properties: []\r\n      }\r\n    }\r\n    if (relTypeStats[rel.type]) {\r\n      relTypeStats[rel.type].count = relTypeStats[rel.type].count + 1\r\n      relTypeStats[rel.type].properties = Object.assign(\r\n        {},\r\n        relTypeStats[rel.type].properties,\r\n        rel.propertyMap\r\n      )\r\n    } else {\r\n      relTypeStats[rel.type] = {\r\n        count: 1,\r\n        properties: rel.propertyMap\r\n      }\r\n    }\r\n  })\r\n  return { labels: labelStats, relTypes: relTypeStats }\r\n}\r\n","import d3 from \"d3\"\r\nimport { mapNodes, mapRelationships, getGraphStats } from './mapper'\r\n\r\nexport class GraphEventHandler {\r\n  constructor (\r\n    graph,\r\n    graphView,\r\n    getNodeNeighbours,\r\n    onItemMouseOver,\r\n    onItemSelected,\r\n    onGraphModelChange,\r\n    onEventListener\r\n  ) {\r\n    this.graph = graph\r\n    this.graphView = graphView\r\n    this.getNodeNeighbours = getNodeNeighbours\r\n    this.selectedItem = null\r\n    this.rightClickedItem = null;\r\n    this.onItemMouseOver = onItemMouseOver\r\n    this.onItemSelected = onItemSelected\r\n    this.onEventListener = onEventListener\r\n    this.onGraphModelChange = onGraphModelChange\r\n    this.ctrlClickedArr = [];\r\n    this.rightClickedMap = {};\r\n  }\r\n\r\n  graphModelChanged () {\r\n    this.onGraphModelChange(getGraphStats(this.graph))\r\n  }\r\n  resetEH (){\r\n    this.ctrlClickedArr = [];\r\n    this.rightClickedMap = {};\r\n    this.selectedItem = null\r\n    this.rightClickedItem = null;\r\n  }\r\n\r\n  selectItem (item) {\r\n    if (this.selectedItem) {\r\n      this.selectedItem.selected = false\r\n    }\r\n    this.selectedItem = item\r\n    item.selected = true\r\n    this.graphView.update()\r\n  }\r\n\r\n  deselectItem () {\r\n    let isUpdate =  this.selectedItem || this.rightClickedItem;\r\n    if (this.selectedItem) {\r\n      this.selectedItem.selected = false\r\n      this.selectedItem = null\r\n    }\r\n    if(this.rightClickedItem){\r\n      this.rightClickedItem.rightClicked = false\r\n      this.rightClickedItem = null\r\n    }\r\n    this.onItemSelected({\r\n      type: 'canvas',\r\n      item: {\r\n        nodeCount: this.graph.nodes().length,\r\n        relationshipCount: this.graph.relationships().length\r\n      }\r\n    })\r\n    if(isUpdate){\r\n      this.graphView.update();\r\n    }\r\n  }\r\n  clearSelected(){\r\n    if (this.selectedItem) {\r\n      this.selectedItem.selected = false\r\n      this.selectedItem = null\r\n    }\r\n    this.graphView.update();\r\n  }\r\n  clearRightSelected(){\r\n    if(this.rightClickedItem){\r\n      this.rightClickedItem.rightClicked = false\r\n      this.rightClickedItem = null\r\n    }\r\n    this.graphView.update();\r\n  }\r\n\r\n  nodeClose (d) {\r\n    this.graph.removeConnectedRelationships(d)\r\n    this.graph.removeNode(d)\r\n    this.deselectItem()\r\n    this.graphView.update()\r\n    this.graphModelChanged()\r\n  }\r\n\r\n  nodeClicked (d) {\r\n      if (!d) {\r\n        return\r\n      }\r\n      if(d.rightClicked){\r\n        d.rightClicked = false\r\n      }\r\n      d.fixed = true\r\n      if (!d.selected) {\r\n        this.selectItem(d)\r\n        this.onItemSelected({\r\n          type: 'node',\r\n          item: { id: d.id, labels: d.labels, properties: d.propertyList , layerX : d.px , layerY : d.py}\r\n        })\r\n      } else {\r\n        this.deselectItem()\r\n      }\r\n      \r\n      this.onEventListener({\r\n        type : 'nodeClicked',\r\n        item : d\r\n      })\r\n  }\r\n  onNodeCtrlClick(d){\r\n    if(!d) return;\r\n    if(!d.ctrlClicked){\r\n      d.ctrlClicked = true;\r\n      this.ctrlClickedArr.push(d.id)\r\n    }else{\r\n      d.ctrlClicked = false;\r\n      this.ctrlClickedArr = this.ctrlClickedArr.filter(v=>v.id != d.id)\r\n    }\r\n    this.onEventListener({\r\n      type : 'nodeCtrlClicked',\r\n      item : d\r\n    })\r\n    this.clearSelected();\r\n    this.clearRightSelected();\r\n    // this.graphView.update()\r\n  }\r\n  onNodeClickRight(d){\r\n    if(!d) return;\r\n    if(d.selected){\r\n      d.selected = false;\r\n    }\r\n    if(this.rightClickedItem && this.rightClickedItem.rightClicked){\r\n      this.rightClickedItem.rightClicked = false;\r\n    }\r\n    this.rightClickedItem = d;\r\n    if(!d.rightClicked){\r\n      d.rightClicked = true;\r\n      this.rightClickedMap[d.id] = d;\r\n    }else{\r\n      d.rightClicked = false;\r\n    }\r\n    \r\n    this.onEventListener({\r\n      type : 'nodeRightClicked',\r\n      item : d\r\n    })\r\n    this.clearSelected();\r\n  }\r\n\r\n  nodeUnlock (d) {\r\n    if (!d) {\r\n      return\r\n    }\r\n    d.fixed = false\r\n    this.deselectItem()\r\n  }\r\n  nodeDelete (d){\r\n    this.onEventListener({\r\n      type : 'nodeDelete',\r\n      item : d\r\n    })\r\n  }\r\n  nodeNew (d){\r\n    this.onEventListener({\r\n      type : 'nodeNew',\r\n      item : d\r\n    })\r\n  }\r\n  nodeEdit (d){\r\n    // message.success('修改节点,功能开发中!');\r\n    this.onEventListener({\r\n      type : 'nodeEdit',\r\n      item : d\r\n    })\r\n  }\r\n\r\n  nodeDblClicked (d) {\r\n    if (d.expanded) {\r\n      this.nodeCollapse(d)\r\n      d.expanded = false;\r\n    }else{\r\n      d.expanded = true;\r\n    }\r\n    this.onEventListener({\r\n      type : 'nodeDbClicked',\r\n      item : d\r\n    })\r\n  }\r\n\r\n  nodeCollapse (d) {\r\n    d.expanded = false\r\n    this.graph.collapseNode(d)\r\n    this.graphView.update()\r\n    this.graphModelChanged()\r\n  }\r\n\r\n  onNodeMouseOver (node) {\r\n    if (!node.contextMenu) {\r\n      this.onItemMouseOver({\r\n        type: 'node',\r\n        item: {\r\n          id: node.id,\r\n          labels: node.labels,\r\n          properties: node.propertyList\r\n        }\r\n      })\r\n    }\r\n    // 增加节点的hover事件\r\n    if (this.hoveredItem) {\r\n      this.hoveredItem.hovered = false\r\n    }\r\n    \r\n    this.onEventListener({\r\n      type : 'nodeMouseOver',\r\n      item : node\r\n    })\r\n    this.hoveredItem = node\r\n    node.hovered = true\r\n    // this.graphView.update();\r\n  }\r\n  onMenuMouseOver (itemWithMenu) {\r\n    this.onItemMouseOver({\r\n      type: 'context-menu-item',\r\n      item: {\r\n        label: itemWithMenu.contextMenu.label,\r\n        content: itemWithMenu.contextMenu.menuContent,\r\n        selection: itemWithMenu.contextMenu.menuSelection\r\n      }\r\n    })\r\n    this.onEventListener({\r\n      type : 'menuMouseOver',\r\n      item : itemWithMenu\r\n    })\r\n\r\n  }\r\n  onRelationshipMouseOver (relationship) {\r\n    this.onItemMouseOver({\r\n      type: 'relationship',\r\n      item: {\r\n        id: relationship.id,\r\n        type: relationship.type,\r\n        properties: relationship.propertyList\r\n      }\r\n    })\r\n    this.onEventListener({\r\n      type : 'relationshipMouseOver',\r\n      item : relationship\r\n    })\r\n  }\r\n\r\n  onRelationshipClicked (relationship) {\r\n    if (!relationship.selected) {\r\n      this.selectItem(relationship)\r\n      this.onItemSelected({\r\n        type: 'relationship',\r\n        item: {\r\n          id: relationship.id,\r\n          type: relationship.type,\r\n          properties: relationship.propertyList\r\n        }\r\n      })\r\n    } else {\r\n      this.deselectItem()\r\n    }\r\n    this.onEventListener({\r\n      type : 'relationshipClicked',\r\n      item : relationship\r\n    })\r\n  }\r\n\r\n  onCanvasClicked () {\r\n    // update 函数 放在 onEventListener 上方 会导致 页面svg节点抖动 位置重新计算\r\n    this.onEventListener({\r\n      type : 'canvasClicked',\r\n      item : null\r\n    })\r\n    \r\n    this.deselectItem()\r\n  }\r\n\r\n  onItemMouseOut (item) {\r\n    this.onItemMouseOver({\r\n      type: 'canvas',\r\n      item: {\r\n        nodeCount: this.graph.nodes().length,\r\n        relationshipCount: this.graph.relationships().length\r\n      }\r\n    })\r\n    this.onEventListener({\r\n      type : 'canvasMouseOver',\r\n      item \r\n    })\r\n  }\r\n// 反选\r\n  onContrarySelected(item){\r\n    this.onEventListener({\r\n      type : 'contrarySelected',\r\n      item\r\n    })\r\n    this.deselectItem()\r\n  }\r\n  //清除选择 \r\n  onClearSelected(item){\r\n    this.onEventListener({\r\n      type : 'clearSelected',\r\n      item\r\n    })\r\n    this.deselectItem()\r\n  }\r\n  // 撤回到上一种状态\r\n  onBackStatus(item){\r\n    this.onEventListener({\r\n      type : 'backStatus',\r\n      item\r\n    })\r\n    this.deselectItem()\r\n  }\r\n  // 回到初始状态\r\n  onInitStatus(item){\r\n    this.onEventListener({\r\n      type : 'initStatus',\r\n      item\r\n    })\r\n  }\r\n  // 播放过度动画\r\n  onStartFrame(item){\r\n    console.log(this.graph)\r\n    this.graph.resetGraph()\r\n    this.graphView.update()\r\n    this.onEventListener({\r\n      type : 'startFrame',\r\n      item : this.ctrlClickedArr\r\n    })\r\n  }\r\n  // 生成图\r\n  onMadeChart(item){\r\n    this.onEventListener({\r\n      type : 'madeChart',\r\n      item : this.ctrlClickedArr\r\n    })\r\n    this.deselectItem()\r\n  }\r\n  // 新增边\r\n  onAddRel(item){\r\n    this.onEventListener({\r\n      type : 'addRel',\r\n      item \r\n    })\r\n    this.deselectItem()\r\n  }\r\n\r\n  bindEventHandlers () {\r\n    this.graphView\r\n      .on('nodeMouseOver', this.onNodeMouseOver.bind(this))\r\n      .on('nodeMouseOut', this.onItemMouseOut.bind(this))\r\n      .on('menuMouseOver', this.onMenuMouseOver.bind(this))\r\n      .on('menuMouseOut', this.onItemMouseOut.bind(this))\r\n      .on('relMouseOver', this.onRelationshipMouseOver.bind(this))\r\n      .on('relMouseOut', this.onItemMouseOut.bind(this))\r\n      .on('relationshipClicked', this.onRelationshipClicked.bind(this))\r\n      .on('canvasClicked', this.onCanvasClicked.bind(this))\r\n      .on('nodeClose', this.nodeClose.bind(this))\r\n      .on('nodeClicked', this.nodeClicked.bind(this))\r\n      .on('nodeDblClicked', this.nodeDblClicked.bind(this))\r\n      .on('nodeUnlock', this.nodeUnlock.bind(this))\r\n      .on('nodeDelete', this.nodeDelete.bind(this))\r\n      .on('nodeNew', this.nodeNew.bind(this))\r\n      .on('nodeEdit', this.nodeEdit.bind(this))\r\n      .on('nodeCtrlClick', this.onNodeCtrlClick.bind(this))\r\n      .on('nodeClickRight', this.onNodeClickRight.bind(this))\r\n      .on('contrarySelected', this.onContrarySelected.bind(this))\r\n      .on('clearSelected', this.onClearSelected.bind(this))\r\n      .on('backStatus', this.onBackStatus.bind(this))\r\n      .on('initStatus', this.onInitStatus.bind(this))\r\n      .on('startFrame', this.onStartFrame.bind(this))\r\n      .on('madeChart',this.onMadeChart.bind(this))\r\n      .on('addRel',this.onAddRel.bind(this))\r\n    this.onItemMouseOut()\r\n  }\r\n}\r\n","\r\n/* global DOMParser */\r\n\r\nimport d3 from 'd3'\r\n\r\n\r\nd3.selection.enter.prototype.appendSVG = function (SVGString) {\r\n  return this.select(function () {\r\n    return this.appendChild(\r\n      document.importNode(\r\n        new DOMParser().parseFromString(SVGString, 'application/xml')\r\n          .documentElement.firstChild,\r\n        true\r\n      )\r\n    )\r\n  })\r\n}\r\n","/*\r\n * Copyright (c) 2002-2019 \"Neo4j,\"\r\n * Neo4j Sweden AB [http://neo4j.com]\r\n *\r\n * This file is part of Neo4j.\r\n *\r\n * Neo4j is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * (at your option) any later version.\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\nimport d3 from 'd3'\r\nexport const prepareForExport = (svgElement, graphElement, type) => {\r\n  const dimensions = getSvgDimensions(graphElement)\r\n  let svg = d3.select(\r\n    document.createElementNS('http://www.w3.org/2000/svg', 'svg')\r\n  )\r\n\r\n  svg.append('title').text('Neo4j Graph Visualization')\r\n  svg.append('desc').text('Created using Neo4j (http://www.neo4j.com/)')\r\n\r\n  switch (type) {\r\n    case 'plan': {\r\n      svg = appendPlanLayers(svgElement, svg)\r\n      break\r\n    }\r\n    case 'graph':\r\n    default:\r\n      svg = appendGraphLayers(svgElement, svg)\r\n  }\r\n\r\n  svg.selectAll('.overlay, .ring').remove()\r\n  svg.selectAll('.context-menu-item').remove()\r\n  svg.selectAll('text').attr('font-family', 'sans-serif')\r\n\r\n  svg.attr('width', dimensions.width)\r\n  svg.attr('height', dimensions.height)\r\n  svg.attr('viewBox', dimensions.viewBox)\r\n\r\n  return svg\r\n}\r\n\r\nconst getSvgDimensions = view => {\r\n  let boundingBox, dimensions\r\n  boundingBox = view.boundingBox()\r\n  dimensions = {\r\n    width: boundingBox.width,\r\n    height: boundingBox.height,\r\n    viewBox: [\r\n      boundingBox.x,\r\n      boundingBox.y,\r\n      boundingBox.width,\r\n      boundingBox.height\r\n    ].join(' ')\r\n  }\r\n  return dimensions\r\n}\r\n\r\nconst appendGraphLayers = (svgElement, svg) => {\r\n  window.d3\r\n    .select(svgElement)\r\n    .selectAll('g.layer')\r\n    .each(function (node) {\r\n      svg.node().appendChild(\r\n        window.d3\r\n          .select(this)\r\n          .node()\r\n          .cloneNode(true)\r\n      )\r\n    })\r\n  return svg\r\n}\r\nconst appendPlanLayers = (svgElement, svg) => {\r\n  window.d3\r\n    .select(svgElement)\r\n    .selectAll('g.layer')\r\n    .each(function (node) {\r\n      svg.node().appendChild(\r\n        window.d3\r\n          .select(this)\r\n          .node()\r\n          .cloneNode(true)\r\n      )\r\n    })\r\n  return svg\r\n}\r\n","/*\r\n * Copyright (c) 2002-2019 \"Neo4j,\"\r\n * Neo4j Sweden AB [http://neo4j.com]\r\n *\r\n * This file is part of Neo4j.\r\n *\r\n * Neo4j is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * (at your option) any later version.\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\n\r\nimport { prepareForExport } from './svgUtils'\r\nimport FileSaver from 'file-saver'\r\n\r\nexport const downloadPNGFromSVG = (svg, graph, type) => {\r\n  const svgObj = prepareForExport(svg, graph, type)\r\n  const svgData = htmlCharacterRefToNumericalRef(svgObj.node())\r\n  console.log(svgData)\r\n  let canvas\r\n  canvas = document.createElement('canvas')\r\n  canvas.width = svgObj.attr('width')\r\n  canvas.height = svgObj.attr('height')\r\n\r\n  window.canvg(canvas, svgData)\r\n  return downloadWithDataURI(type + '.png', canvas.toDataURL('image/png'))\r\n}\r\nexport const gainPngBase64 =(svg, graph, type) => {\r\n  const svgObj = prepareForExport(svg, graph, type)\r\n  const svgData = htmlCharacterRefToNumericalRef(svgObj.node())\r\n\r\n  let canvas\r\n  canvas = document.createElement('canvas')\r\n  canvas.width = svgObj.attr('width')\r\n  canvas.height = svgObj.attr('height')\r\n\r\n  window.canvg(canvas, svgData)\r\n  return gainbase64(type + '.png', canvas.toDataURL('image/png'))\r\n}\r\n\r\nconst gainbase64 = (filename, dataURI) => {\r\n  var byteString, i, ia, j, mimeString, ref\r\n  byteString = null\r\n  if (dataURI.split(',')[0].indexOf('base64') >= 0) {\r\n    byteString = window.atob(dataURI.split(',')[1])\r\n  } else {\r\n    byteString = unescape(dataURI.split(',')[1])\r\n  }\r\n  mimeString = dataURI\r\n    .split(',')[0]\r\n    .split(':')[1]\r\n    .split(';')[0]\r\n  ia = new Uint8Array(byteString.length)\r\n  for (\r\n    i = j = 0, ref = byteString.length;\r\n    ref >= 0 ? j <= ref : j >= ref;\r\n    i = ref >= 0 ? ++j : --j\r\n  ) {\r\n    ia[i] = byteString.charCodeAt(i)\r\n  }\r\n  return new Blob([ia], { type: mimeString })\r\n  return  'data:image/png;base64,'+ btoa(String.fromCharCode.apply(null, ia));\r\n}\r\n\r\nexport const downloadSVG = (svg, graph, type) => {\r\n  const svgObj = prepareForExport(svg, graph, type)\r\n  const svgData = htmlCharacterRefToNumericalRef(svgObj.node())\r\n\r\n  return download(type + '.svg', 'image/svg+xml;charset=utf-8', svgData)\r\n}\r\n\r\nconst htmlCharacterRefToNumericalRef = node =>\r\n  new window.XMLSerializer()\r\n    .serializeToString(node)\r\n    .replace(/&nbsp;/g, '&#160;')\r\n\r\nconst download = (filename, mime, data) => {\r\n  const blob = new Blob([data], { type: mime })\r\n  return FileSaver.saveAs(blob, filename)\r\n}\r\n\r\nconst downloadWithDataURI = (filename, dataURI) => {\r\n  var byteString, i, ia, j, mimeString, ref\r\n  byteString = null\r\n  if (dataURI.split(',')[0].indexOf('base64') >= 0) {\r\n    byteString = window.atob(dataURI.split(',')[1])\r\n  } else {\r\n    byteString = unescape(dataURI.split(',')[1])\r\n  }\r\n  mimeString = dataURI\r\n    .split(',')[0]\r\n    .split(':')[1]\r\n    .split(';')[0]\r\n  ia = new Uint8Array(byteString.length)\r\n  for (\r\n    i = j = 0, ref = byteString.length;\r\n    ref >= 0 ? j <= ref : j >= ref;\r\n    i = ref >= 0 ? ++j : --j\r\n  ) {\r\n    ia[i] = byteString.charCodeAt(i)\r\n  }\r\n  return download(filename, mimeString, ia)\r\n}\r\n","import {\r\n  selectorStringToArray,\r\n  selectorArrayToString\r\n} from '../shared/services/grassUtils'\r\n\r\nexport default function neoGraphStyle() {\r\n  // 修改默认的样式\r\n  const defaultStyle = {\r\n    \"node\": {\r\n      \"diameter\": \"35px\",\r\n      \"color\": \"#f9d684\",\r\n      \"border-color\": \"#f9d684\",\r\n      \"border-width\": \"2px\",\r\n      \"text-color-internal\": \"#454545\",\r\n      \"font-size\": \"10px\"\r\n    },\r\n    \"node.changed\": {\r\n      \"diameter\": \"25px\",\r\n      \"color\": \"#adadad\",\r\n      \"border-color\": \"#adadad\",\r\n      \"border-width\": \"2px\",\r\n      \"text-color-internal\": \"#454545\",\r\n      \"font-size\": \"10px\"\r\n    },\r\n    \"node.cryptoRelated\": {\r\n      \"diameter\": \"25px\",\r\n      \"color\": \"#adadad\",\r\n      \"border-color\": \"#adadad\",\r\n      \"border-width\": \"2px\",\r\n      \"text-color-internal\": \"#454545\",\r\n      \"font-size\": \"10px\"\r\n    },\r\n    \"node.UncryptoRelated\": {\r\n      \"diameter\": \"25px\",\r\n      \"color\": \"#adadad\",\r\n      \"border-color\": \"#adadad\",\r\n      \"border-width\": \"2px\",\r\n      \"text-color-internal\": \"#454545\",\r\n      \"font-size\": \"10px\"\r\n    },\r\n    \"relationship\": {\r\n      \"color\": \"#A5ABB6\",\r\n      \"shaft-width\": \"1px\",\r\n      \"font-size\": \"8px\",\r\n      \"padding\": \"3px\",\r\n      \"text-color-external\": \"#000000\",\r\n      \"text-color-internal\": \"#FFFFFF\",\r\n      \"caption\": \"<type>\"\r\n    },\r\n    \"node.Project\": {\r\n      \"color\": \"#346894\",\r\n      \"border-color\": \"#346894\",\r\n      \"text-color-internal\": \"#FFFFFF\",\r\n      \"defaultCaption\": \"<id>\",\r\n      \"diameter\": \"65px\",\r\n      \"caption\": \"{name}\"\r\n    },\r\n    \"node.Sector\": {\r\n      \"color\": \"#a75a29\",\r\n      \"border-color\": \"#a75a29\",\r\n      \"text-color-internal\": \"#ffffff\",\r\n      \"defaultCaption\": \"<id>\",\r\n      \"diameter\": \"80px\"\r\n    },\r\n    \"node.Capital\": {\r\n      \"color\": \"#09274b\",\r\n      \"border-color\": \"#09274b\",\r\n      \"text-color-internal\": \"#FFFFFF\",\r\n      \"defaultCaption\": \"<id>\",\r\n      \"diameter\": \"65px\"\r\n    },\r\n    \"node.Token\": {\r\n      \"color\": \"#346894\",\r\n      \"border-color\": \"#346894\",\r\n      \"text-color-internal\": \"#FFFFFF\",\r\n      \"defaultCaption\": \"<id>\",\r\n      \"diameter\": \"50px\"\r\n    },\r\n    \"node.Person\": {\r\n      \"color\": \"#d79d53\",\r\n      \"border-color\": \"#d79d53\",\r\n      \"text-color-internal\": \"#1c1c1c\",\r\n      \"defaultCaption\": \"<id>\",\r\n      \"caption\": \"{name}\",\r\n      \"diameter\": \"50px\"\r\n    },\r\n    \"node.School\": {\r\n      \"caption\": \"{name}\",\r\n      \"diameter\": \"80px\",\r\n      \"color\": \"#604740\",\r\n      \"border-color\": \"#604740\",\r\n      \"text-color-internal\": \"#ffffff\"\r\n    },\r\n    \"node.FundingRound\": {\r\n      \"caption\": \"{name}\",\r\n      \"diameter\": \"35px\",\r\n      \"color\": \"#a0a0a0\",\r\n      \"border-color\": \"#a0a0a0\",\r\n      \"text-color-internal\": \"#ffffff\"\r\n    }\r\n  }\r\n  const defaultSizes = [{\r\n      diameter: '10px'\r\n    },\r\n    {\r\n      diameter: '20px'\r\n    },\r\n    {\r\n      diameter: '50px'\r\n    },\r\n    {\r\n      diameter: '65px'\r\n    },\r\n    {\r\n      diameter: '80px'\r\n    }\r\n  ]\r\n  const defaultIconCodes = [{\r\n      'icon-code': 'a'\r\n    },\r\n    {\r\n      'icon-code': '\"'\r\n    },\r\n    {\r\n      'icon-code': 'z'\r\n    },\r\n    {\r\n      'icon-code': '_'\r\n    },\r\n    {\r\n      'icon-code': '/'\r\n    },\r\n    {\r\n      'icon-code': '>'\r\n    },\r\n    {\r\n      'icon-code': 'k'\r\n    }\r\n  ]\r\n  const defaultArrayWidths = [{\r\n      'shaft-width': '1px'\r\n    },\r\n    {\r\n      'shaft-width': '2px'\r\n    },\r\n    {\r\n      'shaft-width': '3px'\r\n    },\r\n    {\r\n      'shaft-width': '5px'\r\n    },\r\n    {\r\n      'shaft-width': '8px'\r\n    },\r\n    {\r\n      'shaft-width': '13px'\r\n    },\r\n    {\r\n      'shaft-width': '25px'\r\n    },\r\n    {\r\n      'shaft-width': '38px'\r\n    }\r\n  ]\r\n  const defaultColors = [{\r\n      color: '#FFE081',\r\n      'border-color': '#9AA1AC',\r\n      'text-color-internal': '#FFFFFF'\r\n    },\r\n    {\r\n      color: '#C990C0',\r\n      'border-color': '#b261a5',\r\n      'text-color-internal': '#FFFFFF'\r\n    },\r\n    {\r\n      color: '#F79767',\r\n      'border-color': '#f36924',\r\n      'text-color-internal': '#FFFFFF'\r\n    },\r\n    {\r\n      color: '#57C7E3',\r\n      'border-color': '#23b3d7',\r\n      'text-color-internal': '#FFFFFF'\r\n    },\r\n    {\r\n      color: '#F16667',\r\n      'border-color': '#eb2728',\r\n      'text-color-internal': '#FFFFFF'\r\n    },\r\n    {\r\n      color: '#D9C8AE',\r\n      'border-color': '#c0a378',\r\n      'text-color-internal': '#604A0E'\r\n    },\r\n    {\r\n      color: '#8DCC93',\r\n      'border-color': '#5db665',\r\n      'text-color-internal': '#604A0E'\r\n    },\r\n    {\r\n      color: '#ECB5C9',\r\n      'border-color': '#da7298',\r\n      'text-color-internal': '#604A0E'\r\n    },\r\n    {\r\n      color: '#4C8EDA',\r\n      'border-color': '#2870c2',\r\n      'text-color-internal': '#FFFFFF'\r\n    },\r\n    {\r\n      color: '#FFC454',\r\n      'border-color': '#d7a013',\r\n      'text-color-internal': '#604A0E'\r\n    },\r\n    {\r\n      color: '#DA7194',\r\n      'border-color': '#cc3c6c',\r\n      'text-color-internal': '#FFFFFF'\r\n    },\r\n    {\r\n      color: '#569480',\r\n      'border-color': '#447666',\r\n      'text-color-internal': '#FFFFFF'\r\n    }\r\n  ]\r\n  const Selector = (function () {\r\n    function Selector(tag1, classes1) {\r\n      this.tag = tag1\r\n      this.classes = classes1 != null ? classes1 : []\r\n    }\r\n\r\n    Selector.prototype.toString = function () {\r\n      return selectorArrayToString([this.tag].concat(this.classes))\r\n    }\r\n\r\n    return Selector\r\n  })()\r\n\r\n  const StyleRule = (function () {\r\n    function StyleRule(selector1, props1) {\r\n      this.selector = selector1\r\n      this.props = props1\r\n    }\r\n\r\n    StyleRule.prototype.matches = function (selector) {\r\n      if (this.selector.tag !== selector.tag) {\r\n        return false\r\n      }\r\n      for (let i = 0; i < this.selector.classes.length; i++) {\r\n        const classs = this.selector.classes[i]\r\n        if (classs != null && selector.classes.indexOf(classs) === -1) {\r\n          return false\r\n        }\r\n      }\r\n      return true\r\n    }\r\n\r\n    StyleRule.prototype.matchesExact = function (selector) {\r\n      return (\r\n        this.matches(selector) &&\r\n        this.selector.classes.length === selector.classes.length\r\n      )\r\n    }\r\n\r\n    return StyleRule\r\n  })()\r\n\r\n  const StyleElement = (function () {\r\n    function StyleElement(selector) {\r\n      this.selector = selector\r\n      this.props = {}\r\n    }\r\n\r\n    StyleElement.prototype.applyRules = function (rules, item) {\r\n      for (let i = 0; i < rules.length; i++) {\r\n        const rule = rules[i]\r\n        if (rule.matches(this.selector)) {\r\n          this.props = {\r\n            ...this.props,\r\n            ...rule.props\r\n          }\r\n          this.props.caption = this.props.caption || this.props.defaultCaption\r\n        }\r\n      }\r\n      return this\r\n    }\r\n\r\n    StyleElement.prototype.get = function (attr) {\r\n      return this.props[attr] || ''\r\n    }\r\n\r\n    return StyleElement\r\n  })()\r\n\r\n  const GraphStyle = (function () {\r\n    function GraphStyle() {\r\n      this.rules = []\r\n      try {\r\n        this.loadRules()\r\n      } catch (_error) {\r\n        // e = _error\r\n      }\r\n    }\r\n\r\n    const parseSelector = function (key) {\r\n      let tokens = selectorStringToArray(key)\r\n      return new Selector(tokens[0], tokens.slice(1))\r\n    }\r\n\r\n    const selector = function (item) {\r\n      if (item.isNode) {\r\n        return nodeSelector(item)\r\n      } else if (item.isRelationship) {\r\n        return relationshipSelector(item)\r\n      }\r\n    }\r\n\r\n    const nodeSelector = function (node) {\r\n      node = node || {}\r\n      const classes = node.labels != null ? node.labels : []\r\n      return new Selector('node', classes)\r\n    }\r\n\r\n    const relationshipSelector = function (rel) {\r\n      rel = rel || {}\r\n      const classes = rel.type != null ? [rel.type] : []\r\n      return new Selector('relationship', classes)\r\n    }\r\n\r\n    const findRule = function (selector, rules) {\r\n      for (let i = 0; i < rules.length; i++) {\r\n        let rule = rules[i]\r\n        if (rule.matchesExact(selector)) {\r\n          return rule\r\n        }\r\n      }\r\n    }\r\n\r\n    const findAvailableDefaultColor = function (rules) {\r\n      const usedColors = rules\r\n        .filter(rule => {\r\n          return rule.props.color != null\r\n        })\r\n        .map(rule => {\r\n          return rule.props.color\r\n        })\r\n      let index =\r\n        usedColors.length - 1 > defaultColors ? 0 : usedColors.length - 1\r\n      return defaultColors[index]\r\n    }\r\n\r\n    const getDefaultNodeCaption = function (item) {\r\n      if (\r\n        !item ||\r\n        !(item.propertyList != null ? item.propertyList.length : 0) > 0\r\n      ) {\r\n        return {\r\n          defaultCaption: '<id>'\r\n        }\r\n      }\r\n      const captionPrioOrder = [\r\n        /^name$/i,\r\n        /^title$/i,\r\n        /^label$/i,\r\n        /name$/i,\r\n        /description$/i,\r\n        /^.+/\r\n      ]\r\n      let defaultCaption = captionPrioOrder.reduceRight(function (\r\n          leading,\r\n          current\r\n        ) {\r\n          let hits = item.propertyList.filter(function (prop) {\r\n            return current.test(prop.key)\r\n          })\r\n          if (hits.length) {\r\n            return '{' + hits[0].key + '}'\r\n          } else {\r\n            return leading\r\n          }\r\n        },\r\n        '')\r\n      defaultCaption || (defaultCaption = '<id>')\r\n      return {\r\n        caption: defaultCaption\r\n      }\r\n    }\r\n\r\n    GraphStyle.prototype.calculateStyle = function (selector, item) {\r\n      return new StyleElement(selector).applyRules(this.rules, item)\r\n    }\r\n\r\n    // GraphStyle.prototype.forEntity = function (item) {\r\n    //   return this.calculateStyle(selector(item))\r\n    // }\r\n\r\n    GraphStyle.prototype.setDefaultNodeStyling = function (selector, item) {\r\n      let defaultColor = true\r\n      let defaultCaption = true\r\n      for (let i = 0; i < this.rules.length; i++) {\r\n        let rule = this.rules[i]\r\n        if (rule.selector.classes.length > 0 && rule.matches(selector)) {\r\n          if (rule.props.hasOwnProperty('color')) {\r\n            defaultColor = false\r\n          }\r\n          if (rule.props.hasOwnProperty('caption')) {\r\n            defaultCaption = false\r\n          }\r\n        }\r\n      }\r\n      const minimalSelector = new Selector(\r\n        selector.tag,\r\n        selector.classes.sort().slice(0, 1)\r\n      )\r\n      if (defaultColor) {\r\n        this.changeForSelector(\r\n          minimalSelector,\r\n          findAvailableDefaultColor(this.rules)\r\n        )\r\n      }\r\n      if (defaultCaption) {\r\n        return this.changeForSelector(\r\n          minimalSelector,\r\n          getDefaultNodeCaption(item)\r\n        )\r\n      }\r\n    }\r\n\r\n    GraphStyle.prototype.changeForSelector = function (selector, props) {\r\n      let rule = findRule(selector, this.rules)\r\n      if (rule == null) {\r\n        rule = new StyleRule(selector, props)\r\n        this.rules.push(rule)\r\n      }\r\n      rule.props = {\r\n        ...rule.props,\r\n        ...props\r\n      }\r\n      return rule\r\n    }\r\n\r\n    GraphStyle.prototype.destroyRule = function (rule) {\r\n      const idx = this.rules.indexOf(rule)\r\n      if (idx != null) {\r\n        this.rules.splice(idx, 1)\r\n      }\r\n    }\r\n\r\n    GraphStyle.prototype.importGrass = function (string) {\r\n      try {\r\n        const rules = this.parse(string)\r\n        return this.loadRules(rules)\r\n      } catch (_error) {\r\n        // e = _error\r\n      }\r\n    }\r\n\r\n    GraphStyle.prototype.parse = function (string) {\r\n      const chars = string.split('')\r\n      let insideString = false\r\n      let insideProps = false\r\n      let keyword = ''\r\n      let props = ''\r\n      let rules = {}\r\n      for (let i = 0; i < chars.length; i++) {\r\n        const c = chars[i]\r\n        let skipThis = true\r\n        switch (c) {\r\n          case '{':\r\n            if (!insideString) {\r\n              insideProps = true\r\n            } else {\r\n              skipThis = false\r\n            }\r\n            break\r\n          case '}':\r\n            if (!insideString) {\r\n              insideProps = false\r\n              rules[keyword] = props\r\n              keyword = ''\r\n              props = ''\r\n            } else {\r\n              skipThis = false\r\n            }\r\n            break\r\n          case \"'\":\r\n            insideString ^= true\r\n            break\r\n          default:\r\n            skipThis = false\r\n        }\r\n        if (skipThis) {\r\n          continue\r\n        }\r\n        if (insideProps) {\r\n          props += c\r\n        } else {\r\n          if (!c.match(/[\\s\\n]/)) {\r\n            keyword += c\r\n          }\r\n        }\r\n      }\r\n      for (let k in rules) {\r\n        const v = rules[k]\r\n        rules[k] = {}\r\n        v.split(';').forEach(prop => {\r\n          const [key, val] = prop.split(':')\r\n          if (key && val) {\r\n            rules[k][key.trim()] = val.trim()\r\n          }\r\n        })\r\n      }\r\n      return rules\r\n    }\r\n\r\n    GraphStyle.prototype.resetToDefault = function () {\r\n      this.loadRules()\r\n      return true\r\n    }\r\n\r\n    GraphStyle.prototype.toSheet = function () {\r\n      let sheet = {}\r\n      this.rules.forEach(rule => {\r\n        sheet[rule.selector.toString()] = rule.props\r\n      })\r\n      return sheet\r\n    }\r\n\r\n    GraphStyle.prototype.toString = function () {\r\n      let str = ''\r\n      this.rules.forEach(r => {\r\n        str += r.selector.toString() + ' {\\n'\r\n        for (let k in r.props) {\r\n          let v = r.props[k]\r\n          if (k === 'caption') {\r\n            v = \"'\" + v + \"'\"\r\n          }\r\n          str += '  ' + k + ': ' + v + ';\\n'\r\n        }\r\n        str += '}\\n\\n'\r\n      })\r\n      return str\r\n    }\r\n\r\n    GraphStyle.prototype.loadRules = function (data) {\r\n      if (typeof data !== 'object') {\r\n        data = defaultStyle\r\n      }\r\n      this.rules.length = 0\r\n      for (let key in data) {\r\n        const props = data[key]\r\n        this.rules.push(new StyleRule(parseSelector(key), props))\r\n      }\r\n      return this\r\n    }\r\n\r\n    GraphStyle.prototype.defaultSizes = function () {\r\n      return defaultSizes\r\n    }\r\n\r\n    GraphStyle.prototype.defaultIconCodes = function () {\r\n      return defaultIconCodes\r\n    }\r\n\r\n    GraphStyle.prototype.defaultArrayWidths = function () {\r\n      return defaultArrayWidths\r\n    }\r\n\r\n    GraphStyle.prototype.defaultColors = function () {\r\n      return defaultColors\r\n    }\r\n\r\n    GraphStyle.prototype.interpolate = function (str, item) {\r\n      let ips = str.replace(/\\{([^{}]*)\\}/g, function (a, b) {\r\n        let r = item.propertyMap[b]\r\n        if (typeof r === 'object') {\r\n          return r.join(', ')\r\n        }\r\n        if (typeof r === 'string' || typeof r === 'number') {\r\n          return r\r\n        }\r\n        return ''\r\n      })\r\n      if (ips.length < 1 && str === '{type}' && item.isRelationship) {\r\n        ips = '<type>'\r\n      }\r\n      if (ips.length < 1 && str === '{id}' && item.isNode) {\r\n        ips = '<id>'\r\n      }\r\n      return ips.replace(/^<(id|type)>$/, function (a, b) {\r\n        const r = item[b]\r\n        if (typeof r === 'string' || typeof r === 'number') {\r\n          return r\r\n        }\r\n        return ''\r\n      })\r\n    }\r\n\r\n    GraphStyle.prototype.forNode = function (node) {\r\n      node = node || {}\r\n      const selector = nodeSelector(node)\r\n      if ((node.labels != null ? node.labels.length : 0) > 0) {\r\n        this.setDefaultNodeStyling(selector, node)\r\n      }\r\n      return this.calculateStyle(selector, node)\r\n    }\r\n\r\n    GraphStyle.prototype.forRelationship = function (rel) {\r\n      const selector = relationshipSelector(rel)\r\n      return this.calculateStyle(selector, rel)\r\n    }\r\n\r\n    return GraphStyle\r\n  })()\r\n  return new GraphStyle()\r\n}","export function parseGrass (string) {\r\n  let result\r\n  try {\r\n    result = JSON.parse(string)\r\n  } catch (e) {\r\n    result = parseGrassCSS(string)\r\n  }\r\n  return result\r\n}\r\n\r\nfunction parseGrassCSS (string) {\r\n  let chars = string.split('')\r\n  let insideString = false\r\n  let insideProps = false\r\n  let insideBinding = false\r\n  let keyword = ''\r\n  let props = ''\r\n  let rules = {}\r\n  let i, j\r\n\r\n  for (i = 0; i < chars.length; i++) {\r\n    const c = chars[i]\r\n    let skipThis = true\r\n    switch (c) {\r\n      case '{':\r\n        if (insideString) {\r\n          skipThis = false\r\n        } else if (insideProps) {\r\n          insideBinding = true\r\n        } else {\r\n          insideProps = true\r\n        }\r\n        break\r\n      case '}':\r\n        if (insideString) {\r\n          skipThis = false\r\n        } else if (insideBinding) {\r\n          insideBinding = false\r\n        } else {\r\n          insideProps = false\r\n          rules[keyword] = props\r\n          keyword = ''\r\n          props = ''\r\n        }\r\n        break\r\n      case \"'\":\r\n      case '\"':\r\n        insideString = !insideString\r\n        break\r\n      default:\r\n        skipThis = false\r\n        break\r\n    }\r\n\r\n    if (skipThis) {\r\n      continue\r\n    }\r\n\r\n    if (insideProps) {\r\n      props += c\r\n    } else if (!c.match(/[\\s\\n]/)) {\r\n      keyword += c\r\n    }\r\n  }\r\n\r\n  const keys = Object.keys(rules)\r\n  for (i = 0; i < keys.length; i++) {\r\n    const val = rules[keys[i]]\r\n    rules[keys[i]] = {}\r\n    const props = val.split(';')\r\n    for (j = 0; j < props.length; j++) {\r\n      const propKeyVal = props[j].split(':')\r\n      if (propKeyVal && propKeyVal.length === 2) {\r\n        const prop = propKeyVal[0].trim()\r\n        const value = propKeyVal[1].trim()\r\n        rules[keys[i]][prop] = value\r\n      }\r\n    }\r\n  }\r\n\r\n  return rules\r\n}\r\n\r\nexport const objToCss = obj => {\r\n  if (typeof obj !== 'object') {\r\n    console.error('Need a object but got ', typeof obj, obj)\r\n    return false\r\n  }\r\n  let output = ''\r\n  try {\r\n    let level = '  '\r\n    for (let selector in obj) {\r\n      if (obj.hasOwnProperty(selector)) {\r\n        output += selector + ' {\\n' + level\r\n        for (let style in obj[selector]) {\r\n          if (obj[selector].hasOwnProperty(style)) {\r\n            output +=\r\n              style +\r\n              ': ' +\r\n              quoteSpecialStyles(style, obj[selector][style]) +\r\n              ';\\n' +\r\n              level\r\n          }\r\n        }\r\n        output = output.trim() + '\\n'\r\n        output += '}\\n'\r\n      }\r\n    }\r\n  } catch (e) {\r\n    return false\r\n  }\r\n  return output\r\n}\r\n\r\nconst shouldQuoteStyle = style => ['defaultCaption', 'caption'].includes(style)\r\nconst quoteSpecialStyles = (style, value) =>\r\n  (shouldQuoteStyle(style) ? '\"' : '') +\r\n  value +\r\n  (shouldQuoteStyle(style) ? '\"' : '')\r\n\r\nexport const selectorStringToArray = selector => {\r\n  // Negative lookbehind simulation since js support is very limited.\r\n  // We want to match all . that are not preceded by \\\\\r\n  // Instead we reverse and look\r\n  // for . that are not followed by \\\\ (negative lookahead)\r\n  selector = selector\r\n    .split('')\r\n    .reverse()\r\n    .join('')\r\n  var re = /(.+?)(?!\\.\\\\)(?:\\.|$)/g\r\n  const out = []\r\n  let m\r\n  while ((m = re.exec(selector)) !== null) {\r\n    const res = m[1]\r\n      .split('')\r\n      .reverse()\r\n      .join('')\r\n    out.push(res)\r\n  }\r\n\r\n  return out\r\n    .filter(r => r)\r\n    .reverse()\r\n    .map(r => r.replace(/\\\\./g, '.'))\r\n}\r\n\r\nexport const selectorArrayToString = selectors => {\r\n  const escaped = selectors.map(r => r.replace(/\\./g, '\\\\.'))\r\n  return escaped.join('.')\r\n}\r\n","\r\nexport const font = {}\r\n\r\nexport const dim = {\r\n  // Editor bar\r\n  editorbarHeight: 71,\r\n  // Frame\r\n  frameBodyHeight: 550,\r\n  frameTitlebarHeight: 39,\r\n  frameStatusbarHeight: 39,\r\n  frameBodyPadding: 20\r\n}\r\n","import styled from 'styled-components'\r\n\r\nexport const legendRowHeight = 32\r\nexport const inspectorFooterContractedHeight = 22\r\nconst pMarginTop = 6\r\n\r\n// Themes is here because the colors are unique to this component\r\nconst getColor = (theme, name) => {\r\n  const themes = {\r\n    normal: {\r\n      svgBackground: '#f9fbfd'\r\n    },\r\n    dark: {\r\n      svgBackground: '#5a6070'\r\n    }\r\n  }\r\n  if (themes[theme] === undefined) theme = 'normal'\r\n  return themes[theme][name] || ''\r\n}\r\n\r\nexport const StyledSvgWrapper = styled.div`\r\n  line-height: 0;\r\n  height: 100%;\r\n  position: relative;\r\n  > svg {\r\n    height: 100%;\r\n    width: 100%;\r\n    background-color: ${props => getColor(props.theme.name, 'svgBackground')};\r\n    .node {\r\n      cursor: pointer;\r\n      > .ring {\r\n        fill: none;\r\n        opacity: 0;\r\n        stroke: #6ac6ff;\r\n      }\r\n      .outline {\r\n        cursor: pointer;\r\n      }\r\n      &.selected {\r\n        > .ring {\r\n          stroke: #fdcc59;\r\n          opacity: 0.3;\r\n        }\r\n      }\r\n      &:hover {\r\n        > .ring {\r\n          stroke: #6ac6ff;\r\n          opacity: 0.3;\r\n        }\r\n      }\r\n    }\r\n    .nodes.ctrlClick{\r\n      .node{\r\n        opacity : 0.3\r\n      }\r\n      .ctrlClicked{\r\n        opacity : 1\r\n      }\r\n    }\r\n    .nodes{\r\n      .hide{\r\n        opacity : 0 !important;\r\n        cursor : auto !important;  \r\n        &.outline {\r\n          cursor: auto !important;\r\n        }\r\n        .outline {\r\n          cursor: auto !important;\r\n        }\r\n        &:hover {\r\n          > .ring {\r\n            stroke: #6ac6ff !important;\r\n            opacity: 0 !important;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .relationship {\r\n      > .overlay {\r\n        opacity: 0;\r\n        fill: #6ac6ff;\r\n      }\r\n      &.selected {\r\n        > .overlay {\r\n          fill: #fdcc59;\r\n          opacity: 0.3;\r\n        }\r\n      }\r\n      %.\r\n      &:hover {\r\n        > .overlay {\r\n          fill: #6ac6ff;\r\n          opacity: 0.3;\r\n        }\r\n      }\r\n      &.hide {\r\n        opacity : 0;\r\n        &:hover{\r\n          > .overlay {\r\n            fill: #6ac6ff;\r\n            opacity: 0;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .right-menu{\r\n      position : absolute;\r\n      z-index : 10;\r\n      .right-menu-text{\r\n          font-size : 10px;\r\n          fill : #666;\r\n          dominant-baseline: middle; \r\n          &:hover{\r\n            fill : rgb(87,199,227)\r\n            cursor: pointer;\r\n          }\r\n      }\r\n      rect:hover{\r\n        cursor: pointer;\r\n        .right-menu-text{\r\n          fill : rgb(87,199,227)\r\n        }\r\n      }\r\n      &:hover{\r\n        .right-menu-text{\r\n          cursor: pointer;\r\n          fill : rgb(87,199,227)\r\n        }\r\n      }\r\n    }\r\n    .remove_node {\r\n      .expand_node {\r\n        &:hover {\r\n          border: 2px #000 solid;\r\n        }\r\n      }\r\n    }\r\n    path {\r\n      &.context-menu-item {\r\n        stroke-width: 2px;\r\n        fill: #d2d5da;\r\n      }\r\n    }\r\n    text {\r\n      line-height: normal;\r\n      &.context-menu-item {\r\n        fill: #fff;\r\n        text-anchor: middle;\r\n        pointer-events: none;\r\n        font-size: 14px;\r\n      }\r\n    }\r\n    .context-menu-item {\r\n      cursor: pointer;\r\n      &:hover {\r\n        fill: #b9b9b9;\r\n        font-size: 14px;\r\n      }\r\n    }\r\n  }\r\n`\r\nexport const StyledStream = styled.div`\r\n  padding: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-top: 17px;\r\n`\r\n\r\nexport const p = styled.div`\r\n  margin-top: ${pMarginTop}px;\r\n  font-size: 12px;\r\n  width: 100%;\r\n  white-space: normal;\r\n`\r\n\r\nexport const StyledRowToggle = styled.div`\r\n  float: right;\r\n  display: block;\r\n  width: 21px;\r\n  height: 21px;\r\n  line-height: 21px;\r\n  text-align: center;\r\n  cursor: pointer;\r\n`\r\nexport const StyledCaret = styled.div`\r\n  font-size: 17px;\r\n  vertical-align: middle;\r\n`\r\n\r\nexport const StyledInspectorFooter = styled.div`\r\n  margin-top: 6px;\r\n  font-size: 12px;\r\n  width: 100%;\r\n  white-space: normal;\r\n  overflow: scroll;\r\n  &.contracted {\r\n    overflow: hidden;\r\n  }\r\n`\r\n\r\n// export const StyledInspectorFooter = styled.div`\r\n//   margin-top: 6px;\r\n//   font-size: 12px;\r\n//   width: 100%;\r\n//   white-space: normal;\r\n//   overflow: scroll;\r\n//   &.contracted {\r\n//     max-height: ${inspectorFooterContractedHeight}px;\r\n//     overflow: hidden;\r\n//   }\r\n// `\r\n\r\nexport const StyledInspectorFooterRow = styled.ul`\r\n  list-style: none;\r\n  word-break: break-word;\r\n  line-height: 21px;\r\n`\r\n\r\nexport const StyledInspectorFooterRowListKey = styled.div`\r\n  float: left;\r\n  font-weight: 800;\r\n`\r\n\r\nexport const StyledInspectorFooterRowListValue = styled.div`\r\n  padding-left: 3px;\r\n  overflow: hidden;\r\n  float: left;\r\n  white-space: pre-wrap;\r\n`\r\n\r\nexport const StyledInlineList = styled.ul`\r\n  padding-left: 0;\r\n  list-style: none;\r\n  word-break: break-word;\r\n`\r\n\r\nexport const StyledInlineListItem = styled.li`\r\n  display: inline-block;\r\n  padding-right: 5px;\r\n  padding-left: 5px;\r\n`\r\n\r\nexport const StyledStatusBarWrapper = styled.div`\r\n  height: 68px;\r\n  display: none;\r\n`\r\nexport const StyledStatusBar = styled.div`\r\n  min-height: 39px;\r\n  line-height: 39px;\r\n  color: ${props => props.theme.secondaryText};\r\n  font-size: 13px;\r\n  position: absolute;\r\n  background-color: ${props => props.theme.secondaryBackground};\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  border-top: 1px solid #e6e9ef;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n`\r\n\r\nexport const StyledStatus = styled.div`\r\n  position: relative;\r\n  float: left;\r\n  padding-left: 16px;\r\n  margin-top: 0;\r\n  margin-bottom: 0;\r\n  width: 100%;\r\n  margin-top: 3px;\r\n  overflow: auto;\r\n`\r\n\r\nexport const StyledInspectorFooterRowListPair = styled(StyledInlineListItem)`\r\n  vertical-align: middle;\r\n  font-size: 13px;\r\n`\r\n\r\nexport const StyledToken = styled(StyledInlineListItem)`\r\n  display: inline-block;\r\n  font-weight: bold;\r\n  line-height: 1em;\r\n  text-align: center;\r\n  white-space: nowrap;\r\n  vertical-align: baseline;\r\n  user-select: none;\r\n  font-size: 12px;\r\n  margin-right: 5px;\r\n  cursor: pointer;\r\n`\r\nexport const StyledLabelToken = styled(StyledToken)`\r\n  padding: 4px 7px 4px 9px;\r\n  border-radius: 20px;\r\n`\r\nexport const StyledTokenRelationshipType = styled(StyledToken)`\r\n  padding: 4px 7px 4px 5px;\r\n  border-radius: 3px;\r\n`\r\n\r\nexport const tokenPropertyKey = styled(StyledToken)`\r\n  padding: 3px 5px 3px 5px;\r\n`\r\nexport const StyledTokenContextMenuKey = styled(StyledLabelToken)`\r\n  color: #f9fbfd;\r\n  background-color: #d2d5da;\r\n  padding: 4px 9px;\r\n`\r\n\r\nexport const StyledTokenCount = styled.span`\r\n  font-weight: normal;\r\n`\r\nexport const StyledLegendContents = styled.ul`\r\n  float: left;\r\n  line-height: 1em;\r\n  position: relative;\r\n  top: 3px;\r\n  top: -1px;\r\n`\r\n\r\nexport const StyledLegendRow = styled.div`\r\n  border-bottom: 1px solid #e6e9ef;\r\n  &.contracted {\r\n    overflow: hidden;\r\n  }\r\n`\r\n// 将默认最大高度去掉\r\n// export const StyledLegendRow = styled.div`\r\n//   border-bottom: 1px solid #e6e9ef;\r\n//   &.contracted {\r\n//     max-height: ${legendRowHeight}px;\r\n//     overflow: hidden;\r\n//   }\r\nexport const StyledLegend = styled.div`\r\n  background-color: ${props => props.theme.secondaryBackground};\r\n  position: absolute;\r\n  z-index: 1;\r\n  top: 0;\r\n  right: 0;\r\n  left: 0;\r\n`\r\nexport const StyledLegendInlineList = styled(StyledInlineList)`\r\n  padding: 7px 9px 0px 10px;\r\n`\r\nexport const StyledLegendInlineListItem = styled(StyledInlineListItem)`\r\n  display: inline-block;\r\n  margin-bottom: 3px;\r\n`\r\nexport const StyledPickerListItem = styled(StyledInlineListItem)`\r\n  padding-right: 5px;\r\n  padding-left: 0;\r\n  vertical-align: middle;\r\n  line-height: 0;\r\n`\r\n\r\nexport const StyledPickerSelector = styled.a`\r\n  background-color: #aaa;\r\n  display: inline-block;\r\n  height: 12px;\r\n  width: 12px;\r\n  margin-top: 1px;\r\n  line-height: 0;\r\n  cursor: pointer;\r\n  opacity: 0.4;\r\n  &:hover {\r\n    opacity: 1;\r\n  }\r\n  &.active {\r\n    opacity: 1;\r\n  }\r\n`\r\nexport const StyledCircleSelector = styled(StyledPickerSelector)`\r\n  border-radius: 50%;\r\n`\r\nexport const StyledCaptionSelector = styled.a`\r\n  cursor: pointer;\r\n  user-select: none;\r\n  display: inline-block;\r\n  padding: 1px 6px;\r\n  font-size: 12px;\r\n  line-height: 1em;\r\n  color: #9195a0;\r\n  border: 1px solid #9195a0;\r\n  overflow: hidden;\r\n  border-radius: 0.25em;\r\n  margin-right: 0;\r\n  font-weight: bold;\r\n  &:hover {\r\n    border-color: #aaa;\r\n    color: #aaa;\r\n    text-decoration: none;\r\n  }\r\n  &.active {\r\n    color: white;\r\n    background-color: #9195a0;\r\n  }\r\n`\r\n\r\nexport const StyledFullSizeContainer = styled.div`\r\n  position: relative;\r\n  height: 100%;\r\n`\r\n\r\nexport const StyledInspectorFooterStatusMessage = styled.div`\r\n  font-weight: bold;\r\n`\r\n\r\nexport const StyledZoomHolder = styled.div`\r\n  position: absolute;\r\n  bottom: 39px;\r\n  right: 0;\r\n  padding: 6px 6px 0 6px;\r\n  border-left: #e6e9ef solid 1px;\r\n  border-top: #e6e9ef solid 1px;\r\n  background: #fff;\r\n`\r\n\r\nexport const StyledZoomButton = styled.button`\r\n  display: list-item;\r\n  list-style-type: none;\r\n  font-size: 2em;\r\n  margin-bottom: 10px;\r\n  border: none;\r\n  color: #9b9da2;\r\n  background: transparent;\r\n  border-color: black;\r\n  padding: 2px 6px 3px;\r\n  &:hover {\r\n    color: black;\r\n  }\r\n  &:focus {\r\n    outline: none;\r\n  }\r\n  &.faded {\r\n    opacity: 0.3;\r\n    cursor: auto;\r\n    &:hover {\r\n      color: #9b9da2;\r\n    }\r\n  }\r\n`\r\n","\r\nimport d3 from 'd3'\r\n\r\nconst measureUsingCanvas = function (text, font) {\r\n  const canvasSelection = d3.select('canvas#textMeasurementCanvas').data([this])\r\n  canvasSelection\r\n    .enter()\r\n    .append('canvas')\r\n    .attr('id', 'textMeasurementCanvas')\r\n    .style('display', 'none')\r\n\r\n  const canvas = canvasSelection.node()\r\n  const context = canvas.getContext('2d')\r\n  context.font = font\r\n  return context.measureText(text).width\r\n}\r\n\r\nconst cache = function () {\r\n  const cacheSize = 10000\r\n  const map = {}\r\n  const list = []\r\n  return (key, calc) => {\r\n    const cached = map[key]\r\n    if (cached) {\r\n      return cached\r\n    } else {\r\n      const result = calc()\r\n      if (list.length > cacheSize) {\r\n        delete map[list.splice(0, 1)]\r\n        list.push(key)\r\n      }\r\n      return (map[key] = result)\r\n    }\r\n  }\r\n}\r\n\r\nexport default function (text, fontFamily, fontSize) {\r\n  const font = `normal normal normal ${fontSize}px/normal ${fontFamily}`\r\n  return cache()(text + font, () => measureUsingCanvas(text, font))\r\n}\r\n","\r\nexport default class LoopArrow {\r\n  constructor (\r\n    nodeRadius,\r\n    straightLength,\r\n    spreadDegrees,\r\n    shaftWidth,\r\n    headWidth,\r\n    headLength,\r\n    captionHeight\r\n  ) {\r\n    const spread = (spreadDegrees * Math.PI) / 180\r\n    const r1 = nodeRadius\r\n    const r2 = nodeRadius + headLength\r\n    const r3 = nodeRadius + straightLength\r\n    const loopRadius = r3 * Math.tan(spread / 2)\r\n    const shaftRadius = shaftWidth / 2\r\n    this.shaftLength = loopRadius * 3 + shaftWidth\r\n\r\n    class Point {\r\n      constructor (x, y) {\r\n        this.x = x\r\n        this.y = y\r\n      }\r\n      toString () {\r\n        return `${this.x} ${this.y}`\r\n      }\r\n    }\r\n\r\n    const normalPoint = function (sweep, radius, displacement) {\r\n      const localLoopRadius = radius * Math.tan(spread / 2)\r\n      const cy = radius / Math.cos(spread / 2)\r\n      return new Point(\r\n        (localLoopRadius + displacement) * Math.sin(sweep),\r\n        cy + (localLoopRadius + displacement) * Math.cos(sweep)\r\n      )\r\n    }\r\n    this.midShaftPoint = normalPoint(0, r3, shaftRadius + captionHeight / 2 + 2)\r\n    const startPoint = (radius, displacement) =>\r\n      normalPoint((Math.PI + spread) / 2, radius, displacement)\r\n    const endPoint = (radius, displacement) =>\r\n      normalPoint(-(Math.PI + spread) / 2, radius, displacement)\r\n\r\n    this.outline = function () {\r\n      const inner = loopRadius - shaftRadius\r\n      const outer = loopRadius + shaftRadius\r\n      return [\r\n        'M',\r\n        startPoint(r1, shaftRadius),\r\n        'L',\r\n        startPoint(r3, shaftRadius),\r\n        'A',\r\n        outer,\r\n        outer,\r\n        0,\r\n        1,\r\n        1,\r\n        endPoint(r3, shaftRadius),\r\n        'L',\r\n        endPoint(r2, shaftRadius),\r\n        'L',\r\n        endPoint(r2, -headWidth / 2),\r\n        'L',\r\n        endPoint(r1, 0),\r\n        'L',\r\n        endPoint(r2, headWidth / 2),\r\n        'L',\r\n        endPoint(r2, -shaftRadius),\r\n        'L',\r\n        endPoint(r3, -shaftRadius),\r\n        'A',\r\n        inner,\r\n        inner,\r\n        0,\r\n        1,\r\n        0,\r\n        startPoint(r3, -shaftRadius),\r\n        'L',\r\n        startPoint(r1, -shaftRadius),\r\n        'Z'\r\n      ].join(' ')\r\n    }\r\n\r\n    this.overlay = function (minWidth) {\r\n      const displacement = Math.max(minWidth / 2, shaftRadius)\r\n      const inner = loopRadius - displacement\r\n      const outer = loopRadius + displacement\r\n      return [\r\n        'M',\r\n        startPoint(r1, displacement),\r\n        'L',\r\n        startPoint(r3, displacement),\r\n        'A',\r\n        outer,\r\n        outer,\r\n        0,\r\n        1,\r\n        1,\r\n        endPoint(r3, displacement),\r\n        'L',\r\n        endPoint(r2, displacement),\r\n        'L',\r\n        endPoint(r2, -displacement),\r\n        'L',\r\n        endPoint(r3, -displacement),\r\n        'A',\r\n        inner,\r\n        inner,\r\n        0,\r\n        1,\r\n        0,\r\n        startPoint(r3, -displacement),\r\n        'L',\r\n        startPoint(r1, -displacement),\r\n        'Z'\r\n      ].join(' ')\r\n    }\r\n  }\r\n}\r\n","\r\nexport default class StraightArrow {\r\n  deflection = 0\r\n\r\n  constructor (\r\n    startRadius,\r\n    endRadius,\r\n    centreDistance,\r\n    shaftWidth,\r\n    headWidth,\r\n    headHeight,\r\n    captionLayout\r\n  ) {\r\n    this.length = centreDistance - (startRadius + endRadius)\r\n\r\n    this.shaftLength = this.length - headHeight\r\n    const startArrow = startRadius\r\n    const endShaft = startArrow + this.shaftLength\r\n    const endArrow = startArrow + this.length\r\n    const shaftRadius = shaftWidth / 2\r\n    const headRadius = headWidth / 2\r\n\r\n    this.midShaftPoint = {\r\n      x: startArrow + this.shaftLength / 2,\r\n      y: 0\r\n    }\r\n\r\n    this.outline = function (shortCaptionLength) {\r\n      if (captionLayout === 'external') {\r\n        const startBreak =\r\n          startArrow + (this.shaftLength - shortCaptionLength) / 2\r\n        const endBreak = endShaft - (this.shaftLength - shortCaptionLength) / 2\r\n\r\n        return [\r\n          'M',\r\n          startArrow,\r\n          shaftRadius,\r\n          'L',\r\n          startBreak,\r\n          shaftRadius,\r\n          'L',\r\n          startBreak,\r\n          -shaftRadius,\r\n          'L',\r\n          startArrow,\r\n          -shaftRadius,\r\n          'Z',\r\n          'M',\r\n          endBreak,\r\n          shaftRadius,\r\n          'L',\r\n          endShaft,\r\n          shaftRadius,\r\n          'L',\r\n          endShaft,\r\n          headRadius,\r\n          'L',\r\n          endArrow,\r\n          0,\r\n          'L',\r\n          endShaft,\r\n          -headRadius,\r\n          'L',\r\n          endShaft,\r\n          -shaftRadius,\r\n          'L',\r\n          endBreak,\r\n          -shaftRadius,\r\n          'Z'\r\n        ].join(' ')\r\n      } else {\r\n        return [\r\n          'M',\r\n          startArrow,\r\n          shaftRadius,\r\n          'L',\r\n          endShaft,\r\n          shaftRadius,\r\n          'L',\r\n          endShaft,\r\n          headRadius,\r\n          'L',\r\n          endArrow,\r\n          0,\r\n          'L',\r\n          endShaft,\r\n          -headRadius,\r\n          'L',\r\n          endShaft,\r\n          -shaftRadius,\r\n          'L',\r\n          startArrow,\r\n          -shaftRadius,\r\n          'Z'\r\n        ].join(' ')\r\n      }\r\n    }\r\n\r\n    this.overlay = function (minWidth) {\r\n      const radius = Math.max(minWidth / 2, shaftRadius)\r\n      return [\r\n        'M',\r\n        startArrow,\r\n        radius,\r\n        'L',\r\n        endArrow,\r\n        radius,\r\n        'L',\r\n        endArrow,\r\n        -radius,\r\n        'L',\r\n        startArrow,\r\n        -radius,\r\n        'Z'\r\n      ].join(' ')\r\n    }\r\n  }\r\n}\r\n","\r\nexport default class ArcArrow {\r\n  constructor (\r\n    startRadius,\r\n    endRadius,\r\n    endCentre,\r\n    deflection,\r\n    arrowWidth,\r\n    headWidth,\r\n    headLength,\r\n    captionLayout\r\n  ) {\r\n    this.deflection = deflection\r\n    const square = l => l * l\r\n\r\n    const deflectionRadians = (this.deflection * Math.PI) / 180\r\n    const startAttach = {\r\n      x: Math.cos(deflectionRadians) * startRadius,\r\n      y: Math.sin(deflectionRadians) * startRadius\r\n    }\r\n\r\n    const radiusRatio = startRadius / (endRadius + headLength)\r\n    const homotheticCenter = (-endCentre * radiusRatio) / (1 - radiusRatio)\r\n\r\n    const intersectWithOtherCircle = function (\r\n      fixedPoint,\r\n      radius,\r\n      xCenter,\r\n      polarity\r\n    ) {\r\n      const gradient = fixedPoint.y / (fixedPoint.x - homotheticCenter)\r\n      const hc = fixedPoint.y - gradient * fixedPoint.x\r\n\r\n      const A = 1 + square(gradient)\r\n      const B = 2 * (gradient * hc - xCenter)\r\n      const C = square(hc) + square(xCenter) - square(radius)\r\n\r\n      const intersection = {\r\n        x: (-B + polarity * Math.sqrt(square(B) - 4 * A * C)) / (2 * A)\r\n      }\r\n      intersection.y = (intersection.x - homotheticCenter) * gradient\r\n\r\n      return intersection\r\n    }\r\n\r\n    const endAttach = intersectWithOtherCircle(\r\n      startAttach,\r\n      endRadius + headLength,\r\n      endCentre,\r\n      -1\r\n    )\r\n\r\n    const g1 = -startAttach.x / startAttach.y\r\n    const c1 = startAttach.y + square(startAttach.x) / startAttach.y\r\n    const g2 = -(endAttach.x - endCentre) / endAttach.y\r\n    const c2 =\r\n      endAttach.y + ((endAttach.x - endCentre) * endAttach.x) / endAttach.y\r\n\r\n    const cx = (c1 - c2) / (g2 - g1)\r\n    const cy = g1 * cx + c1\r\n\r\n    const arcRadius = Math.sqrt(\r\n      square(cx - startAttach.x) + square(cy - startAttach.y)\r\n    )\r\n    const startAngle = Math.atan2(startAttach.x - cx, cy - startAttach.y)\r\n    const endAngle = Math.atan2(endAttach.x - cx, cy - endAttach.y)\r\n    let sweepAngle = endAngle - startAngle\r\n    if (this.deflection > 0) {\r\n      sweepAngle = 2 * Math.PI - sweepAngle\r\n    }\r\n\r\n    this.shaftLength = sweepAngle * arcRadius\r\n    if (startAngle > endAngle) {\r\n      this.shaftLength = 0\r\n    }\r\n\r\n    let midShaftAngle = (startAngle + endAngle) / 2\r\n    if (this.deflection > 0) {\r\n      midShaftAngle += Math.PI\r\n    }\r\n    this.midShaftPoint = {\r\n      x: cx + arcRadius * Math.sin(midShaftAngle),\r\n      y: cy - arcRadius * Math.cos(midShaftAngle)\r\n    }\r\n\r\n    const startTangent = function (dr) {\r\n      const dx = (dr < 0 ? 1 : -1) * Math.sqrt(square(dr) / (1 + square(g1)))\r\n      const dy = g1 * dx\r\n      return {\r\n        x: startAttach.x + dx,\r\n        y: startAttach.y + dy\r\n      }\r\n    }\r\n\r\n    const endTangent = function (dr) {\r\n      const dx = (dr < 0 ? -1 : 1) * Math.sqrt(square(dr) / (1 + square(g2)))\r\n      const dy = g2 * dx\r\n      return {\r\n        x: endAttach.x + dx,\r\n        y: endAttach.y + dy\r\n      }\r\n    }\r\n\r\n    const angleTangent = (angle, dr) => ({\r\n      x: cx + (arcRadius + dr) * Math.sin(angle),\r\n      y: cy - (arcRadius + dr) * Math.cos(angle)\r\n    })\r\n\r\n    const endNormal = function (dc) {\r\n      const dx =\r\n        (dc < 0 ? -1 : 1) * Math.sqrt(square(dc) / (1 + square(1 / g2)))\r\n      const dy = dx / g2\r\n      return {\r\n        x: endAttach.x + dx,\r\n        y: endAttach.y - dy\r\n      }\r\n    }\r\n\r\n    const endOverlayCorner = function (dr, dc) {\r\n      const shoulder = endTangent(dr)\r\n      const arrowTip = endNormal(dc)\r\n      return {\r\n        x: shoulder.x + arrowTip.x - endAttach.x,\r\n        y: shoulder.y + arrowTip.y - endAttach.y\r\n      }\r\n    }\r\n\r\n    const coord = point => `${point.x},${point.y}`\r\n\r\n    const shaftRadius = arrowWidth / 2\r\n    const headRadius = headWidth / 2\r\n    const positiveSweep = startAttach.y > 0 ? 0 : 1\r\n    const negativeSweep = startAttach.y < 0 ? 0 : 1\r\n\r\n    this.outline = function (shortCaptionLength) {\r\n      if (startAngle > endAngle) {\r\n        return [\r\n          'M',\r\n          coord(endTangent(-headRadius)),\r\n          'L',\r\n          coord(endNormal(headLength)),\r\n          'L',\r\n          coord(endTangent(headRadius)),\r\n          'Z'\r\n        ].join(' ')\r\n      }\r\n\r\n      if (captionLayout === 'external') {\r\n        let captionSweep = shortCaptionLength / arcRadius\r\n        if (this.deflection > 0) {\r\n          captionSweep *= -1\r\n        }\r\n\r\n        const startBreak = midShaftAngle - captionSweep / 2\r\n        const endBreak = midShaftAngle + captionSweep / 2\r\n\r\n        return [\r\n          'M',\r\n          coord(startTangent(shaftRadius)),\r\n          'L',\r\n          coord(startTangent(-shaftRadius)),\r\n          'A',\r\n          arcRadius - shaftRadius,\r\n          arcRadius - shaftRadius,\r\n          0,\r\n          0,\r\n          positiveSweep,\r\n          coord(angleTangent(startBreak, -shaftRadius)),\r\n          'L',\r\n          coord(angleTangent(startBreak, shaftRadius)),\r\n          'A',\r\n          arcRadius + shaftRadius,\r\n          arcRadius + shaftRadius,\r\n          0,\r\n          0,\r\n          negativeSweep,\r\n          coord(startTangent(shaftRadius)),\r\n          'Z',\r\n          'M',\r\n          coord(angleTangent(endBreak, shaftRadius)),\r\n          'L',\r\n          coord(angleTangent(endBreak, -shaftRadius)),\r\n          'A',\r\n          arcRadius - shaftRadius,\r\n          arcRadius - shaftRadius,\r\n          0,\r\n          0,\r\n          positiveSweep,\r\n          coord(endTangent(-shaftRadius)),\r\n          'L',\r\n          coord(endTangent(-headRadius)),\r\n          'L',\r\n          coord(endNormal(headLength)),\r\n          'L',\r\n          coord(endTangent(headRadius)),\r\n          'L',\r\n          coord(endTangent(shaftRadius)),\r\n          'A',\r\n          arcRadius + shaftRadius,\r\n          arcRadius + shaftRadius,\r\n          0,\r\n          0,\r\n          negativeSweep,\r\n          coord(angleTangent(endBreak, shaftRadius))\r\n        ].join(' ')\r\n      } else {\r\n        return [\r\n          'M',\r\n          coord(startTangent(shaftRadius)),\r\n          'L',\r\n          coord(startTangent(-shaftRadius)),\r\n          'A',\r\n          arcRadius - shaftRadius,\r\n          arcRadius - shaftRadius,\r\n          0,\r\n          0,\r\n          positiveSweep,\r\n          coord(endTangent(-shaftRadius)),\r\n          'L',\r\n          coord(endTangent(-headRadius)),\r\n          'L',\r\n          coord(endNormal(headLength)),\r\n          'L',\r\n          coord(endTangent(headRadius)),\r\n          'L',\r\n          coord(endTangent(shaftRadius)),\r\n          'A',\r\n          arcRadius + shaftRadius,\r\n          arcRadius + shaftRadius,\r\n          0,\r\n          0,\r\n          negativeSweep,\r\n          coord(startTangent(shaftRadius))\r\n        ].join(' ')\r\n      }\r\n    }\r\n\r\n    this.overlay = function (minWidth) {\r\n      const radius = Math.max(minWidth / 2, shaftRadius)\r\n\r\n      return [\r\n        'M',\r\n        coord(startTangent(radius)),\r\n        'L',\r\n        coord(startTangent(-radius)),\r\n        'A',\r\n        arcRadius - radius,\r\n        arcRadius - radius,\r\n        0,\r\n        0,\r\n        positiveSweep,\r\n        coord(endTangent(-radius)),\r\n        'L',\r\n        coord(endOverlayCorner(-radius, headLength)),\r\n        'L',\r\n        coord(endOverlayCorner(radius, headLength)),\r\n        'L',\r\n        coord(endTangent(radius)),\r\n        'A',\r\n        arcRadius + radius,\r\n        arcRadius + radius,\r\n        0,\r\n        0,\r\n        negativeSweep,\r\n        coord(startTangent(radius))\r\n      ].join(' ')\r\n    }\r\n  }\r\n}\r\n","\r\nimport measureText from './textMeasurement'\r\nimport LoopArrow from './loopArrow'\r\nimport StraightArrow from './straightArrow'\r\nimport ArcArrow from './arcArrow'\r\n\r\nexport default class PairwiseArcsRelationshipRouting {\r\n  constructor (style) {\r\n    this.style = style\r\n  }\r\n\r\n  measureRelationshipCaption (relationship, caption) {\r\n    const fontFamily = 'sans-serif'\r\n    const padding = parseFloat(\r\n      this.style.forRelationship(relationship).get('padding')\r\n    )\r\n    return (\r\n      measureText(caption, fontFamily, relationship.captionHeight) + padding * 2\r\n    )\r\n  }\r\n\r\n  captionFitsInsideArrowShaftWidth (relationship) {\r\n    return (\r\n      parseFloat(this.style.forRelationship(relationship).get('shaft-width')) >\r\n      relationship.captionHeight\r\n    )\r\n  }\r\n\r\n  measureRelationshipCaptions (relationships) {\r\n    return (() => {\r\n      const result = []\r\n      for (let relationship of Array.from(relationships)) {\r\n        relationship.captionHeight = parseFloat(\r\n          this.style.forRelationship(relationship).get('font-size')\r\n        )\r\n        relationship.captionLength = this.measureRelationshipCaption(\r\n          relationship,\r\n          relationship.caption\r\n        )\r\n        result.push(\r\n          (relationship.captionLayout =\r\n            this.captionFitsInsideArrowShaftWidth(relationship) &&\r\n            !relationship.isLoop()\r\n              ? 'internal'\r\n              : 'external')\r\n        )\r\n      }\r\n      return result\r\n    })()\r\n  }\r\n\r\n  shortenCaption (relationship, caption, targetWidth) {\r\n    let shortCaption = caption || 'caption'\r\n    while (true) {\r\n      if (shortCaption.length <= 2) {\r\n        return ['', 0]\r\n      }\r\n      shortCaption = shortCaption.substr(0, shortCaption.length - 2) + '\\u2026'\r\n      const width = this.measureRelationshipCaption(relationship, shortCaption)\r\n      if (width < targetWidth) {\r\n        return [shortCaption, width]\r\n      }\r\n    }\r\n  }\r\n\r\n  computeGeometryForNonLoopArrows (nodePairs) {\r\n    const square = distance => distance * distance\r\n    return (() => {\r\n      const result = []\r\n      for (var nodePair of Array.from(nodePairs)) {\r\n        if (!nodePair.isLoop()) {\r\n          const dx = nodePair.nodeA.x - nodePair.nodeB.x\r\n          const dy = nodePair.nodeA.y - nodePair.nodeB.y\r\n          var angle = ((Math.atan2(dy, dx) / Math.PI) * 180 + 360) % 360\r\n          var centreDistance = Math.sqrt(square(dx) + square(dy))\r\n          result.push(\r\n            (() => {\r\n              const result1 = []\r\n              for (let relationship of Array.from(nodePair.relationships)) {\r\n                relationship.naturalAngle =\r\n                  relationship.target === nodePair.nodeA\r\n                    ? (angle + 180) % 360\r\n                    : angle\r\n                result1.push((relationship.centreDistance = centreDistance))\r\n              }\r\n              return result1\r\n            })()\r\n          )\r\n        } else {\r\n          result.push(undefined)\r\n        }\r\n      }\r\n      return result\r\n    })()\r\n  }\r\n\r\n  distributeAnglesForLoopArrows (nodePairs, relationships) {\r\n    return (() => {\r\n      const result = []\r\n      for (var nodePair of Array.from(nodePairs)) {\r\n        if (nodePair.isLoop()) {\r\n          var i, separation\r\n          let angles = []\r\n          const node = nodePair.nodeA\r\n          for (var relationship of Array.from(relationships)) {\r\n            if (!relationship.isLoop()) {\r\n              if (relationship.source === node) {\r\n                angles.push(relationship.naturalAngle)\r\n              }\r\n              if (relationship.target === node) {\r\n                angles.push(relationship.naturalAngle + 180)\r\n              }\r\n            }\r\n          }\r\n          angles = angles.map(a => (a + 360) % 360).sort((a, b) => a - b)\r\n          if (angles.length > 0) {\r\n            var end, start\r\n            var biggestGap = {\r\n              start: 0,\r\n              end: 0\r\n            }\r\n            for (i = 0; i < angles.length; i++) {\r\n              const angle = angles[i]\r\n              start = angle\r\n              end = i === angles.length - 1 ? angles[0] + 360 : angles[i + 1]\r\n              if (end - start > biggestGap.end - biggestGap.start) {\r\n                biggestGap.start = start\r\n                biggestGap.end = end\r\n              }\r\n            }\r\n            separation =\r\n              (biggestGap.end - biggestGap.start) /\r\n              (nodePair.relationships.length + 1)\r\n            result.push(\r\n              (() => {\r\n                const result1 = []\r\n                for (i = 0; i < nodePair.relationships.length; i++) {\r\n                  relationship = nodePair.relationships[i]\r\n                  result1.push(\r\n                    (relationship.naturalAngle =\r\n                      (biggestGap.start + (i + 1) * separation - 90) % 360)\r\n                  )\r\n                }\r\n                return result1\r\n              })()\r\n            )\r\n          } else {\r\n            separation = 360 / nodePair.relationships.length\r\n            result.push(\r\n              (() => {\r\n                const result2 = []\r\n                for (i = 0; i < nodePair.relationships.length; i++) {\r\n                  relationship = nodePair.relationships[i]\r\n                  result2.push((relationship.naturalAngle = i * separation))\r\n                }\r\n                return result2\r\n              })()\r\n            )\r\n          }\r\n        } else {\r\n          result.push(undefined)\r\n        }\r\n      }\r\n      return result\r\n    })()\r\n  }\r\n\r\n  layoutRelationships (graph) {\r\n    const nodePairs = graph.groupedRelationships()\r\n    this.computeGeometryForNonLoopArrows(nodePairs)\r\n    this.distributeAnglesForLoopArrows(nodePairs, graph.relationships())\r\n\r\n    return (() => {\r\n      const result = []\r\n      for (var nodePair of Array.from(nodePairs)) {\r\n        for (var relationship of Array.from(nodePair.relationships)) {\r\n          delete relationship.arrow\r\n        }\r\n\r\n        var middleRelationshipIndex = (nodePair.relationships.length - 1) / 2\r\n        var defaultDeflectionStep = 30\r\n        const maximumTotalDeflection = 150\r\n        const numberOfSteps = nodePair.relationships.length - 1\r\n        const totalDeflection = defaultDeflectionStep * numberOfSteps\r\n\r\n        var deflectionStep =\r\n          totalDeflection > maximumTotalDeflection\r\n            ? maximumTotalDeflection / numberOfSteps\r\n            : defaultDeflectionStep\r\n\r\n        result.push(\r\n          (() => {\r\n            const result1 = []\r\n            for (let i = 0; i < nodePair.relationships.length; i++) {\r\n              var ref\r\n              relationship = nodePair.relationships[i]\r\n              const shaftWidth =\r\n                parseFloat(\r\n                  this.style.forRelationship(relationship).get('shaft-width')\r\n                ) || 2\r\n              const headWidth = shaftWidth + 6\r\n              const headHeight = headWidth\r\n\r\n              if (nodePair.isLoop()) {\r\n                relationship.arrow = new LoopArrow(\r\n                  relationship.source.radius,\r\n                  40,\r\n                  defaultDeflectionStep,\r\n                  shaftWidth,\r\n                  headWidth,\r\n                  headHeight,\r\n                  relationship.captionHeight\r\n                )\r\n              } else {\r\n                if (i === middleRelationshipIndex) {\r\n                  relationship.arrow = new StraightArrow(\r\n                    relationship.source.radius,\r\n                    relationship.target.radius,\r\n                    relationship.centreDistance,\r\n                    shaftWidth,\r\n                    headWidth,\r\n                    headHeight,\r\n                    relationship.captionLayout\r\n                  )\r\n                } else {\r\n                  let deflection =\r\n                    deflectionStep * (i - middleRelationshipIndex)\r\n\r\n                  if (nodePair.nodeA !== relationship.source) {\r\n                    deflection *= -1\r\n                  }\r\n\r\n                  relationship.arrow = new ArcArrow(\r\n                    relationship.source.radius,\r\n                    relationship.target.radius,\r\n                    relationship.centreDistance,\r\n                    deflection,\r\n                    shaftWidth,\r\n                    headWidth,\r\n                    headHeight,\r\n                    relationship.captionLayout\r\n                  )\r\n                }\r\n              }\r\n\r\n              result1.push(\r\n                ([\r\n                  relationship.shortCaption,\r\n                  relationship.shortCaptionLength\r\n                ] = Array.from(\r\n                  (ref =\r\n                    relationship.arrow.shaftLength > relationship.captionLength\r\n                      ? [relationship.caption, relationship.captionLength]\r\n                      : this.shortenCaption(\r\n                        relationship,\r\n                        relationship.caption,\r\n                        relationship.arrow.shaftLength\r\n                      ))\r\n                )),\r\n                ref\r\n              )\r\n            }\r\n            return result1\r\n          })()\r\n        )\r\n      }\r\n      return result\r\n    })()\r\n  }\r\n}\r\n","\r\nimport PairwiseArcsRelationshipRouting from '../utils/pairwiseArcsRelationshipRouting'\r\nimport measureText from '../utils/textMeasurement'\r\n\r\nexport default class NeoD3Geometry {\r\n  constructor (style) {\r\n    this.style = style\r\n    this.relationshipRouting = new PairwiseArcsRelationshipRouting(this.style)\r\n  }\r\n  formatNodeCaptions (nodes) {\r\n    return Array.from(nodes).map(\r\n      node => node.caption = fitCaptionIntoCircle(node, this.style)\r\n    )\r\n  }\r\n\r\n  formatRelationshipCaptions (relationships) {\r\n    return (() => {\r\n      const result = []\r\n      for (let relationship of Array.from(relationships)) {\r\n        const template = this.style.forRelationship(relationship).get('caption')\r\n        result.push(\r\n          (relationship.caption = this.style.interpolate(\r\n            template,\r\n            relationship\r\n          ))\r\n        )\r\n      }\r\n      return result\r\n    })()\r\n  }\r\n\r\n  setNodeRadii (nodes) {\r\n    return Array.from(nodes).map(\r\n      node =>\r\n        (node.radius = parseFloat(this.style.forNode(node).get('diameter')) / 2)\r\n    )\r\n  }\r\n\r\n  onGraphChange (graph) {\r\n    this.setNodeRadii(graph.nodes())\r\n    this.formatNodeCaptions(graph.nodes())\r\n    this.formatRelationshipCaptions(graph.relationships())\r\n    return this.relationshipRouting.measureRelationshipCaptions(\r\n      graph.relationships()\r\n    )\r\n  }\r\n\r\n  onTick (graph) {\r\n    return this.relationshipRouting.layoutRelationships(graph)\r\n  }\r\n}\r\n\r\nlet square = distance => distance * distance\r\nlet addShortenedNextWord = (line, word, measure) => {\r\n  const result = []\r\n  while (!(word.length <= 2)) {\r\n    word = word.substr(0, word.length - 2) + '\\u2026'\r\n    if (measure(word) < line.remainingWidth) {\r\n      line.text += ` ${word}`\r\n      break\r\n    } else {\r\n      result.push(undefined)\r\n    }\r\n  }\r\n  return result\r\n}\r\nlet noEmptyLines = function (lines) {\r\n  for (let line of Array.from(lines)) {\r\n    if (line.text.length === 0) {\r\n      return false\r\n    }\r\n  }\r\n  return true\r\n}\r\n\r\nlet fitCaptionIntoCircle = function (node, style) {\r\n  const template = style.forNode(node).get('caption')\r\n  // 获取显示的文字信息\r\n  let captionText = style.interpolate(template, node)\r\n  const fontFamily = 'sans-serif'\r\n  const fontSize = parseFloat(style.forNode(node).get('font-size'))\r\n  const lineHeight = fontSize\r\n  const measure = text => measureText(text, fontFamily, fontSize)\r\n\r\n  const words = captionText.split(' ')\r\n\r\n  const emptyLine = function (lineCount, iLine) {\r\n    let baseline = (1 + iLine - lineCount / 2) * lineHeight\r\n    if (style.forNode(node).get('icon-code')) {\r\n      baseline = baseline + node.radius / 3\r\n    }\r\n    const containingHeight =\r\n      iLine < lineCount / 2 ? baseline - lineHeight : baseline\r\n    const lineWidth =\r\n      Math.sqrt(square(node.radius) - square(containingHeight)) * 2\r\n    return {\r\n      node,\r\n      text: '',\r\n      baseline,\r\n      remainingWidth: lineWidth\r\n    }\r\n  }\r\n\r\n  const fitOnFixedNumberOfLines = function (lineCount) {\r\n    const lines = []\r\n    let iWord = 0\r\n    for (\r\n      let iLine = 0, end = lineCount - 1, asc = end >= 0;\r\n      asc ? iLine <= end : iLine >= end;\r\n      asc ? iLine++ : iLine--\r\n    ) {\r\n      const line = emptyLine(lineCount, iLine)\r\n      while (\r\n        iWord < words.length &&\r\n        measure(` ${words[iWord]}`) < line.remainingWidth\r\n      ) {\r\n        line.text += ` ${words[iWord]}`\r\n        line.remainingWidth -= measure(` ${words[iWord]}`)\r\n        iWord++\r\n      }\r\n      lines.push(line)\r\n    }\r\n    if (iWord < words.length) {\r\n      addShortenedNextWord(lines[lineCount - 1], words[iWord], measure)\r\n    }\r\n    return [lines, iWord]\r\n  }\r\n\r\n  let consumedWords = 0\r\n  const maxLines = (node.radius * 2) / fontSize\r\n\r\n  let lines = [emptyLine(1, 0)]\r\n  for (\r\n    let lineCount = 1, end = maxLines, asc = end >= 1;\r\n    asc ? lineCount <= end : lineCount >= end;\r\n    asc ? lineCount++ : lineCount--\r\n  ) {\r\n    const [candidateLines, candidateWords] = Array.from(\r\n      fitOnFixedNumberOfLines(lineCount)\r\n    )\r\n    if (noEmptyLines(candidateLines)) {\r\n      ;[lines, consumedWords] = Array.from([candidateLines, candidateWords])\r\n    }\r\n    if (consumedWords >= words.length) {\r\n      return lines\r\n    }\r\n  }\r\n  return lines\r\n}\r\n","\r\n\r\nconst icons = {\r\n  'Expand / Collapse':\r\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"icon\"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>Expand / Collapse</title><circle class=\"a\" cx=\"13.5\" cy=\"10.498\" r=\"3.75\"/><circle class=\"a\" cx=\"21\" cy=\"2.998\" r=\"2.25\"/><circle class=\"a\" cx=\"21\" cy=\"15.748\" r=\"2.25\"/><circle class=\"a\" cx=\"13.5\" cy=\"20.998\" r=\"2.25\"/><circle class=\"a\" cx=\"3\" cy=\"20.998\" r=\"2.25\"/><circle class=\"a\" cx=\"3.75\" cy=\"5.248\" r=\"2.25\"/><line class=\"a\" x1=\"16.151\" y1=\"7.848\" x2=\"19.411\" y2=\"4.588\"/><line class=\"a\" x1=\"16.794\" y1=\"12.292\" x2=\"19.079\" y2=\"14.577\"/><line class=\"a\" x1=\"13.5\" y1=\"14.248\" x2=\"13.5\" y2=\"18.748\"/><line class=\"a\" x1=\"10.851\" y1=\"13.147\" x2=\"4.59\" y2=\"19.408\"/><line class=\"a\" x1=\"10.001\" y1=\"9.149\" x2=\"5.61\" y2=\"6.514\"/></g></svg>',\r\n  Unlock:\r\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"icon\"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>Unlock</title><path class=\"a\" d=\"M.75,9.75V6a5.25,5.25,0,0,1,10.5,0V9.75\"/><rect class=\"a\" x=\"6.75\" y=\"9.75\" width=\"16.5\" height=\"13.5\" rx=\"1.5\" ry=\"1.5\"/><line class=\"a\" x1=\"15\" y1=\"15\" x2=\"15\" y2=\"18\"/></g></svg>',\r\n  New : \r\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"icon\"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>news</title><polygon fill-rule=\"evenodd\"  points=\"13 11 22 11 22 13 13 13 13 22 11 22 11 13 2 13 2 11 11 11 11 2 13 2\"/></g></svg>',\r\n  Delete : \r\n  '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"icon\"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>news</title><path fill=\"#333333\" d=\"M19.376,9.81c-0.016-0.1-0.077-0.197-0.168-0.29c-0.733,0.745-3.683,0.868-7.209,0.868s-6.473-0.123-7.21-0.868C4.699,9.613,4.642,9.71,4.621,9.81H4.615l0.002,0.054c0,0.006-0.002,0.012-0.002,0.019c0,0.014,0.004,0.028,0.006,0.041l0.574,11.76h0.001C5.247,22.606,6.303,24,11.999,24c5.696,0,6.753-1.394,6.803-2.316h0.004l0.575-11.76c0.001-0.014,0.006-0.027,0.006-0.041c0-0.006-0.004-0.012-0.004-0.019l0.004-0.054H19.376z\"/><path fill=\"#333333\" d=\"M15.509,3.655V0.806c0-0.464-0.38-0.844-0.844-0.844H9.026c-0.463,0-0.842,0.379-0.842,0.842v2.882C5.467,3.994,3.607,4.618,3.607,5.341v1.373c0,0.282,0.285,0.55,0.797,0.792c1.34,0.629,4.238,1.066,7.595,1.066c3.36,0,6.256-0.437,7.598-1.066c0.509-0.242,0.796-0.51,0.796-0.792V5.341C20.393,4.593,18.389,3.949,15.509,3.655z M9.941,3.54L9.709,3.554v-1.15c0-0.503,0.07-0.915,0.153-0.915c0.085,0,0.565,0,1.069,0h1.831c0.501,0,0.983,0,1.067,0c0.084,0,0.153,0.412,0.153,0.915v1.132c-0.637-0.033-1.299-0.054-1.985-0.054C11.288,3.482,10.598,3.503,9.941,3.54z\"/></g></svg>',\r\n  Edit : \r\n  '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"icon\"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>edit</title> <path fill-rule=\"evenodd\" d=\"M14.8024118,6.44526791 L8.69610276,12.549589 C8.29095108,12.9079238 8.04030835,13.4092335 8,13.8678295 L8,16.0029438 L10.0639829,16.004826 C10.5982069,15.9670062 11.0954869,15.7183782 11.4947932,15.2616227 L17.556693,9.19972295 L14.8024118,6.44526791 Z M16.2168556,5.0312846 L18.9709065,7.78550938 L19.8647941,6.89162181 C19.9513987,6.80501747 20.0000526,6.68755666 20.0000526,6.56507948 C20.0000526,6.4426023 19.9513987,6.32514149 19.8647932,6.23853626 L17.7611243,4.13485646 C17.6754884,4.04854589 17.5589355,4 17.43735,4 C17.3157645,4 17.1992116,4.04854589 17.1135757,4.13485646 L16.2168556,5.0312846 Z M22,13 L22,20 C22,21.1045695 21.1045695,22 20,22 L4,22 C2.8954305,22 2,21.1045695 2,20 L2,4 C2,2.8954305 2.8954305,2 4,2 L11,2 L11,4 L4,4 L4,20 L20,20 L20,13 L22,13 Z M17.43735,2 C18.0920882,2 18.7197259,2.26141978 19.1781068,2.7234227 L21.2790059,4.82432181 C21.7406843,5.28599904 22.0000526,5.91216845 22.0000526,6.56507948 C22.0000526,7.21799052 21.7406843,7.84415992 21.2790068,8.30583626 L12.9575072,16.6237545 C12.2590245,17.4294925 11.2689,17.9245308 10.1346,18.0023295 L6,18.0023295 L6,17.0023295 L6.00324765,13.7873015 C6.08843822,12.7328366 6.57866679,11.7523321 7.32649633,11.0934196 L15.6953877,2.72462818 C16.1563921,2.2608295 16.7833514,2 17.43735,2 Z\"/></g></svg>',  \r\n    Remove:\r\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g class=\"icon\"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>Remove</title><path class=\"a\" d=\"M8.153,13.664a12.271,12.271,0,0,1-5.936-4.15L1.008,7.96a.75.75,0,0,1,0-.92L2.217,5.486A12.268,12.268,0,0,1,11.9.75h0a12.269,12.269,0,0,1,9.684,4.736L22.792,7.04a.748.748,0,0,1,0,.92L21.584,9.514\"/><path class=\"a\" d=\"M10.4,10.937A3.749,3.749,0,1,1,15.338,9\"/><circle class=\"a\" cx=\"17.15\" cy=\"17.25\" r=\"6\"/><line class=\"a\" x1=\"14.15\" y1=\"17.25\" x2=\"20.15\" y2=\"17.25\"/></g></svg>'\r\n}\r\n\r\nexport default icons\r\n","import d3 from 'd3'\r\nimport Renderer from '../components/renderer'\r\nimport icons from '../renders/icons'\r\n\r\nconst noop = function () {}\r\n\r\n// TODO:\r\nconst numberOfItemsInContextMenu = 6\r\n\r\nconst arc = function (radius, itemNumber, width) {\r\n  if (width == null) {\r\n    width = 30\r\n  }\r\n  itemNumber = itemNumber - 1\r\n  const startAngle = ((2 * Math.PI) / numberOfItemsInContextMenu) * itemNumber\r\n  const endAngle = startAngle + (2 * Math.PI) / numberOfItemsInContextMenu\r\n  const innerRadius = Math.max(radius + 8, 20)\r\n  return d3.svg\r\n    .arc()\r\n    .innerRadius(innerRadius)\r\n    .outerRadius(innerRadius + width)\r\n    .startAngle(startAngle)\r\n    .endAngle(endAngle)\r\n    .padAngle(0.03)\r\n}\r\n// 获取选中的node\r\nconst getSelectedNode = function (node) {\r\n  if (node.selected) {\r\n    return [node]\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nconst attachContextEvent = (event, elems, viz, content, label) =>\r\n  (() => {\r\n    const result = []\r\n    for (let elem of Array.from(elems)) {\r\n      elem.on('mousedown.drag', function () {\r\n        d3.event.stopPropagation()\r\n        return null\r\n      })\r\n      elem.on('mouseup', node => viz.trigger(event, node))\r\n      elem.on('mouseover', function (node) {\r\n        node.contextMenu = {\r\n          menuSelection: event,\r\n          menuContent: content,\r\n          label\r\n        }\r\n        return viz.trigger('menuMouseOver', node)\r\n      })\r\n      result.push(\r\n        elem.on('mouseout', function (node) {\r\n          delete node.contextMenu\r\n          return viz.trigger('menuMouseOut', node)\r\n        })\r\n      )\r\n    }\r\n    return result\r\n  })()\r\n\r\nconst createMenuItem = function (\r\n  selection,\r\n  viz,\r\n  eventName,\r\n  itemNumber,\r\n  className,\r\n  position,\r\n  textValue,\r\n  helpValue\r\n) {\r\n  const path = selection.selectAll(`path.${className}`).data(getSelectedNode)\r\n  const iconPath = selection\r\n    .selectAll(`.icon.${className}`)\r\n    .data(getSelectedNode)\r\n\r\n  const tab = path\r\n    .enter()\r\n    .append('path')\r\n    .classed(className, true)\r\n    .classed('context-menu-item', true)\r\n    .attr({\r\n      d (node) {\r\n        return arc(node.radius, itemNumber, 1)()\r\n      }\r\n    })\r\n\r\n  const rawSvgIcon = icons[textValue];\r\n  // console.log(icons);\r\n  // console.log(rawSvgIcon)\r\n  const icon = iconPath\r\n    .enter()\r\n    .appendSVG(rawSvgIcon)\r\n    .classed(className, true)\r\n    .classed('context-menu-item', true)\r\n    .attr({\r\n      transform (node) {\r\n        return (\r\n          'translate(' +\r\n          Math.floor(\r\n            arc(node.radius, itemNumber).centroid()[0] +\r\n              (position[0] * 100) / 100\r\n          ) +\r\n          ',' +\r\n          Math.floor(\r\n            arc(node.radius, itemNumber).centroid()[1] +\r\n              (position[1] * 100) / 100\r\n          ) +\r\n          ')' +\r\n          ' ' +\r\n          'scale(0.7)'\r\n        )\r\n      },\r\n      color (node) {\r\n        return viz.style.forNode(node).get('text-color-internal')\r\n      },\r\n      fill(node){\r\n        return  viz.style.forNode(node).get('text-color-internal')\r\n      }\r\n    })\r\n  attachContextEvent(eventName, [tab, icon], viz, helpValue, rawSvgIcon)\r\n\r\n  tab\r\n    .transition()\r\n    .duration(200)\r\n    .attr({\r\n      d (node) {\r\n        return arc(node.radius, itemNumber)()\r\n      }\r\n    })\r\n\r\n  path\r\n    .exit()\r\n    .transition()\r\n    .duration(200)\r\n    .attr({\r\n      d (node) {\r\n        return arc(node.radius, itemNumber, 1)()\r\n      }\r\n    })\r\n    .remove()\r\n\r\n  return iconPath.exit().remove()\r\n}\r\n\r\nconst donutRemoveNode = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'nodeClose',\r\n      1,\r\n      'remove_node',\r\n      [-8, -8],\r\n      'Remove',\r\n      'Dismiss'\r\n    )\r\n  },\r\n\r\n  onTick: noop\r\n})\r\n\r\n\r\nconst donutExpandNode = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'nodeDblClicked',\r\n      2,\r\n      'expand_node',\r\n      [-8, -8],\r\n      'Expand / Collapse',\r\n      'Expand / Collapse child relationships'\r\n    )\r\n  },\r\n\r\n  onTick: noop\r\n})\r\n\r\nconst donutUnlockNode = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'nodeUnlock',\r\n      3,\r\n      'unlock_node',\r\n      [-8, -6],\r\n      'Unlock',\r\n      'Unlock the node to re-layout the graph'\r\n    )\r\n  },\r\n\r\n  onTick: noop\r\n})\r\n\r\n\r\n\r\n\r\nconst donutDeleteNode = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'nodeDelete',\r\n      4,\r\n      'delete_node',\r\n      [-10, -12],\r\n      'Delete',\r\n      'delete node'\r\n    )\r\n  },\r\n  onTick: noop\r\n\r\n})\r\n\r\n\r\nconst donutNewNode = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'nodeNew',\r\n      5,\r\n      'new_node',\r\n      [-9, -9],\r\n      'New',\r\n      'new node'\r\n    )\r\n  },\r\n  onTick: noop\r\n\r\n})\r\n\r\n\r\n\r\nconst donutEditNode = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'nodeEdit',\r\n      6,\r\n      'edit_node',\r\n      [-6, -6],\r\n      'Edit',\r\n      'edit node'\r\n    )\r\n  },\r\n  onTick: noop\r\n\r\n})\r\n\r\n\r\nconst menu = []\r\n\r\nmenu.push(donutExpandNode)\r\nmenu.push(donutRemoveNode)\r\nmenu.push(donutUnlockNode)\r\nmenu.push(donutDeleteNode)\r\nmenu.push(donutNewNode)\r\nmenu.push(donutEditNode)\r\n\r\nexport { menu }\r\n","\r\nimport d3 from \"d3\"\r\nimport Renderer from '../components/renderer'\r\n\r\nconst noop = function () {}\r\n\r\n// 获取选中的node\r\nconst getRightClickedNode = function (node) {\r\n  if (node.rightClicked) {\r\n    return [node]\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nconst attachContextEvent = (event, elems, viz, content) =>\r\n  (() => {\r\n    const result = []\r\n    for (let elem of Array.from(elems)) {\r\n      elem.on('mousedown.drag', function () {\r\n        d3.event.stopPropagation()\r\n        return null\r\n      })\r\n      elem.on('mouseup', node => viz.trigger(event, node))\r\n    }  \r\n    return result\r\n  })()\r\n\r\nconst createMenuItem = function (\r\n  selection,\r\n  viz,\r\n  eventName,\r\n  itemNumber,\r\n  className,\r\n  text\r\n) {\r\n  let g = selection.selectAll(`.right-menu.${className}`);\r\n  g.remove();\r\n  let g1 =  selection.selectAll(`.right-menu.${className}`).data(getRightClickedNode)\r\n    .enter()\r\n    .append('g')\r\n    .classed(className,true)\r\n    .classed('right-menu',true)\r\n  let rec =   g1.append('rect')\r\n    .attr({\r\n      width : 100,\r\n      height : 20,\r\n      fill : 'white',\r\n      stroke : '#e8e8e8',\r\n      'stroke-width':1,\r\n    })\r\n  let txt =   g1.append('text')\r\n    .text(text)\r\n    .classed('right-menu-text',true)\r\n    .attr({\r\n        x : 10,\r\n        y : 10,\r\n    })\r\n\r\n    g1.attr({\r\n      transform : `translate(40,${20*itemNumber})`,\r\n    })\r\n  attachContextEvent(eventName, [rec,txt] , viz, text)\r\n\r\n  return;\r\n}\r\n\r\nconst donutClearNode = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'clearSelected',\r\n      0,\r\n      'clear_selected',\r\n      '清除选择'\r\n    )\r\n  },\r\n\r\n  onTick: noop\r\n})\r\nconst donutContraryNode = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'contrarySelected',\r\n      1,\r\n      'contrary_selected',\r\n      '反选'\r\n    )\r\n  },\r\n\r\n  onTick: noop\r\n})\r\n\r\nconst donutBackStatus = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'backStatus',\r\n      2,\r\n      'back_status',\r\n      '上一步'\r\n    )\r\n  },\r\n\r\n  onTick: noop\r\n})\r\nconst donutInitStatus = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'initStatus',\r\n      3,\r\n      'init_status',\r\n      '初始化'\r\n    )\r\n  },\r\n  onTick: noop\r\n})\r\nconst donutMadeChart = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'madeChart',\r\n      4,\r\n      'made_chart',\r\n      '生成图'\r\n    )\r\n  },\r\n  onTick: noop\r\n})\r\nconst donutStartFrame = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'startFrame',\r\n      3,\r\n      'start_frame',\r\n      '播放动画'\r\n    )\r\n  },\r\n  onTick: noop\r\n})\r\n\r\nconst donutAddRel = new Renderer({\r\n  onGraphChange (selection, viz) {\r\n    return createMenuItem(\r\n      selection,\r\n      viz,\r\n      'addRel',\r\n      1,\r\n      'add_rel',\r\n      '新增边'\r\n    )\r\n  },\r\n  onTick: noop\r\n})\r\n\r\nconst rightMenu = []\r\nconst rightMenu1 = []\r\n\r\nrightMenu.push(donutClearNode)\r\nrightMenu.push(donutContraryNode)\r\nrightMenu.push(donutBackStatus)\r\nrightMenu.push(donutInitStatus)\r\nrightMenu.push(donutMadeChart)\r\n// rightMenu.push(donutStartFrame)\r\nrightMenu1.push(donutAddRel)\r\n\r\n\r\nexport { rightMenu , rightMenu1 }\r\n","\r\nimport d3 from 'd3'\r\nexport default function clickHandler () {\r\n  const cc = function (selection) {\r\n    // euclidean distance\r\n    const dist = (a, b) =>\r\n      Math.sqrt(Math.pow(a[0] - b[0], 2), Math.pow(a[1] - b[1], 2))\r\n    let down\r\n    const tolerance = 5\r\n    let wait = null\r\n    selection.on('mousedown', function () {\r\n      d3.event.target.__data__.fixed = true\r\n      down = d3.mouse(document.body)\r\n      return d3.event.stopPropagation()\r\n    })\r\n\r\n    return selection.on('mouseup', function () {\r\n      if (dist(down, d3.mouse(document.body)) > tolerance) {\r\n      } else {\r\n        if (wait) {\r\n          window.clearTimeout(wait)\r\n          wait = null\r\n          return event.dblclick(d3.event.target.__data__)\r\n        } else {\r\n          event.click(d3.event.target.__data__)\r\n          return (wait = window.setTimeout(\r\n            (e => () => (wait = null))(d3.event),\r\n            250\r\n          ))\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  var event = d3.dispatch('click', 'dblclick')\r\n  return d3.rebind(cc, event, 'on')\r\n}\r\n","import d3 from 'd3'\r\nimport NeoD3Geometry from './graphGeometry'\r\nimport * as vizRenderers from '../renders/init'\r\nimport { menu as menuRenderer } from '../renders/menu'\r\nimport { rightMenu , rightMenu1} from '../renders/rightMenu'\r\nimport vizClickHandler from '../utils/clickHandler'\r\n\r\nconst vizFn = function (el, measureSize, graph, layout, style) {\r\n  const viz = { style }\r\n  const root = d3.select(el)\r\n  const baseGroup = root.append('g').attr('transform', 'translate(0,0)')\r\n  // 渲染底层画布\r\n  const rect = baseGroup\r\n    .append('rect')\r\n    .style('fill', 'none')\r\n    .style('pointer-events', 'all')\r\n    // Make the rect cover the whole surface\r\n    .attr('x', '-2500')\r\n    .attr('y', '-2500')\r\n    .attr('width', '5000')\r\n    .attr('height', '5000')\r\n    .attr('transform', 'scale(1)')\r\n// 渲染显示节点的g组\r\n  const container = baseGroup.append('g')\r\n  const geometry = new NeoD3Geometry(style)\r\n\r\n\r\n  // This flags that a panning is ongoing and won't trigger\r\n  // 'canvasClick' event when panning ends.\r\n  let draw = false\r\n\r\n  // Arbitrary dimension used to keep force layout aligned with\r\n  // the centre of the svg view-port.\r\n  const layoutDimension = 200\r\n\r\n  let updateViz = true\r\n\r\n  // To be overridden\r\n  viz.trigger = function (event, ...args) {\r\n    console.log(event);\r\n  }\r\n\r\n  \r\n  const onNodeClick = node => {\r\n    updateViz = false\r\n    if(d3.event.button ==  0){\r\n      if(d3.event.ctrlKey){\r\n        graph.isCtrlClick = true;\r\n        return viz.trigger('nodeCtrlClick',node)\r\n      }else{\r\n        return viz.trigger('nodeClicked', node)\r\n      }\r\n    }else{\r\n      return viz.trigger('nodeClickRight',node)\r\n    }\r\n  }\r\n\r\n  const onNodeDblClick = node => viz.trigger('nodeDblClicked', node)\r\n\r\n  const onNodeDragToggle = node => viz.trigger('nodeDragToggle', node)\r\n\r\n  const onRelationshipClick = relationship => {\r\n    d3.event.stopPropagation()\r\n    updateViz = false\r\n    return viz.trigger('relationshipClicked', relationship)\r\n  }\r\n\r\n  const onNodeMouseOver = node => viz.trigger('nodeMouseOver', node)\r\n  const onNodeMouseOut = node => viz.trigger('nodeMouseOut', node)\r\n  const onNodeMouseUp = function(node){\r\n    if(d3.event.button ==  0){\r\n      if(d3.event.ctrlKey){\r\n        graph.isCtrlClick = true;\r\n        return viz.trigger('nodeCtrlClick',node)\r\n      }\r\n    }else{\r\n      return viz.trigger('nodeClickRight',node)\r\n    }\r\n  }\r\n\r\n  const onRelMouseOver = rel => viz.trigger('relMouseOver', rel)\r\n  const onRelMouseOut = rel => viz.trigger('relMouseOut', rel)\r\n\r\n  let zoomLevel = null\r\n\r\n  const zoomed = function () {\r\n    draw = true\r\n    return container.attr(\r\n      'transform',\r\n      `translate(${zoomBehavior.translate()})scale(${zoomBehavior.scale()})`\r\n    )\r\n  }\r\n\r\n  var zoomBehavior = d3.behavior\r\n    .zoom()\r\n    .scaleExtent([0.2, 1])\r\n    .on('zoom', zoomed)\r\n\r\n  const interpolateZoom = (translate, scale) =>\r\n    d3\r\n      .transition()\r\n      .duration(500)\r\n      .tween('zoom', function () {\r\n        const t = d3.interpolate(zoomBehavior.translate(), translate)\r\n        const s = d3.interpolate(zoomBehavior.scale(), scale)\r\n        return function (a) {\r\n          zoomBehavior.scale(s(a)).translate(t(a))\r\n          return zoomed()\r\n        }\r\n      })\r\n\r\n  let isZoomingIn = true\r\n\r\n  viz.zoomInClick = function () {\r\n    isZoomingIn = true\r\n    return zoomClick(this)\r\n  }\r\n\r\n  viz.zoomOutClick = function () {\r\n    isZoomingIn = false\r\n    return zoomClick(this)\r\n  }\r\n\r\n  var zoomClick = function (element) {\r\n    draw = true\r\n    const limitsReached = { zoomInLimit: false, zoomOutLimit: false }\r\n\r\n    if (isZoomingIn) {\r\n      zoomLevel = Number((zoomBehavior.scale() * (1 + 0.2 * 1)).toFixed(2))\r\n      if (zoomLevel >= zoomBehavior.scaleExtent()[1]) {\r\n        limitsReached.zoomInLimit = true\r\n        interpolateZoom(zoomBehavior.translate(), zoomBehavior.scaleExtent()[1])\r\n      } else {\r\n        interpolateZoom(zoomBehavior.translate(), zoomLevel)\r\n      }\r\n    } else {\r\n      zoomLevel = Number((zoomBehavior.scale() * (1 + 0.2 * -1)).toFixed(2))\r\n      if (zoomLevel <= zoomBehavior.scaleExtent()[0]) {\r\n        limitsReached.zoomOutLimit = true\r\n        interpolateZoom(zoomBehavior.translate(), zoomBehavior.scaleExtent()[0])\r\n      } else {\r\n        interpolateZoom(zoomBehavior.translate(), zoomLevel)\r\n      }\r\n    }\r\n    return limitsReached\r\n  }\r\n  // Background click event\r\n  // Check if panning is ongoing\r\n  rect.on('click', function () {\r\n    if (!draw) {\r\n      return viz.trigger('canvasClicked', el)\r\n    }\r\n  })\r\n\r\n  baseGroup\r\n    .call(zoomBehavior)\r\n    .on('dblclick.zoom', null)\r\n    // Single click is not panning\r\n    .on('click.zoom', () => (draw = false))\r\n    .on('DOMMouseScroll.zoom', null)\r\n    .on('wheel.zoom', null)\r\n    .on('mousewheel.zoom', null)\r\n\r\n  const newStatsBucket = function () {\r\n    const bucket = {\r\n      frameCount: 0,\r\n      geometry: 0,\r\n      relationshipRenderers: (function () {\r\n        const timings = {}\r\n        vizRenderers.relationship.forEach(r => (timings[r.name] = 0))\r\n        return timings\r\n      })()\r\n    }\r\n    bucket.duration = () => bucket.lastFrame - bucket.firstFrame\r\n    bucket.fps = () =>\r\n      ((1000 * bucket.frameCount) / bucket.duration()).toFixed(1)\r\n    bucket.lps = () =>\r\n      ((1000 * bucket.layout.layoutSteps) / bucket.duration()).toFixed(1)\r\n    bucket.top = function () {\r\n      let time\r\n      const renderers = []\r\n      for (let name in bucket.relationshipRenderers) {\r\n        time = bucket.relationshipRenderers[name]\r\n        renderers.push({\r\n          name,\r\n          time\r\n        })\r\n      }\r\n      renderers.push({\r\n        name: 'forceLayout',\r\n        time: bucket.layout.layoutTime\r\n      })\r\n      renderers.sort((a, b) => b.time - a.time)\r\n      const totalRenderTime = renderers.reduce(\r\n        (prev, current) => prev + current.time,\r\n        0\r\n      )\r\n      return renderers\r\n        .map(\r\n          d => `${d.name}: ${((100 * d.time) / totalRenderTime).toFixed(1)}%`\r\n        )\r\n        .join(', ')\r\n    }\r\n    return bucket\r\n  }\r\n\r\n  let currentStats = newStatsBucket()\r\n\r\n  const now =\r\n    window.performance && window.performance.now\r\n      ? () => window.performance.now()\r\n      : () => Date.now()\r\n\r\n  const render = function () {\r\n    if (!currentStats.firstFrame) {\r\n      currentStats.firstFrame = now()\r\n    }\r\n    currentStats.frameCount++\r\n    const startRender = now()\r\n    geometry.onTick(graph)\r\n    currentStats.geometry += now() - startRender\r\n\r\n    const nodeGroups = container\r\n      .selectAll('g.node')\r\n      .attr('transform', d => `translate(${d.x},${d.y})`)\r\n\r\n    for (var renderer of Array.from(vizRenderers.node)) {\r\n      nodeGroups.call(renderer.onTick, viz)\r\n    }\r\n\r\n    const relationshipGroups = container\r\n      .selectAll('g.relationship')\r\n      .attr(\r\n        'transform',\r\n        d =>\r\n          `translate(${d.source.x} ${d.source.y}) rotate(${d.naturalAngle +\r\n            180})`\r\n      )\r\n    for (renderer of Array.from(vizRenderers.relationship)) {\r\n      const startRenderer = now()\r\n      relationshipGroups.call(renderer.onTick, viz)\r\n      currentStats.relationshipRenderers[renderer.name] += now() - startRenderer\r\n    }\r\n\r\n    return (currentStats.lastFrame = now())\r\n  }\r\n  \r\n  // 初始化 力导向图\r\n  const force = layout.init(render)\r\n\r\n  // Add custom drag event listeners\r\n  force\r\n    .drag()\r\n    .on('dragstart.node', d => onNodeDragToggle(d))\r\n    .on('dragend.node', () => onNodeDragToggle())\r\n\r\n  viz.collectStats = function () {\r\n    const latestStats = currentStats\r\n    latestStats.layout = force.collectStats()\r\n    currentStats = newStatsBucket()\r\n    return latestStats\r\n  }\r\n// update  就是再进行一遍渲染\r\n  viz.update = function () {\r\n    if (!graph) {\r\n      return\r\n    }\r\n    const layers = container\r\n      .selectAll('g.layer')\r\n      .data(['relationships', 'nodes'])\r\n    layers\r\n      .enter()\r\n      .append('g')\r\n      .attr('class', d => `layer ${d}`)\r\n\r\n    layers.classed('ctrlClick' , graph.isCtrlClick)\r\n    const nodes = graph.nodes()\r\n    const relationships = graph.relationships()\r\n\r\n    const relationshipGroups = container\r\n      .select('g.layer.relationships')\r\n      .selectAll('g.relationship')\r\n      .data(relationships, d => d.id)\r\n      .attr('class',d=>{\r\n        return d.className\r\n      })\r\n\r\n    relationshipGroups\r\n      .enter()\r\n      .append('g')\r\n      .attr('class', d=>{\r\n        return d.className\r\n      })\r\n      .attr('opacity',node=>{\r\n        return node.className == 'node-relation_link' ? 0.5 : 1\r\n       })\r\n      .on('mousedown', onRelationshipClick)\r\n      .on('mouseover', onRelMouseOver)\r\n      .on('mouseout', onRelMouseOut)\r\n\r\n    relationshipGroups.classed(\r\n      {\r\n        \r\n      'selected' :\r\n      relationship => relationship.selected,\r\n       'relationship' : true,\r\n       'hide' : \r\n       rel => rel.display == 'hide'\r\n      }\r\n    )\r\n\r\n    geometry.onGraphChange(graph)\r\n    if(graph.initConfig.rightMenu.self){\r\n      for (var renderer of Array.from(vizRenderers.relationshipSelf)) {\r\n        relationshipGroups.call(renderer.onGraphChange, viz)\r\n      }\r\n\r\n    }else{\r\n      for (var renderer of Array.from(vizRenderers.relationship)) {\r\n        relationshipGroups.call(renderer.onGraphChange, viz)\r\n      }\r\n\r\n    }\r\n\r\n    relationshipGroups.exit().remove()\r\n    const nodeGroups = container\r\n      .select('g.layer.nodes')\r\n      .selectAll('g.node')\r\n      .data(nodes, d => d.id)\r\n      .attr('class',node=>{\r\n        return node.className\r\n      })\r\n    nodeGroups\r\n      .enter()\r\n      .append('g')\r\n      .attr('class' , node => node.className)\r\n      .call(force.drag)\r\n      .call(clickHandler)\r\n      .on('mouseover', onNodeMouseOver)\r\n      .on('mouseout', onNodeMouseOut)\r\n      .append('p')\r\n      // .on('mouseup', onNodeMouseUp)\r\n    // 增加选中的className\r\n    nodeGroups.classed({'selected': node => node.selected , 'ctrlClicked' : node => {\r\n      return node.ctrlClicked\r\n    } ,   'hide' : node =>  node.display == 'hide' ,'node' : true})\r\n\r\n// 渲染节点\r\n    if(graph.initConfig.rightMenu.self){\r\n      for (renderer of Array.from(vizRenderers.nodeSelf)) {\r\n        nodeGroups.call(renderer.onGraphChange, viz)\r\n      }\r\n\r\n    }else{\r\n      for (renderer of Array.from(vizRenderers.node)) {\r\n        nodeGroups.call(renderer.onGraphChange, viz)\r\n      }\r\n    }\r\n// 渲染菜单\r\n    if(graph.initConfig.leftMenu.show){\r\n      for (renderer of Array.from(menuRenderer)) {\r\n        nodeGroups.call(renderer.onGraphChange, viz )\r\n      }\r\n    }\r\n//  渲染右击菜单\r\n    if(graph.initConfig.rightMenu.show){\r\n      if(graph.initConfig.rightMenu.self){\r\n        for(renderer of Array.from(rightMenu1)){\r\n          nodeGroups.call(renderer.onGraphChange,viz )\r\n        }\r\n      }else{\r\n        for(renderer of Array.from(rightMenu)){\r\n          nodeGroups.call(renderer.onGraphChange,viz )\r\n        }\r\n      }\r\n    }\r\n\r\n    nodeGroups.exit().remove()\r\n\r\n    if (updateViz ) {\r\n      force.update(graph, [layoutDimension, layoutDimension])\r\n      viz.resize()\r\n      viz.trigger('updated')\r\n      }\r\n    return (updateViz = true)\r\n  }\r\n  viz.resize = function () {\r\n    const size = measureSize()\r\n    return root.attr(\r\n      'viewBox',\r\n      [\r\n        0,\r\n        (layoutDimension - size.height) / 2,\r\n        layoutDimension,\r\n        size.height\r\n      ].join(' ')\r\n    )\r\n  }\r\n\r\n  viz.boundingBox = () => container.node().getBBox()\r\n  viz.force = force\r\n\r\n  var clickHandler = vizClickHandler()\r\n  clickHandler.on('click', onNodeClick)\r\n  clickHandler.on('dblclick', onNodeDblClick)\r\n\r\n  return viz\r\n}\r\n\r\nexport default vizFn\r\n","\r\nimport d3 from 'd3'\r\n\r\nconst collision = {\r\n  avoidOverlap: nodes => {\r\n    const q = d3.geom.quadtree(nodes)\r\n    return Array.from(nodes).map(n => q.visit(collide(n)))\r\n  }\r\n}\r\nconst collide = node => {\r\n  let r = node.radius + 10\r\n  const nx1 = node.x - r\r\n  const nx2 = node.x + r\r\n  const ny1 = node.y - r\r\n  const ny2 = node.y + r\r\n  return (quad, x1, y1, x2, y2) => {\r\n    let l, x, y\r\n    if (quad.point && quad.point !== node) {\r\n      x = node.x - quad.point.x\r\n      y = node.y - quad.point.y\r\n      l = Math.sqrt(x * x + y * y)\r\n      r = node.radius + 10 + quad.point.radius\r\n    }\r\n    if (l < r) {\r\n      l = ((l - r) / l) * 0.5\r\n      node.x -= x *= l\r\n      node.y -= y *= l\r\n      quad.point.x += x\r\n      quad.point.y += y\r\n    }\r\n    return x1 > nx2 || x2 < nx1 || y1 > ny2 || y2 < ny1\r\n  }\r\n}\r\n\r\nexport default collision\r\n","import d3 from 'd3'\r\nimport collision from './collision'\r\nimport circularLayout from '../utils/circularLayout'\r\nimport cloneArray from '../utils/arrays'\r\n\r\nconst layout = {\r\n  force: () => {\r\n    return {\r\n      init: render => {\r\n        const forceLayout = {}\r\n\r\n        const linkDistance = 45\r\n\r\n        const d3force = d3.layout\r\n          .force()\r\n          .linkDistance(\r\n            relationship =>\r\n              relationship.source.radius +\r\n              relationship.target.radius +\r\n              linkDistance\r\n          )\r\n          .charge(-1000)\r\n        const newStatsBucket = function () {\r\n          const bucket = {\r\n            layoutTime: 0,\r\n            layoutSteps: 0\r\n          }\r\n          return bucket\r\n        }\r\n        let currentStats = newStatsBucket()\r\n\r\n        forceLayout.collectStats = function () {\r\n          const latestStats = currentStats\r\n          currentStats = newStatsBucket()\r\n          return latestStats\r\n        }\r\n\r\n        const accelerateLayout = function () {\r\n          let maxStepsPerTick = 100\r\n          const maxAnimationFramesPerSecond = 60\r\n          const maxComputeTime = 1000 / maxAnimationFramesPerSecond\r\n          const now =\r\n            window.performance && window.performance.now\r\n              ? () => window.performance.now()\r\n              : () => Date.now()\r\n\r\n          const d3Tick = d3force.tick\r\n          return (d3force.tick = function () {\r\n            const startTick = now()\r\n            let step = maxStepsPerTick\r\n            while (step-- && now() - startTick < maxComputeTime) {\r\n              const startCalcs = now()\r\n              currentStats.layoutSteps++\r\n\r\n              collision.avoidOverlap(d3force.nodes())\r\n\r\n              if (d3Tick()) {\r\n                maxStepsPerTick = 2\r\n                return true\r\n              }\r\n              currentStats.layoutTime += now() - startCalcs\r\n            }\r\n            render()\r\n            return false\r\n          })\r\n        }\r\n\r\n        accelerateLayout()\r\n\r\n        const oneRelationshipPerPairOfNodes = graph =>\r\n          Array.from(graph.groupedRelationships()).map(\r\n            pair => pair.relationships[0]\r\n          )\r\n\r\n        forceLayout.update = function (graph, size) {\r\n          let nodes = cloneArray(graph.nodes())\r\n          const relationships = oneRelationshipPerPairOfNodes(graph)\r\n          const radius = (nodes.length * linkDistance) / (Math.PI * 2)\r\n          const center = {\r\n            x: size[0] / 2,\r\n            y: size[1] / 2\r\n          }\r\n          circularLayout(nodes, center, radius)\r\n          return d3force\r\n            .nodes(nodes)\r\n            .links(relationships)\r\n            .size(size)\r\n            .start()\r\n        }\r\n\r\n        forceLayout.drag = d3force.drag\r\n        forceLayout.on = d3force.on\r\n        return forceLayout\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default layout\r\n","\r\n\r\nexport default function cloneArray (original) {\r\n  const clone = new Array(original.length)\r\n  for (let idx = 0; idx < original.length; idx++) {\r\n    const node = original[idx]\r\n    clone[idx] = node\r\n  }\r\n  return clone\r\n}\r\n","\r\nexport default function circularLayout (nodes, center, radius) {\r\n  const unlocatedNodes = []\r\n  for (let node of Array.from(nodes)) {\r\n    if (!(node.x != null && node.y != null)) {\r\n      unlocatedNodes.push(node)\r\n    }\r\n  }\r\n  return (() => {\r\n    const result = []\r\n    for (let i = 0; i < unlocatedNodes.length; i++) {\r\n      const n = unlocatedNodes[i]\r\n      n.x =\r\n        center.x + radius * Math.sin((2 * Math.PI * i) / unlocatedNodes.length)\r\n      result.push(\r\n        (n.y =\r\n          center.y +\r\n          radius * Math.cos((2 * Math.PI * i) / unlocatedNodes.length))\r\n      )\r\n    }\r\n    return result\r\n  })()\r\n}\r\n","\r\nimport viz from './visualization'\r\nimport layout from './layout'\r\n\r\nexport default class graphView {\r\n  constructor (element, measureSize, graph, style) {\r\n    this.graph = graph\r\n    this.style = style\r\n    // 这部分可以用来做布局切换的逻辑\r\n    const forceLayout = layout.force()\r\n    this.viz = viz(element, measureSize, this.graph, forceLayout, this.style)\r\n    this.callbacks = {}\r\n    const { callbacks } = this\r\n    this.viz.trigger = (() => (event, ...args) =>\r\n      Array.from(callbacks[event] || []).map(callback =>\r\n        callback.apply(null, args)\r\n      ))()\r\n  }\r\n\r\n  on (event, callback) {\r\n    ;(this.callbacks[event] != null\r\n      ? this.callbacks[event]\r\n      : (this.callbacks[event] = [])\r\n    ).push(callback)\r\n    return this\r\n  }\r\n\r\n  layout (value) {\r\n    if (!arguments.length) {\r\n      return this.layout\r\n    }\r\n    this.layout = value\r\n    return this\r\n  }\r\n\r\n  grass (value) {\r\n    if (!arguments.length) {\r\n      return this.style.toSheet()\r\n    }\r\n    this.style.importGrass(value)\r\n    return this\r\n  }\r\n\r\n  update () {\r\n    this.viz.update()\r\n    return this\r\n  }\r\n\r\n  resize () {\r\n    this.viz.resize()\r\n    return this\r\n  }\r\n\r\n  boundingBox () {\r\n    return this.viz.boundingBox()\r\n  }\r\n\r\n  collectStats () {\r\n    return this.viz.collectStats()\r\n  }\r\n\r\n  zoomIn (elem) {\r\n    return this.viz.zoomInClick(elem)\r\n  }\r\n\r\n  zoomOut (elem) {\r\n    return this.viz.zoomOutClick(elem)\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\nimport { createGraph, mapRelationships, getGraphStats ,mapNodes } from '../mapper'\r\nimport { GraphEventHandler } from '../GraphEventHandler'\r\nimport '../lib/visualization/index'\r\nimport deepmerge from 'deepmerge'\r\nimport { downloadPNGFromSVG,gainPngBase64} from \"../../shared/exporting/imageUtils\";\r\nimport d3 from \"d3\";\r\n\r\nimport neoGraphStyle from '../graphStyle'\r\n\r\nimport { dim } from './browser-styles'\r\nimport { StyledZoomHolder, StyledSvgWrapper, StyledZoomButton } from './styled'\r\n// import { ZoomInIcon, ZoomOutIcon } from 'browser-components/icons/Icons'\r\nimport graphView from '../lib/visualization/components/graphView'\r\n\r\nlet svgElement = null;\r\nconst deduplicateNodes = nodes => {\r\n  return nodes.reduce(\r\n    (all, curr) => {\r\n      if (all.taken.indexOf(curr.id) > -1) {\r\n        return all\r\n      } else {\r\n        all.nodes.push(curr)\r\n        all.taken.push(curr.id)\r\n        return all\r\n      }\r\n    },\r\n    { nodes: [], taken: [] }\r\n  ).nodes\r\n}\r\nexport class GraphComponent extends Component {\r\n  constructor(props){\r\n    super(props);\r\n    const graphStyle = neoGraphStyle();\r\n    this.defaultStyle = graphStyle.toSheet()\r\n    if (this.props.graphStyleData) {\r\n      const rebasedStyle = deepmerge(\r\n        this.defaultStyle,\r\n        this.props.graphStyleData\r\n      )\r\n      graphStyle.loadRules(rebasedStyle)\r\n    }\r\n    this.state = {\r\n      initGraph : props.initGraphs,\r\n      stats: { labels: {}, relTypes: {} },\r\n      graphStyle,\r\n      zoomInLimitReached: true,\r\n      zoomOutLimitReached: false,\r\n      shouldResize: false,\r\n      nodes : [],\r\n      relationships : [],\r\n      graphEH : {},\r\n      graphView : {},\r\n      graph : {},\r\n      svgElement : \"\"\r\n    }\r\n    this.onGraphModelChange = this.onGraphModelChange.bind(this);\r\n  }\r\n  componentDidMount(){\r\n    //   console.log(this.props);\r\n  }\r\n\r\n\r\n  exportPNG () {\r\n    const graphElement  = this.state.graphView;\r\n    const type = 'graph';\r\n    console.log(svgElement,graphElement,type)\r\n    downloadPNGFromSVG(svgElement, graphElement, type)\r\n  }\r\n  gainPngBase64(){\r\n    const graphElement  = this.state.graphView;\r\n    const type = 'graph';\r\n    return gainPngBase64(svgElement, graphElement, type)\r\n  }\r\n  graphInit (el) {\r\n    // 渲染svg图\r\n    this.svgElement = el;\r\n    svgElement = el;\r\n  }\r\n  // 过滤之后要保留的节点 和 关系\r\n  retainNodesRel(info){\r\n    let {nodeMap, relMap} = info;\r\n    let {graph , graphView} = this.state;\r\n    let nodeMap1 = graph.nodeMap;\r\n    let relMap1 = graph.relationshipMap;\r\n    if(Object.keys(nodeMap).length == 0 && Object.keys(relMap).length == 0 ){\r\n      graph.resetGraph();\r\n      graphView.update();\r\n      return;\r\n    }\r\n    let nodes = graph._nodes.map(v=>{\r\n      return v.id\r\n    });\r\n    let rel = graph._relationships.map(v=>{\r\n      return v.id\r\n    });\r\n    nodes.map(id=>{\r\n      if(!nodeMap.hasOwnProperty(id)){\r\n        // 移除节点\r\n        this.graph.removeConnectedRelationships(nodeMap1[id])\r\n        this.graph.removeNode(nodeMap1[id])\r\n      }\r\n    })\r\n    rel.map(id=>{\r\n      if(!relMap.hasOwnProperty(relMap1[id])){\r\n        // 移除关系\r\n        this.graph.removeRel(relMap1[id]);\r\n      }\r\n    })\r\n    graphView.update()\r\n  }\r\n  // 增加节点\r\n  addNodesRel(info){\r\n    let {nodes, relationships} = info;\r\n    let {graph , graphView} = this.state;\r\n    graph.addNodes(mapNodes(nodes))\r\n    graph.addRelationships(mapRelationships(relationships, graph))\r\n    this.onGraphModelChange(getGraphStats(graph))\r\n    graphView.update()\r\n  }\r\n  // 扩展节点\r\n  extendNodesRel(d,info){\r\n    let {graph , graphView} = this.state;\r\n    let {nodes, relationships} = info;\r\n    graph.addExpandedNodes(d, mapNodes(nodes))\r\n    graph.addRelationships(mapRelationships(relationships, graph))\r\n    graph.checkNodeExtendRelToggle();\r\n\r\n    graphView.update()\r\n    this.onGraphModelChange(getGraphStats(graph))\r\n  }\r\n  //根据选中的节点生成图 \r\n  gainRelByNode(arr){\r\n    if(arr.length == 0) return {nodes : [] , relationships : []}\r\n    let {graph , graphView} = this.state;\r\n    return graph.gainRelByNode(arr)\r\n  }\r\n  // 重置图形\r\n  resetGraph(info){\r\n    let {nodes, relationships} = info;\r\n    let {graph , graphView , graphEH} = this.state;\r\n    graph.resetGraph();\r\n    graphEH.resetEH();\r\n    graph.addNodes(mapNodes(nodes))\r\n    graph.addRelationships(mapRelationships(relationships, graph))\r\n    this.onGraphModelChange(getGraphStats(graph))\r\n    graphView.update()\r\n  }\r\n  // 清空选择\r\n  clearSelected(){\r\n    let {graph , graphView , graphEH} = this.state;\r\n    graph.initSeleced();\r\n    graphEH.resetEH();\r\n    graphView.update()\r\n  }\r\n  // 隐藏节点\r\n  toggleByLabels(ds,type){\r\n    let {graph,graphView} = this.state;\r\n    if(type == 'node'){\r\n      graph.toggleNodeBylabels(ds);\r\n    }else{\r\n      graph.toggleRelByLabels(ds);\r\n    }\r\n    // d3.selectAll('.node').attr({'class' : 'hide node'})\r\n    // graphView.toggleUpdate()\r\n    graph.checkNodeExtendRelToggle();\r\n    graphView.update()\r\n    this.onGraphModelChange(getGraphStats(graph))\r\n  }\r\n  // 移除多个节点\r\n  removeByLabels(ds , type){\r\n    let {graph,graphView} = this.state;\r\n    if(type == 'node'){\r\n      graph.removeNodeByLabels(ds);\r\n    }else{\r\n      graph.removeRelByLabels(ds);\r\n    }\r\n    graphView.update()\r\n    this.onGraphModelChange(getGraphStats(graph))\r\n  }\r\n  // 更新节点 关系\r\n  updateNodesRel(nodes,rels){\r\n    let {graph,graphView} = this.state;\r\n    nodes.map(v=>{\r\n      graph.updateNodeProps(v);\r\n    })\r\n    rels.map(v=>{\r\n      graph.updateRelProps(v)\r\n    })\r\n    this.onGraphModelChange(getGraphStats(graph))\r\n    graphView.update()\r\n  }\r\n\r\n  // 更新某个节点的信息\r\n  updateOneNode(d){\r\n    let {graph,graphView} = this.state;\r\n    graph.updateNodeProps(d);\r\n    graphView.update()\r\n  }\r\n  // 移除单个节点\r\n  removeNode(d){\r\n    this.graph.removeConnectedRelationships(d)\r\n    this.graph.removeNode(d)\r\n  }\r\n  // 设置新的图表样式\r\n  updateStyleNodesRel(arr,type){\r\n    let {graphStyle ,graphView , graph} = this.state;\r\n    if(type == 'node' && arr.length > 0){\r\n      arr.forEach(v=>{\r\n        graphStyle.changeForSelector(v.selector, v.styleProp)\r\n      })\r\n    }\r\n    const rebasedStyle = deepmerge(this.defaultStyle, graphStyle.toSheet())\r\n    graphStyle.loadRules(rebasedStyle)\r\n    this.onGraphModelChange(getGraphStats(graph))\r\n    graphView.update()\r\n  }\r\n  zoomOut(){\r\n    let {graphView} = this.state;\r\n    let limits = graphView.zoomOut()\r\n    return limits;\r\n  }\r\n  zoomIn(){\r\n    let {graphView} = this.state;\r\n    let limits =  graphView.zoomIn()\r\n    return limits;\r\n  }\r\n  initGraph(info){\r\n    let {nodes = {},relationships = [] , config} = info;\r\n    let nodesDetail = deduplicateNodes(nodes)\r\n    let selectedItem = ''\r\n    if (nodes.length > parseInt(this.props.initialNodeDisplay)) {\r\n      nodes = nodes.slice(0, this.props.initialNodeDisplay)\r\n      relationships = this.props.relationships.filter(item => {\r\n        return nodes.filter(node => node.id === item.startNodeId) > 0\r\n      })\r\n      selectedItem = {\r\n        type: 'status-item',\r\n        item: `Not all return nodes are being displayed due to Initial Node Display setting. Only ${\r\n          this.props.initialNodeDisplay\r\n        } of ${nodes.length} nodes are being displayed`\r\n      }\r\n    }\r\n    this.initGraphView({nodes : nodesDetail  , relationships , config});\r\n  }\r\n  onGraphModelChange(stats){\r\n    this.setState({ stats: stats });\r\n    let {graph} = this.state;\r\n    if(this.props.getStats){\r\n      let labels = Object.keys(stats.labels);\r\n      let {graphStyle} = this.state;\r\n      let relTypes = Object.keys(stats.relTypes);\r\n      let a1 = [];\r\n      let a2 = [];\r\n      a1 = labels.map((v,i)=>{\r\n        let node = v != '*' && graph?.nodeLabelsMap?.[v] ? graph.nodeMap[graph.nodeLabelsMap[v][0]] : null;\r\n        let obj = {};\r\n        if(node && node.display == 'hide'){obj = {filter : true}}\r\n        let obj1 = {...graphStyle.forNode({\r\n          labels : [v]\r\n        }) , label : v ,  ...stats.labels[v] }\r\n         obj1.props = {...obj1.props, ...obj};\r\n        return  obj1 })\r\n      a2 = relTypes.map(v=>{\r\n        let rel = v != '*' && graph?.relLabelsMap?.[v] ? graph.relationshipMap[graph.relLabelsMap[v][0]] : null;\r\n        let obj = {};\r\n        if(rel && rel.display == 'hide'){obj = {filter : true}}\r\n        let obj1 = {...graphStyle.forRelationship({\r\n          type : v\r\n        }  ) , label : v , ...stats.relTypes[v]};\r\n        obj1.props = {...obj1.props , ...obj}\r\n        return obj1\r\n      })\r\n      this.props.getStats({labels : a1 , relTypes : a2});\r\n    }\r\n  }\r\n  \r\n\r\n  getVisualAreaHeight () {\r\n    return this.props.frameHeight && this.props.fullscreen\r\n      ? this.props.frameHeight -\r\n          (dim.frameStatusbarHeight + dim.frameTitlebarHeight * 2)\r\n      : this.props.frameHeight - dim.frameStatusbarHeight ||\r\n          this.svgElement.parentNode.offsetHeight\r\n  }\r\n  getNodeNeighbours (node, currentNeighbours, callback) {\r\n    callback(null, { nodes: [], relationships: [] })\r\n  }\r\n  \r\n  initGraphView ({nodes,relationships , config}) {\r\n    if(config == undefined){\r\n      config = {\r\n        rightMenu : {show : true},\r\n        leftMenu : {show : true}\r\n      }\r\n    }\r\n    if (!this.graphView) {\r\n      let NeoConstructor = graphView\r\n      let measureSize = () => {\r\n        return {\r\n          width: this.svgElement.offsetWidth,\r\n          height: this.getVisualAreaHeight()\r\n        }\r\n      }\r\n      this.graph = createGraph(nodes, relationships , config)\r\n      this.graphView = new NeoConstructor(\r\n        this.svgElement,\r\n        measureSize,\r\n        this.graph,\r\n        this.state.graphStyle\r\n      )\r\n      this.graphEH = new GraphEventHandler(\r\n        this.graph,\r\n        this.graphView,\r\n        this.getNodeNeighbours,\r\n        this.props.onItemMouseOver,\r\n        this.props.onItemSelect,\r\n        this.onGraphModelChange,\r\n        this.props.onEventListener\r\n      )\r\n      this.setState({\r\n        graphEH : this.graphEH,\r\n        graph : this.graph ,\r\n        graphView : this.graphView \r\n      })\r\n      this.graphEH.bindEventHandlers()\r\n      this.onGraphModelChange(getGraphStats(this.graph))\r\n      this.graphView.resize()\r\n      this.graphView.update()\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <StyledSvgWrapper theme={{name : 'normal'}}>\r\n        {/* 将图实例传递给子组件 */}\r\n        <svg className='neod3viz'   ref={this.graphInit.bind(this)} />\r\n      </StyledSvgWrapper>\r\n    )\r\n  }\r\n}\r\n\r\n\r\n\r\nexport default GraphComponent;","\r\nimport React, { useRef, useState } from \"react\";\r\nimport { DatePicker, Row, Col, Select, Button, message } from 'antd';\r\nimport moment from \"moment\";\r\nimport zhCN from 'antd/es/date-picker/locale/zh_CN';\r\nimport { UploadOutlined } from '@ant-design/icons';\r\nimport _ from \"lodash\"\r\n\r\nconst { RangePicker } = DatePicker;\r\n\r\nconst { Option } = Select;\r\n\r\nconst Header = (props) => {\r\n    const [time, setTime] = useState([]);  //时间筛选\r\n    const [hasPro, setHasPro] = useState([]); //包含的项目\r\n    const [hasFound, setHasFound] = useState([]); //包含的投资人\r\n    const [allPro, setAllPro] = useState([]); //所有的项目\r\n    const [allFound, setAllFound] = useState([]); //所有的found\r\n    const jsonData = useRef(null);\r\n\r\n    const toGeneralGraph = () => {\r\n        // 过滤时间\r\n        let json = _.cloneDeep(jsonData.current);\r\n        if (json && json.length) {\r\n            let data = json.filter(item => {\r\n                let { date = '', found = [], project = '' } = item;\r\n                let t = true;\r\n                let p = hasPro.length ? hasPro.includes(project) : true;\r\n                found = found.filter(fName => hasFound.length ? hasFound.includes(fName) : true);\r\n                item.allFounds = [...item.found];\r\n                item.found = found;\r\n                let f = found.length > 0;\r\n                if (hasFound.length) {\r\n                    f = found.length === hasFound.length\r\n                }\r\n                if (time && time.length && (date < time[0] || date > time[1])) {\r\n                    t = false\r\n                };\r\n                return t && p && f;\r\n            });\r\n            //  根据过滤后的数据生成 节点和 关系图\r\n            let nodes = [], relations = [];\r\n            for (const item of data) {\r\n                let { date, description, found, id, project, round } = item;\r\n                let startNode = {}, endNode = {};\r\n                // 根据信息生成节点\r\n                endNode = {\r\n                    id: project,\r\n                    labels: [\"Project\"],\r\n                    className: 'Project',\r\n                    properties: {\r\n                        type: 'project',\r\n                        project,\r\n                        label_for_match: \"Project\",\r\n                        date,\r\n                        name: project,\r\n                        id,\r\n                        description,\r\n                        round\r\n                    }\r\n                }\r\n                for (const foundItem of found) {\r\n                    startNode = {\r\n                        id: foundItem,\r\n                        labels: ['Person'],\r\n                        className: 'Person',\r\n                        properties: {\r\n                            type: 'fund',\r\n                            label_for_match: \"Person\", project, name: foundItem, date\r\n                        }\r\n                    }\r\n                    relations.push({\r\n                        id: `${foundItem}-${project}`,\r\n                        startNodeId: foundItem,\r\n                        endNodeId: project,\r\n                        type: 'fund to project',\r\n                        properties: {\r\n                            name: `${id}->${project}`\r\n                        }\r\n                    })\r\n                    nodes.push(startNode);\r\n                }\r\n\r\n                nodes.push(endNode);\r\n            }\r\n            //  for (const item of data) {\r\n            //     let {date , description , found ,  id ,  project , round} = item;\r\n            //     if(!nodesMap[project]){\r\n            //         nodesMap[project] = { \r\n            //             id : project ,  \r\n            //             properties : { list : [] , type : 'project' , project , name : project }\r\n            //         }\r\n            //     }\r\n            //     nodesMap[project].properties.list.push({\r\n            //         id ,\r\n            //         date ,\r\n            //         found,\r\n            //         description,\r\n            //         round,\r\n            //     })\r\n            //      for (const foundItem of found) {\r\n            //          if(!nodesMap[foundItem]){\r\n            //             nodesMap[foundItem] = { \r\n            //                 id : foundItem , \r\n            //                 properties : { list : [] , type : 'found' , project , name : foundItem}\r\n            //             }\r\n            //          }\r\n            //          nodesMap[foundItem].properties.list.push({\r\n            //              id  ,\r\n            //              date ,\r\n            //              project,\r\n            //              round,\r\n            //              description\r\n            //          })\r\n            //      }\r\n            //  };\r\n            //  console.log(nodesMap)\r\n            //  for (const key in nodesMap) {\r\n            //      if (Object.hasOwnProperty.call(nodesMap, key)) {\r\n            //          const nodeItem = nodesMap[key];\r\n            //          nodes.push(nodeItem);\r\n            //          let id = nodeItem.id;\r\n            //          let {type ,  project} = nodeItem.properties;\r\n            //          if(type === 'found'){\r\n            //              relations.push({\r\n            //                  id : `${id}-${project}`,\r\n            //                  startNodeId : id,\r\n            //                  endNodeId : project,\r\n            //                  type : 'found to project',\r\n            //                  properties : {\r\n            //                      name : `${id}->${project}`\r\n            //                  }\r\n            //              })\r\n            //          }       \r\n            //      }\r\n            //  }\r\n\r\n            props.onGeneral && props.onGeneral({ nodes, relations })\r\n\r\n        } else {\r\n            message.error('请先上传json数据');\r\n        }\r\n    }\r\n\r\n    const onChangeTime = (value) => {\r\n        if (value && value.length) {\r\n            setTime([\r\n                moment(new Date(value[0])).format('YYYY.HH.DD'),\r\n                moment(new Date(value[1])).format('YYYY.HH.DD')\r\n            ])\r\n        } else {\r\n            setTime([])\r\n        }\r\n    }\r\n\r\n    // 选择包含的项目\r\n    const onChangeSelectPro = (value) => {\r\n        setHasPro(value);\r\n    }\r\n\r\n    // 选择包含的投资人\r\n    const onChangeSelectFound = (value) => {\r\n        setHasFound(value)\r\n    }\r\n\r\n    const onChangeFile = (event) => {\r\n        var selectedFile = event.target.files[0];//获取读取的File对象\r\n        let { type } = selectedFile;\r\n        if (type !== 'application/json') {\r\n            message.error('不支持此文件格式!');\r\n            return;\r\n        }\r\n        var reader = new FileReader();//这里是核心！！！读取操作就是由它完成的。\r\n        reader.readAsText(selectedFile);//读取文件的内容\r\n        reader.onload = function () {\r\n            toHandleJson(JSON.parse(this.result));\r\n        };\r\n\r\n    }\r\n\r\n    const toHandleJson = (json) => {\r\n        // 生成节点和关系\r\n        let allProject = [], allFound = [];\r\n        for (const item of json) {\r\n            let { date, description, found, id, project = '', round = 0 } = item || {};\r\n            allProject.push({\r\n                id: `${id}_${project}`,\r\n                name: project,\r\n                properties: { id, description, date, round }\r\n            });\r\n            allFound = [...new Set([...allFound, ...found])];\r\n        }\r\n        setAllPro(allProject);\r\n        setAllFound(allFound);\r\n        setHasFound([]);\r\n        setHasPro([allProject[0].name]);\r\n        jsonData.current = json;\r\n    }\r\n\r\n    return (\r\n        <Row style={{ padding: '20px' }}>\r\n            <Col span={4}>\r\n                <Button icon={<UploadOutlined />} className=\"input-button\">\r\n                    Upload JSON\r\n                 <input type=\"file\" onChange={onChangeFile} />\r\n                </Button>\r\n            </Col>\r\n            <Col span={4}>\r\n                <RangePicker locale={zhCN} onChange={onChangeTime} />\r\n            </Col>\r\n            <Col span={12}>\r\n                <Select\r\n                    mode=\"multiple\"\r\n                    style={{ width: '40%', marginLeft: 10 }}\r\n                    placeholder=\"project\"\r\n                    value={hasPro}\r\n                    onChange={onChangeSelectPro}\r\n                    optionLabelProp=\"label\"\r\n                >\r\n                    {\r\n                        allPro.map(item => (\r\n                            <Option value={item.name} label={item.name} key={item.id}>\r\n                                <div className=\"demo-option-label-item\">\r\n                                    {item.name}\r\n                                </div>\r\n                            </Option>\r\n                        ))\r\n                    }\r\n                </Select>\r\n                <Select\r\n                    mode=\"multiple\"\r\n                    style={{ width: '40%', marginLeft: 15 }}\r\n                    placeholder=\"fund\"\r\n                    value={hasFound}\r\n                    onChange={onChangeSelectFound}\r\n                    optionLabelProp=\"label\"\r\n                >\r\n                    {\r\n                        allFound.map((item, index) => (\r\n                            <Option value={item} label={item} key={`${item}-${index}`}>\r\n                                <div className=\"demo-option-label-item\">\r\n                                    {item}\r\n                                </div>\r\n                            </Option>\r\n                        ))\r\n                    }\r\n                </Select>\r\n            </Col>\r\n            <Col span=\"2\" offset=\"1\">\r\n                <Button type=\"primary\" onClick={toGeneralGraph}>生成图谱</Button>\r\n            </Col>\r\n        </Row>\r\n    )\r\n}\r\n\r\nexport default React.memo(Header, () => true)","import React, { useEffect, useState } from 'react';\r\nimport { Drawer, Tag } from 'antd';\r\n\r\n\r\nconst Drawers = (props) => {\r\n  const [visible, setVisible] = useState(props.visible);\r\n  let { info } = props;\r\n\r\n  useEffect(() => {\r\n    setVisible(props.visible)\r\n  }, [props.visible])\r\n\r\n  const onClose = () => {\r\n    setVisible(false);\r\n    props.onClose && props.onClose()\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Drawer\r\n        title={<Tag color=\"green\">{info.id}</Tag>}\r\n        placement=\"right\"\r\n        closable={false}\r\n        onClose={onClose}\r\n        visible={visible}\r\n      >\r\n        {\r\n          (info.properties || []).map(item => (\r\n            item.key !== 'project' && <p key={item.key}><Tag color=\"blue\">{item.key}</Tag> : {item.value || '--'}</p>\r\n          ))\r\n        }\r\n      </Drawer>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Drawers;","import React, { useRef, useState } from \"react\"\r\nimport D3Force from \"../../libs/react-d3-force/src/D3Visualization/components/Graphs\"\r\nimport Header from \"./Header\"\r\nimport Drawer from \"./Drawer\"\r\nimport \"./Home.scss\"\r\nimport { Empty } from 'antd';\r\n// d3Force.current.initGraph({\r\n//     nodes : [\r\n//         {\r\n//             id: '1',\r\n//             labels: ['school'],\r\n//             properties: {\r\n//                 name : 'node 1'\r\n//             }\r\n//         }\r\n//     ],\r\n//     relationships : [\r\n//         {\r\n//             id : '3',\r\n//             startNodeId : '1',\r\n//             endNodeId : '2',\r\n//             type : 'rel1',\r\n//             properties : {\r\n//                 name : '关系1'\r\n//             }\r\n//         },\r\n//     ]\r\n// })\r\n\r\nexport default function () {\r\n    const d3Force = useRef(null);\r\n    const isFirst = useRef(null);\r\n    const [show, setShow] = useState(false);\r\n    const [node, setNode] = useState({});\r\n    const [num, setNum] = useState(0);\r\n\r\n    const onItemSelect = (item) => {\r\n        if (item.type === 'node') {\r\n            setShow(true);\r\n            setNode(item.item)\r\n        }\r\n    }\r\n\r\n    const onClose = () => {\r\n        setShow(false)\r\n    }\r\n\r\n    const onGeneral = ({ nodes, relations }) => {\r\n        setNum(nodes.length);\r\n        if (!isFirst.current) {\r\n            d3Force.current.initGraph({\r\n                nodes,\r\n                relationships: relations\r\n            });\r\n            isFirst.current = true;\r\n        } else {\r\n            d3Force.current.resetGraph({\r\n                nodes,\r\n                relationships: relations\r\n            });\r\n        }\r\n    }\r\n    return (\r\n        <div>\r\n            <Header onGeneral={onGeneral}></Header>\r\n            <Drawer visible={show} onClose={onClose} info={node} />\r\n            <div className=\"graph\">\r\n                {num === 0 && (\r\n                    <div className=\"empty\">\r\n                        <Empty image={Empty.PRESENTED_IMAGE_SIMPLE} />\r\n                    </div>\r\n                )}\r\n                <D3Force\r\n                    ref={d3Force}\r\n                    getStats={function () { }}\r\n                    onItemMouseOver={function () { }}\r\n                    onEventListener={function () { }}\r\n                    onItemSelect={onItemSelect}\r\n                ></D3Force>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React, { useEffect, useRef } from \"react\";\r\nimport { ALL_LABELS, ALL_RELS } from \"./match\";\r\nconst Neo4j =  require('neo4j-data');\r\n\r\nexport default function(){\r\n    let neo4j = useRef(null);\r\n    useEffect( async ()=>{\r\n        neo4j.current = new Neo4j();\r\n        neo4j.current.config({\r\n            url : 'bolt://124.156.168.171:17687',\r\n            username : 'neo4j',\r\n            password : 'llps&789'\r\n        });\r\n        // let result =  await neo4j.current.runMatch(ALL_LABELS);\r\n        // let labels = result.records.map(v=>{\r\n        //     return {key : v._fields[0] , value : v._fields[0]}\r\n        //   });\r\n        //   console.log('all labels' , labels)\r\n          let rels = await neo4j.current.runMatch(ALL_RELS);\r\n          console.log('all data' , neo4j.current.dataDetail(rels.records))\r\n    },[])\r\n    \r\n\r\n\r\n    return(\r\n        <div>block123</div>\r\n    )\r\n}","\r\n\r\n// 所有macth语句汇总\r\n\r\n\r\n\r\nconst ALL_LABELS = 'call db.labels()';\r\n\r\nconst ALL_RELS = 'MATCH p=()-->() RETURN p LIMIT 25'\r\n\r\nexport {\r\n    ALL_LABELS,\r\n    ALL_RELS\r\n}","export const generalId = () => {\r\n    const s = (+new Date() / 1000).toString()\r\n    return (\r\n      +`${parseInt(s.substring(5), 10)}${parseInt((Math.random() * 10000).toString(), 10)}` %\r\n      2147483647\r\n    )\r\n  }","\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport {  Row, Col, Button, message } from 'antd';\r\nimport zhCN from 'antd/es/date-picker/locale/zh_CN';\r\nimport { UploadOutlined } from '@ant-design/icons';\r\nimport _ from \"lodash\"\r\nimport * as echarts from 'echarts';\r\nimport moment from \"moment\"\r\nimport \"./Time.scss\"\r\nimport {generalId} from \"../../utils\"\r\n// var ecConfig = require(\"echarts/config\");\r\n\r\nconst Header = (props) => {\r\n    const jsonData = useRef(null);\r\n    const resultData = useRef(null)\r\n    const nameMap = useRef({});\r\n    const idMap = useRef({})\r\n    const zoom = useRef({\r\n        start : 0,\r\n        end : 20\r\n    })\r\n    const myChart = useRef(null)\r\n    const [range , setRange] = useState([])\r\n\r\n\r\n    useEffect(()=>{\r\n        initChart();\r\n    },[])\r\n\r\n\r\n    const initChart = () => {\r\n        // 生成datazoom  并添加datazoom缩放事件\r\n        var chartDom = document.getElementById('time-wrap');\r\n        myChart.current = echarts.init(chartDom);\r\n        myChart.current.on('datazoom', (params)=> {\r\n            let {start , end} = params;\r\n            zoom.current.start = start;\r\n            zoom.current.end = end;\r\n            filterData().then(_=>{\r\n                // 过滤出数据之后进行渲染\r\n                toRenderGraph()\r\n            }).catch(_=>{\r\n                console.log('跳过渲染')\r\n            })\r\n        });\r\n    }\r\n\r\n    const initChartLine = ()=> {\r\n       let option = {\r\n         xAxis: {\r\n           type: 'time',\r\n           boundaryGap: false,\r\n           show : false,\r\n         },\r\n         yAxis : {\r\n             show : false\r\n         },\r\n        //  yAxis: {\r\n        //    type: 'value',\r\n        //    boundaryGap: [0, '100%']\r\n        //  },\r\n         dataZoom: [\r\n           {\r\n             type: 'inside',\r\n             start: zoom.current.start,\r\n             end: zoom.current.end\r\n           },\r\n           {\r\n             start: 5,\r\n             end: 20\r\n           }\r\n         ],\r\n         series: [\r\n           {\r\n             name: 'Fake Data',\r\n             type: 'line',\r\n             smooth: true,\r\n             symbol: 'none',\r\n             data: resultData.current.chartData,\r\n             lineStyle : {\r\n                 color : 'rgba(0,0,0,0)'\r\n             }\r\n           }\r\n         ]\r\n       };\r\n      myChart.current.setOption(option);\r\n    }\r\n    const onChangeFile = (event) => {\r\n        var selectedFile = event.target.files[0];//获取读取的File对象\r\n        let { type } = selectedFile;\r\n        if (type !== 'application/json') {\r\n            message.error('不支持此文件格式!');\r\n            return;\r\n        }\r\n        var reader = new FileReader();//这里是核心！！！读取操作就是由它完成的。\r\n        reader.readAsText(selectedFile);//读取文件的内容\r\n        reader.onload = function () {\r\n            toHandleJson(JSON.parse(this.result));\r\n        };\r\n\r\n    }\r\n\r\n    const resetData = () => {\r\n        jsonData.current = {};\r\n        resultData.current = {};\r\n        nameMap.current = {};\r\n        idMap.current = {};\r\n        zoom.current = {\r\n            start : 0,\r\n            end : 20\r\n        }\r\n    }\r\n\r\n    const toHandleJson = (json) => {\r\n        // 重置所有数据\r\n        resetData()\r\n        // 生成节点和关系\r\n        let times  = Object.keys(json);\r\n        let obj = {};\r\n        let min = 0 , max = 0\r\n        jsonData.current = json;\r\n        for (let index = 0; index < times.length; index++) {\r\n            const date = times[index];\r\n            let timestamp = Date.parse(new Date(date));\r\n            obj[timestamp] = {\r\n                ...toGeneralNodeRel(json[date])\r\n            }\r\n            if(min === 0 || min > timestamp){\r\n                min = timestamp\r\n            }\r\n            if(max === 0 || max < timestamp){\r\n                max = timestamp\r\n            }\r\n        }\r\n        console.log(obj);\r\n        // 依据最大值 最小值 生成时间戳 \r\n        let {times : timeLine ,chartData} = toGeneralTimeLine(min,max)\r\n        resultData.current = {\r\n            min ,\r\n            max ,\r\n            chartData,\r\n            timeLine,\r\n            graph : obj,\r\n            nodes : [],\r\n            rels : []\r\n        }\r\n        setRange([\r\n            moment(new Date(min)).format(\"YYYY/MM/DD\"),\r\n            moment(new Date(max)).format(\"YYYY/MM/DD\"),\r\n        ])\r\n        // 生成时间轴数据\r\n        initChartLine()\r\n        // 根据当前zoom start 和 end 生成数据\r\n        filterData().then(_=>{\r\n            // 过滤出数据之后进行渲染\r\n            toRenderGraph()\r\n        }).catch(_=>{\r\n            console.log('跳过渲染!')\r\n            // toRenderGraph()\r\n        })\r\n    }\r\n\r\n    const  filterData = () => {\r\n        \r\n        return new Promise((resolve,reject)=> {\r\n            let {start , end } = zoom.current\r\n            // 截取在该时间段内的数据\r\n            let {graph , timeLine} = resultData.current;\r\n            let len  = timeLine.length - 1\r\n            start = Math.floor(len * (start / 100))\r\n            end = Math.floor(len * (end / 100))\r\n            start = timeLine[start];\r\n            end = timeLine[end];\r\n            let nodes = [] , rels = [] , times = [];\r\n            Object.keys(graph).forEach(time => {\r\n                if(Number(time) >= start && Number(time) <= end){\r\n                    nodes = nodes.concat(graph[time].nodes)\r\n                    rels = rels.concat(graph[time].rels)\r\n                    times.push(time)\r\n                }\r\n            })\r\n            // 如果时间和上次的一样就不触发重新渲染\r\n            let {times : t} = resultData.current;\r\n            // 如果节点中不含目标节点  那么就手动插入一个目标节点\r\n            if(!nodes.some(item => item.id === rels[0].endNodeId)){\r\n                nodes.push(idMap.current[rels[0].endNodeId])\r\n            }\r\n            console.log(times);\r\n            if(!t || t.join(',') !== times.join(',')){\r\n                resultData.current.times = times\r\n                resultData.current.nodes = nodes\r\n                resultData.current.rels = rels\r\n                console.log('渲染', nodes, rels);\r\n                resolve(true);\r\n            }\r\n            reject(false)\r\n        })\r\n    }\r\n\r\n    const toRenderGraph = () => {\r\n        // 过滤时间\r\n        let json = Object.keys(jsonData.current);\r\n        if (json && json.length) {\r\n            let {nodes , rels : relations} = _.cloneDeep(resultData.current);\r\n            props.onGeneral && props.onGeneral({ nodes, relations })\r\n\r\n        } else {\r\n            message.error('请先上传json数据');\r\n        }\r\n    }\r\n\r\n    // 依据source target 生成节点关系数据\r\n    const toGeneralNodeRel = ({source , target })=> {\r\n        let nodes = [] , rels = [] , id = generalId();\r\n        let s = {} , t = {} , rel = {}\r\n        let nMap = nameMap.current;\r\n        let iMap = idMap.current\r\n        if(source){\r\n            if(!nMap[source]){\r\n                s = {\r\n                    id : generalId(),\r\n                    labels : ['school'],\r\n                    properties : {\r\n                        name : source\r\n                    }\r\n                }\r\n                iMap[s.id] = s;\r\n                nodes.push(s)\r\n                nMap[source] = {\r\n                    id : s.id,\r\n                    name : source,\r\n                    origin : true,\r\n                    num : 1\r\n                }\r\n            }else{\r\n                nMap[source].num  = ++nMap[source].num\r\n            }\r\n        }\r\n        if(target){\r\n            if(!nMap[target]){\r\n                t = {\r\n                    id : generalId(),\r\n                    labels : ['school'],\r\n                    properties : {\r\n                        name : target\r\n                    }\r\n                }\r\n                iMap[t.id] = t;\r\n                nodes.push(t)\r\n                nMap[target] = {\r\n                    id : t.id,\r\n                    name : target,\r\n                    origin : false,\r\n                    num : 1\r\n                }\r\n            }else{\r\n                nMap[target].num  = ++nMap[target].num\r\n            }\r\n        }\r\n        if(source && target){\r\n            rel = {\r\n                id ,\r\n                startNodeId : nMap[source].id,\r\n                endNodeId : nMap[target].id,\r\n                type : 'rel',\r\n                properties : {\r\n                    name : `${source} -> ${target}`\r\n                }\r\n            }\r\n            iMap[rel.id] = rel;\r\n            rels.push(rel)\r\n            // 可能会存在 source target 都已经生成 ，此时取之前生成的点 push进去\r\n            if(!nodes.length){\r\n                nodes.push(iMap[nMap[source].id])\r\n            }\r\n        }\r\n        nameMap.current = nMap\r\n        idMap.current = iMap\r\n        return {nodes , rels}\r\n    }\r\n\r\n    const toGeneralTimeLine = (min , max) => {\r\n        let d = 24 * 60 * 60 * 1000;\r\n        let arr = [[min,0]];\r\n        let times = [min]\r\n        const time = (min , d , max) => {\r\n            let next = min + d\r\n            if(next < max){\r\n                arr.push([min,0])\r\n                times.push(next)\r\n                time(next,d,max)\r\n            }\r\n        }\r\n        time(min, d , max)\r\n        return {\r\n            times , \r\n            chartData : arr\r\n        }\r\n    }\r\n    return (\r\n        <Row style={{ padding: '20px' }} >\r\n            <Col span={2}>\r\n                <Button icon={<UploadOutlined />} className=\"input-button\">\r\n                    Upload JSON\r\n                 <input type=\"file\" onChange={onChangeFile} />\r\n                </Button>\r\n            </Col>\r\n            <Col span=\"9\" offset=\"1\">\r\n                <div id=\"time-wrap\"></div>\r\n            </Col>\r\n            <Col span=\"6\" offset=\"1\">\r\n                {\r\n                    range.length ? <span className=\"text\">\r\n                        {range[0]} ~ {range[1]}\r\n                    </span> : null\r\n                }\r\n            </Col>\r\n\r\n        </Row>\r\n    )\r\n}\r\n\r\nexport default React.memo(Header, () => true)","import React, { useRef, useState } from \"react\"\r\nimport D3Force from \"../../libs/react-d3-force/src/D3Visualization/components/Graphs\"\r\nimport { Empty } from 'antd';\r\nimport Header from \"./Header\"\r\nimport \"./Time.scss\"\r\n\r\nexport default function () {\r\n\r\n\r\n    const [num, setNum] = useState(0);\r\n    const d3Force = useRef(null);\r\n    const isFirst = useRef(null);\r\n\r\n\r\n    // 生成图谱函数\r\n    const   onGeneral = ({ nodes, relations }) => {\r\n        setNum(nodes.length);\r\n\r\n        console.log('传入数据',nodes , relations);\r\n        \r\n        if (!isFirst.current) {\r\n            d3Force.current.initGraph({\r\n                nodes,\r\n                relationships: relations\r\n            });\r\n            isFirst.current = true;\r\n        } else {\r\n            d3Force.current.resetGraph({\r\n                nodes,\r\n                relationships: relations\r\n            });\r\n        }\r\n    }\r\n    return (\r\n        <div>\r\n            <Header onGeneral={onGeneral}></Header>\r\n            <div className=\"graph\">\r\n                {num === 0 && (\r\n                    <div className=\"empty\">\r\n                        <Empty image={Empty.PRESENTED_IMAGE_SIMPLE} />\r\n                    </div>\r\n                )}\r\n                <D3Force\r\n                    ref={d3Force}\r\n                    getStats={function () { }}\r\n                    onItemMouseOver={function () { }}\r\n                    onEventListener={function () { }}\r\n                    onItemSelect={function(){}}\r\n                ></D3Force>\r\n            </div>\r\n        </div>\r\n    )\r\n}","\r\nimport React from 'react'\r\nimport { HashRouter as Router, Route, Switch } from 'react-router-dom'\r\nimport Home from \"../pages/home/Home\"\r\nimport Block123 from \"../pages/block123\"\r\nimport Time from \"../pages/time/Time\"\r\n\r\n\r\n\r\n\r\n\r\nexport default function () {\r\n    return (\r\n        <Router>\r\n            <Switch>\r\n                <Route exact path=\"/\">\r\n                    <Home />\r\n                </Route>\r\n                <Route exact path=\"/block123\">\r\n                    <Block123 />\r\n                </Route>\r\n                <Route exact path=\"/time\">\r\n                    <Time />\r\n                </Route>\r\n            </Switch>\r\n        </Router>\r\n    )\r\n}","import './App.css';\r\nimport 'antd/dist/antd.css'; // or 'antd/dist/antd.less'\r\nimport Router from \"./router\"\r\n\r\nfunction App() {\r\n  return (\r\n    <Router />\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport Router from \"./router\"\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}